<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html lang=en-US>
 <head>
  <title>The XMLHttpRequest Object</title>

  <style type="text/css">
   pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
   pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
   pre code { color:inherit; background:transparent }
   div.example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
   p.note::before { content:"Note: " }
   .issue { padding:.5em; border:solid #f00 }
   p.issue::before { content:"Issue: " }
   em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
   dfn { font-weight:bold; font-style:normal }
   code { color:orangered }
   code :link, code :visited { color:inherit }
  </style>
  <link href="http://www.w3.org/StyleSheets/TR/base" rel=stylesheet>
  <!--<link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/W3C-WD">-->

 <body>
  <div class=head>
   <p><a href="http://www.w3.org/"><img alt=W3C height=48
    src="http://www.w3.org/Icons/w3c_home" width=72></a></p>

   <h1 class=head id=the-xmlhttprequest>The <code
    title="">XMLHttpRequest</code> Object</h1>

   <h2 class="no-num no-toc" id=pagesubtitle>Editor's
    draft<!--W3C Working Draft--> 11 June 2007</h2>

   <dl>
    <dt>This Version:

    <dd><a
     href="http://www.w3.org/TR/2007/WD-XMLHttpRequest-20070611/">http://www.w3.org/TR/2007/WD-XMLHttpRequest-20070611/</a>

    <dt>Latest Version:

    <dd><a
     href="http://www.w3.org/TR/XMLHttpRequest/">http://www.w3.org/TR/XMLHttpRequest/</a>

    <dt>Previous Versions:

    <dd><a
     href="http://www.w3.org/TR/2007/WD-XMLHttpRequest-20070227/">http://www.w3.org/TR/2007/WD-XMLHttpRequest-20070227/</a>

    <dd><a
     href="http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060927/">http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060927/</a>

    <dd><a
     href="http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060619/">http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060619/</a>

    <dd><a
     href="http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060405/">http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060405/</a>

    <dt>Editor:

    <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a> (<a
     href="http://www.opera.com/">Opera Software ASA</a>) &lt;<a
     href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;
   </dl>

   <p class=copyright><a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
    &copy; 2007 <a href="http://www.w3.org/"><acronym title="World Wide Web
    Consortium">W3C</acronym></a><sup>&reg;</sup> (<a
    href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute
    of Technology">MIT</acronym></a>, <a
    href="http://www.ercim.org/"><acronym title="European Research Consortium
    for Informatics and Mathematics">ERCIM</acronym></a>, <a
    href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
    <a
    href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
    and <a
    href="http://www.w3.org/Consortium/Legal/copyright-documents">document
    use</a> rules apply.</p>
  </div>

  <hr>

  <h2 class="no-num no-toc" id=specabstract>Abstract</h2>

  <p>The <code title="">XMLHttpRequest</code> Object specification defines an
   <abbr title="Application Programming Interface">API</abbr> that provides
   scripted client functionality for transferring data between a client and a
   server.

  <h2 class="no-num no-toc" id=sotd>Status of this Document</h2>

  <p><em>This section describes the status of this document at the time of
   its publication. Other documents may supersede this document. A list of
   current W3C publications and the latest revision of this technical report
   can be found in the <a href="http://www.w3.org/TR/">W3C technical reports
   index</a> at http://www.w3.org/TR/.</em></p>
  <!-- change back to Last Call -->

  <p>This is the 11 June 2007 <strong>Editor's</strong> Working Draft of The
   <code title="">XMLHttpRequest</code> Object specification. Please send
   comments to <a href="mailto:public-webapi@w3.org">public-webapi@w3.org</a>
   (<a
   href="http://lists.w3.org/Archives/Public/public-webapi/">archived</a>)
   with either <samp>[XHR]</samp> or <samp title="">[XMLHttpRequest]</samp>
   at the start of the subject line<!-- by 2 April 2007-->.

  <p>This document is produced by the <a
   href="http://www.w3.org/2006/webapi/">Web API Working Group</a>, part of
   the <a href="http://www.w3.org/2006/rwc/Activity">Rich Web Clients
   Activity</a> in the W3C <a
   href="http://www.w3.org/Interaction/">Interaction Domain</a>. Changes made
   to this document can be found in the <a
   href="http://dev.w3.org/cvsweb/2006/webapi/XMLHttpRequest/Overview.html">W3C
   public CVS server</a>.

  <p>Publication as a Working Draft does not imply endorsement by the W3C
   Membership. This is a draft document and may be updated, replaced or
   obsoleted by other documents at any time. It is inappropriate to cite this
   document as other than work in progress.

  <p>This document was produced by a group operating under the <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February
   2004 W3C Patent Policy</a>. W3C maintains a <a
   href="http://www.w3.org/2004/01/pp-impl/38482/status"
   rel=disclosure>public list of any patent disclosures</a> made in
   connection with the deliverables of the group; that page also includes
   instructions for disclosing a patent. An individual who has actual
   knowledge of a patent which the individual believes contains <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
   Claim(s)</a> must disclose the information in accordance with <a
   href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
   6 of the W3C Patent Policy</a>.

  <h2 class="no-num no-toc" id=toc>Table of Contents</h2>
  <!--begin-toc-->

  <ul class=toc>
   <li><a href="#introduction"><span class=secno>1. </span>Introduction</a>
    <ul class=toc>
     <li><a href="#examples"><span class=secno>1.1. </span>Examples of
      Usage</a>

     <li><a href="#conformance"><span class=secno>1.2. </span>Conformance</a>
      
      <ul class=toc>
       <li><a href="#dependencies"><span class=secno>1.2.1.
        </span>Dependencies</a>

       <li><a href="#terminology"><span class=secno>1.2.2.
        </span>Terminology</a>

       <li><a href="#extensibility"><span class=secno>1.2.3.
        </span>Extensibility</a>
      </ul>
    </ul>

   <li><a href="#xmlhttprequest"><span class=secno>2. </span>The <code
    title="">XMLHttpRequest</code> Object</a>
    <ul class=toc>
     <li><a href="#events"><span class=secno>2.1. </span>Events for the <code
      title="">XMLHttpRequest</code> Object</a>

     <li><a href="#exceptions"><span class=secno>2.2. </span>Exceptions for
      the <code title="">XMLHttpRequest</code> Object</a>
    </ul>

   <li class=no-num><a href="#notcovered">Not in this Specification</a>

   <li class=no-num><a href="#bibref">References</a>

   <li class=no-num><a href="#acknowledgements">Acknowledgements</a>
  </ul>
  <!--end-toc-->

  <h2 id=introduction><span class=secno>1. </span>Introduction</h2>

  <p><em>This section is non-normative.</em>

  <p>The <code><a href="#xmlhttprequest-object">XMLHttpRequest</a></code>
   object implements an interface exposed by a scripting engine that allows
   scripts to perform HTTP client functionality, such as submitting form data
   or loading data from a server.

  <p>The name of the object is <code><a
   href="#xmlhttprequest-object">XMLHttpRequest</a></code> for compatibility
   with the web, though each component of this name is potentially
   misleading. First, the object supports any text based format, including
   XML. Second, it can be used to make requests over both HTTP and HTTPS
   (some implementations support protocols in addition to HTTP and HTTPS, but
   that functionality is not covered by this specification). Finally, it
   supports "requests" in a broad sense of the term as it pertains to HTTP;
   namely all activity involved with HTTP requests or responses for the
   defined HTTP methods.

  <h3 id=examples><span class=secno>1.1. </span>Examples of Usage</h3>

  <p><em>This section is non-normative.</em>

  <p>Some [<cite><a href="#ref-ecmascript">ECMAScript</a></cite>] examples
   are listed in the specification. In addition, you can find some below.

  <div class=example>
   <p>Some simple code to do something with data from an XML document fetched
    over the network:</p>

   <pre><code>function test(data) {
 // taking care of data
}

function handler() {
 if(this.readyState == 4 &amp;&amp; this.status == 200) {
  // so far so good
  if(this.responseXML != null &amp;&amp; this.responseXML.getElementById('test').firstChild.data)
     // success!
   test(this.responseXML.getElementById('test').firstChild.data);
  else
   test(null);
 } else if (this.readyState == 4 &amp;&amp; this.status != 200) {
  // fetched the wrong page or network error...
  test(null);
 }
}

var client = new XMLHttpRequest();
client.onreadystatechange = handler;
client.open("GET", "test.xml");
client.send();</code></pre>

   <p>If you just want to log a message to the server:</p>

   <pre><code>function log(message) {
 var client = new XMLHttpRequest();
 client.open("POST", "/log");
 client.setRequestHeader("Content-Type", "text/plain;charset=UTF-8");
 client.send(message);
}</code></pre>

   <p>Or if you want to check the status of a document on the server:</p>

   <pre><code>function fetchStatus(address) {
 var client = new XMLHttpRequest();
 client.onreadystatechange = function() {
  // in case of network errors this might not give reliable results
  if(this.readyState == 4)
   returnStatus(this.status);
 }
 client.open("HEAD", address);
 client.send();
}</code></pre>
  </div>

  <h3 id=conformance><span class=secno>1.2. </span>Conformance</h3>

  <p>Everything in this specification is normative except for diagrams,
   examples, notes and sections marked non-normative.

  <p>The key words <em class=ct>must</em>, <em class=ct>must not</em>, <em
   class=ct>should</em> and <em class=ct>may</em> in this document are to be
   interpreted as described in RFC 2119. [<cite><a
   href="#RFC2119">RFC2119</a></cite>]

  <p>This specification defines the following classes of products:

  <dl>
   <dt><dfn id=conforming-user-agent>Conforming user agent</dfn>

   <dd>
    <p>A user agent <em class=ct>must</em> behave as described in this
     specification in order to be considered conformant.</p>

    <p>If the user agent does not support XML (including support for
     namespaces) the <a href="#xml-response-entity-body">XML response entity
     body</a> <em class=ct>must</em> (always) be <code>null</code>.</p>

    <p>User agents <em class=ct>may</em> optimize any algorithm given in this
     specification, so long as the end result is indistinguishable from the
     result that would be obtained by the specification's algorithms. (The
     algorithms in this specification are generally written with more concern
     for clarity than efficiency.)</p>

    <p class=note>This specification uses both the terms "conforming user
     agent(s)" and "user agent(s)" to refer to this product class.</p>

   <dt><dfn id=conforming-xml-user-agent>Conforming XML user agent</dfn>

   <dd>
    <p>A user agent that is a <a href="#conforming-user-agent">conforming
     user agent</a> and also supports XML (including support for namespaces).
  </dl>

  <h4 id=dependencies><span class=secno>1.2.1. </span>Dependencies</h4>

  <p>This specification relies on several underlying specifications.

  <dl>
   <dt>DOM

   <dd>
    <p><a href="#conforming-user-agent" title="Conforming user
     agent">Conforming user agents</a> <em class=ct>must</em> support some
     version of DOM Events and DOM Core, because this specification uses some
     of the features defined in those specifications. [<cite><a
     href="#DOM3EV">DOM3Events</a></cite>] [<cite><a
     href="#DOM3">DOM3Core</a></cite>]</p>

    <p>It <em class=ct>must</em> also support some version of the Window
     Object because some of the functionality in this specification relies on
     it. [<cite><a href="#ref-window">Window</a></cite>]</p>

   <dt>HTTP

   <dd>
    <p><a href="#conforming-user-agent" title="Conforming user
     agent">Conforming user agents</a> <em class=ct>must</em> support some
     version of the HTTP protocol. The user agent <em class=ct>should</em>
     support any HTTP method that matches the <a
     href="#method"><code>Method</code> production</a> and <em
     class=ct>must</em> at least support the following methods:</p>

    <ul>
     <li><code>GET</code>

     <li><code>POST</code>

     <li><code>HEAD</code>

     <li><code>PUT</code>

     <li><code>DELETE</code>

     <li><code>OPTIONS</code>
    </ul>

    <p>Other requirements regarding HTTP are made throughout the
     specification. [<cite><a href="#RFC2616">RFC2616</a></cite>]</p>

   <dt>XML

   <dd>
    <p><a href="#conforming-xml-user-agent" title="Conforming XML user
     agent">Conforming XML user agents</a> <em class=ct>must</em> support XML
     (including support for namespaces). [<cite><a
     href="#ref-xml">XML</a></cite>] [<cite><a
     href="#ref-xmlns">XMLNS</a></cite>]
  </dl>

  <h4 id=terminology><span class=secno>1.2.2. </span>Terminology</h4>

  <p>There is a <dfn id=case-insensitive-match>case-insensitive match</dfn>
   of strings <var>s1</var> and <var>s2</var> if after uppercasing both
   strings (by mapping a-z to A-Z) they are identical.

  <h4 id=extensibility><span class=secno>1.2.3. </span>Extensibility</h4>

  <p>Extensions of the API defined by this specification are <em>strongly
   discouraged</em>. User agents, Working Groups and other interested parties
   should discuss extensions on a relevant public forum, preferably <a
   href="mailto:public-webapi@w3.org">public-webapi@w3.org</a>.

  <h2 id=xmlhttprequest><span class=secno>2. </span>The <code
   title="">XMLHttpRequest</code> Object</h2>

  <p>The <code><a href="#xmlhttprequest-object">XMLHttpRequest</a></code>
   object can be used by scripts to programmatically connect to their
   originating server via HTTP.

  <p>Objects implementing the <code><a
   href="#xmlhttprequest-object">XMLHttpRequest</a></code> interface <em
   class=ct>must</em> also implement the <code>EventTarget</code> interface.
   [<cite><a href="#DOM3EV">DOM3Events</a></cite>]

  <p>Objects implementing the <code title="">Window</code> interface <em
   class=ct>must</em> provide an <code title="">XMLHttpRequest()</code>
   constructor. [<cite><a href="#ref-window">Window</a></cite>]

  <div class=example>
   <p>In ECMAScript this can be used as follows:</p>

   <pre><code>var client = new XMLHttpRequest();</code></pre>
  </div>

  <p>When the <code title="">XMLHttpRequest()</code> constructor is invoked a
   persistent pointer to the associated <code title="">Window</code> object
   <em class=ct>must</em> be stored on the newly created object. This is the
   <dfn id=window-pointer title="Window pointer"><code>Window</code>
   pointer</dfn>. The associated <code title="">Window</code> object is the
   one of which the <code title="">XMLHttpRequest</code> constructor was
   invoked. This <a href="#window-pointer" title="Window pointer">pointer</a>
   <em class=ct>must</em> persist even if the browsing context in which the
   <code title="">Window</code> is located is destroyed (by removing it from
   a parent browsing context, for instance).

  <p>The term browsing context is defined by the <cite>Window Object
   1.0</cite> specification. [<cite><a href="#ref-window">Window</a></cite>]</p>
  <!-- XXX if the document object changes in the browsing context you get an
  exception in some implementations. -->

  <div class=example>
   <p>If <var><code>win</code></var> is a <code title="">Window</code> object
    <var><code>client</code></var> will have a pointer to
    <var><code>win</code></var> in the following example:</p>

   <pre><code>var client = new win.XMLHttpRequest()</code></pre>
  </div>

  <pre
   class=idl>interface <dfn id=xmlhttprequest-object>XMLHttpRequest</dfn> {
  // event handler
           attribute EventListener <a href="#dfn-onreadystatechange">onreadystatechange</a>;

  // state
  const unsigned short <a href="#unsent" title="UNSENT state">UNSENT</a> = 0;
  const unsigned short <a href="#open" title="OPEN state">OPEN</a> = 1;
  const unsigned short <a href="#sent" title="SENT state">SENT</a> = 2;
  const unsigned short <a href="#loading" title="LOADING state">LOADING</a> = 3;
  const unsigned short <a href="#done" title="DONE state">DONE</a> = 4;
  readonly attribute unsigned short <a href="#dfn-readystate">readyState</a>;

  // request
  void <a href="#dfn-open">open</a>(in DOMString <var>method</var>, in DOMString <var>url</var>);
  void <a href="#dfn-open">open</a>(in DOMString <var>method</var>, in DOMString <var>url</var>, in boolean <var>async</var>);
  void <a href="#dfn-open">open</a>(in DOMString <var>method</var>, in DOMString <var>url</var>, in boolean <var>async</var>, in DOMString <var>user</var>);
  void <a href="#dfn-open">open</a>(in DOMString <var>method</var>, in DOMString <var>url</var>, in boolean <var>async</var>, in DOMString <var>user</var>, in DOMString <var>password</var>);
  void <a href="#dfn-setrequestheader">setRequestHeader</a>(in DOMString <var>header</var>, in DOMString <var>value</var>);
  void <a href="#dfn-send">send</a>();
  void <a href="#dfn-send">send</a>(in DOMString <var>data</var>);
  void <a href="#dfn-send">send</a>(in Document <var>data</var>);
  void <a href="#dfn-abort">abort</a>();

  // response
  DOMString <a href="#dfn-getallresponseheaders">getAllResponseHeaders</a>();
  DOMString <a href="#dfn-getresponseheader">getResponseHeader</a>(in DOMString <var>header</var>);
  readonly attribute DOMString <a href="#dfn-responsetext">responseText</a>;
  readonly attribute Document <a href="#dfn-responsexml">responseXML</a>;
  readonly attribute unsigned short <a href="#dfn-status">status</a>;
  readonly attribute DOMString <a href="#dfn-statustext">statusText</a>;
};</pre>

  <p>The <code><a href="#xmlhttprequest-object">XMLHttpRequest</a></code>
   object can be in five states: <a href="#unsent" title="UNSENT
   state">UNSENT</a>, <a href="#open" title="OPEN state">OPEN</a>, <a
   href="#sent" title="SENT state">SENT</a>, <a href="#loading"
   title="LOADING state">LOADING</a> and <a href="#done" title="DONE
   state">DONE</a>. The current state is exposed through the <code><a
   href="#dfn-readystate">readyState</a></code> attribute. The method
   definitions below define when a state transition takes place.

  <p>When constructed, the <code><a
   href="#xmlhttprequest-object">XMLHttpRequest</a></code> object <em
   class=ct>must</em> be in the UNSENT state. This state is represented by
   the <dfn id=unsent title="UNSENT state"><code>UNSENT</code></dfn>
   constant, whose value is <code>0</code>.

  <p>The OPEN state is the state of the object when the <code><a
   href="#dfn-open">open()</a></code> method has been successfully invoked.
   During this state request headers can be set using <code><a
   href="#dfn-setrequestheader">setRequestHeader()</a></code> and the request
   can be made using <code><a href="#dfn-send">send()</a></code>. This state
   is represented by the <dfn id=open title="OPEN
   state"><code>OPEN</code></dfn> constant, whose value is <code>1</code>.

  <p>During the OPEN state there is a <dfn id=send-flag><code>send()</code>
   flag</dfn> which can be either "true" or "false". The initial value of the
   <code title="">send()</code> flag is "false".

  <p>The SENT state is the state of the object when the user agent
   successfully acknowledged the request. This state is represented by the
   <dfn id=sent title="SENT state"><code>SENT</code></dfn> constant, whose
   value is <code>2</code>.

  <p>The LOADING state is the state of the object when all HTTP headers have
   been received. The object typically remains in this state until the
   complete message body (if any) has been received. This state is
   represented by the <dfn id=loading title="LOADING
   state"><code>LOADING</code></dfn> constant, whose value is <code>3</code>.

  <p>The DONE state is the state of the object when either the data transfer
   has been completed or something went wrong during the transfer (infinite
   redirects for instance). This state is represented by the <dfn id=done
   title="DONE state"><code>DONE</code></dfn> constant, whose value is
   <code>4</code>.

  <p>The <dfn id=response-entity-body>response entity body</dfn> is the
   fragment of the <a href="#dfn-entity-body">entity body</a> received so far
   (LOADING state) or the complete entity body (DONE state). If there is no
   entity body the response entity body is "null".

  <p>The <dfn id=text-response-entity-body>text response entity body</dfn> is
   either a <code>DOMString</code> representing the <a
   href="#response-entity-body">response entity body</a> or
   <code>null</code>. The value of the text response entity body <em
   class=ct>must</em> be determined by running the following algorithm:

  <ol>
   <li>
    <p>If the response entity body is "null" return <code>null</code> and
     terminate these steps.</p>

   <li>
    <p>Let <var>charset</var> be "null".

   <li>
    <p>If there is no <code>Content-Type</code> header or there is a
     <code>Content-Type</code> header which contains a MIME type that is
     <code>text/xml</code>, <code>application/xml</code> or ends in <code
     title="">+xml</code> (ignoring any parameters) use the rules set forth
     in the XML specification to determine the character encoding. Let
     <var>charset</var> be the determined character encoding.

   <li>
    <p>If there is a <code>Content-Type</code> header contains a
     <code>text/html</code> MIME type follow the rules set forth in the HTML
     specification to determine the character encoding. Let
     <var>charset</var> be the determined character encoding.
   </li>
   <!-- XXX ref -->

   <li>
    <p>If the <code>Content-Type</code> MIME type contains a
     <code>charset</code> parameter and <var>charset</var> is "null" let
     <var>charset</var> be the value of that parameter.</p>

    <p class=note>The algorithms described by the XML and HTML specifications
     already take <code>Content-Type</code> into account.</p>

   <li> <!-- This stuff is copied from HTML5. Thanks Hixie! -->
    <p>If <var>charset</var> is "null" then, for each of the rows in the
     following table, starting with the first one and going down, if the
     start of the entity body (<var>bytes</var>) is equal to or greater than
     the number of bytes in the first column, and the first bytes of
     <var>bytes</var> match the bytes given in the first column, then let
     <var>charset</var> be the encoding given in the cell in the second
     column of that row. When an encoding is determined or when no encoding
     is determined go to the next step:</p>

    <table>
     <thead>
      <tr>
       <th>Bytes in Hexadecimal

       <th>Description

     <tbody>
      <tr>
       <td>00 00 FE FF

       <td>UTF-32BE BOM

      <tr>
       <td>FF FE 00 00

       <td>UTF-32LE BOM

      <tr>
       <td>FE FF

       <td>UTF-16BE BOM

      <tr>
       <td>FF FE

       <td>UTF-16LE BOM

      <tr>
       <td>EF BB BF

       <td>UTF-8 BOM<!-- nobody uses this
      <tr>
       <td>DD 73 66 73
       <td>UTF-EBCDIC
-->
        
    </table>

   <li>
    <p>If <var>charset</var> is "null" let <var>charset</var> be UTF-8.

   <li>
    <p>Return the result of decoding the response entity body using
     <var>charset</var>. Or, if that fails, return <code>null</code>.
  </ol>

  <p>The <dfn id=xml-response-entity-body>XML response entity body</dfn> is
   either a <code>Document</code> representing the <a
   href="#response-entity-body">response entity body</a> or <code>null</code>
   and is determined by running the following algorithm (the return value is
   its value):

  <ol>
   <li>
    <p>If the response entity body is "null" terminate these steps and return
     <code>null</code>.

   <li>
    <p>If a <code>Content-Type</code> is present and it does not contain a
     MIME type (ignoring any parameters) that is <code>text/xml</code>,
     <code>application/xml</code> or ends in <code title="">+xml</code>
     terminate these steps and return <code>null</code>. (Do not terminate
     these steps if there is no <code>Content-Type</code> header at all.)

   <li>
    <p>Parse the response entity body following the rules from the XML
     specifications. Let the result be <var>parsed document</var>. If this
     fails (unsupported character encoding, namespace well-formedness error
     et cetera) terminate these steps return <code>null</code>. [<cite><a
     href="#ref-xml">XML</a></cite>] [<cite><a
     href="#ref-xmlns">XMLNS</a></cite>]

   <li>
    <p>Return an object implementing the <code>Document</code> interface
     representing the <var>parsed document</var>.
  </ol>

  <dl>
   <dt><dfn id=dfn-onreadystatechange><code>onreadystatechange</code></dfn>
    of type <code>EventListener</code>

   <dd>
    <p>An attribute that takes an <code>EventListener</code> as value that
     <em class=ct>must</em> be invoked along with any other appropriate event
     listeners that are registered on this object when a <code><a
     href="#dfn-readystatechange">readystatechange</a></code> event is
     dispatched on it during the bubbling phase. Its initial value <em
     class=ct>must</em> be <code>null</code>.</p>

   <dt><dfn id=dfn-readystate><code>readyState</code></dfn> of type
    <code>unsigned short</code>, readonly

   <dd>
    <p>The attribute <em class=ct>must</em> be the value of the constant
     corresponding to the object's current state.</p>

   <dt><dfn id=dfn-open title=open><code>open(<var>method</var>,
    <var>url</var>, <var>async</var>, <var>user</var>,
    <var>password</var>)</code></dfn>, method

   <dd>
    <p>When invoked, the user agent <em class=ct>must</em> follow the
     following steps (unless otherwise indicated):</p>

    <ol>
     <li>
      <p>If the <var>method</var> argument does not match the <dfn
       id=method><code>Method</code> production</dfn> defined in section
       5.1.1 of RFC 2616 raise a <code>SYNTAX_ERR</code> exception and
       terminate these steps. [<cite><a href="#RFC2616">RFC2616</a></cite>]

     <li>
      <p>If the given <var>method</var> is not supported for security reasons
       the user agent <em class=ct>should</em> raise a
       <code>SECURITY_ERR</code> exception and terminate these steps.

     <li>
      <p>Let <var>stored method</var> be <var>method</var>.

     <li>
      <p>If <var>method</var> <a href="#case-insensitive-match"
       title="case-insensitive match">case-insensitively matches</a>
       <code>GET</code>, <code>POST</code>, <code>HEAD</code>,
       <code>PUT</code>, <code>DELETE</code> or <code>OPTIONS</code> convert
       it to its uppercase equivalent (by mapping a-z to A-Z) and let
       <var>stored method</var> be the result.
     </li>
     <!-- WebKit (and supposedly Firefox) also uppercase: CONNECT, COPY,
     INDEX, LOCK, M-POST, MKCOL, MOVE, PROPFIND, PROPPATCH, TRACE and UNLOCK.
     Not sure if TRACE and CONNECT are worth it though. They raise a
     SECURITY_ERR exception anyway... -->

     <li>
      <p>Drop the fragment identifier (if any) from <var>url</var> and let
       <var>stored url</var> be the result of that operation.

     <li>
      <p>If <var>stored url</var> is a relative reference resolve it using
       the current value of the <code>baseURI</code> attribute of the
       <code>Document</code> object currently associated with the <a
       href="#window-pointer"><code>Window</code> pointer</a>. If this fails
       raise a <code>SYNTAX_ERR</code> exception and terminate these steps.

     <li>
      <p>If <var>stored url</var> contains an unsupported scheme raise a
       <code>NOT_SUPPORTED_ERR</code> and terminate these steps.

     <li>
      <p>If the <code>"user:password"</code> format in the
       <code>userinfo</code> production defined in section 3.2.1 of RFC 3986
       is not supported for the relevant scheme and <var>stored url</var>
       contains this format raise a <code>SYNTAX_ERR</code> and terminate
       these steps. [<cite><a href="#ref-rfc3986">RFC3986</a></cite>]

     <li>
      <p>If <var>stored url</var> contains the <code>"user:password"</code>
       format let <var>stored user</var> be the user part and <var>stored
       password</var> be the password part.

     <li>
      <p>If <var>stored url</var> just contains the <code>"user"</code>
       format let <var>stored user</var> be the user part.

     <li>
      <p>If <var>stored url</var> is non same-origin the user agent <em
       class=ct>should</em> raise a <code>SECURITY_ERR</code> exception and
       terminate these steps.</p>

      <p class=note>This specification does not define what constitutes as
       non same-origin. It is expected that what constitutes as non
       same-origin will be defined before this specification eventually
       reaches the W3C Recommendation status by way of referencing a
       specification that defines it.<!-- XXX reference HTML5? --></p>

     <li>
      <p>Let <var>async</var> be the value of the <var>async</var> argument
       or <code>true</code> if it was omitted.

     <li>
      <p>If the <var>user</var> argument was not omitted and its syntax does
       not match that specified by the relevant authentication scheme raise a
       <code>SYNTAX_ERR</code> exception and terminate these steps.

     <li>
      <p>If the <var>user</var> argument was not omitted and is not
       <code>null</code> let <var>stored user</var> be <var>user</var>
       encoded using the encoding specified in the relevant authentication
       scheme or UTF-8 if the scheme fails to specify an encoding.</p>

      <p class=note>This step overrides any user that may have been set by
       the <var>url</var> argument.</p>

     <li>
      <p>If the <var>user</var> argument was not omitted and is
       <code>null</code> remove <var>stored user</var>.

     <li>
      <p>If the <var>password</var> argument was not omitted and its syntax
       does not match that specified by the relevant authentication scheme
       raise a <code>SYNTAX_ERR</code> exception and terminate these steps.

     <li>
      <p>If the <var>password</var> argument was not omitted and is not
       <code>null</code> let <var>stored password</var> be
       <var>password</var> encoded using the encoding specified in the
       relevant authentication scheme or UTF-8 if the scheme fails to specify
       an encoding.

     <li>
      <p>If the <var>password</var> argument was not omitted and is
       <code>null</code> remove <var>stored password</var>.

     <li>
      <p><a href="#abort-send-algorithm" title="abort send()">Abort the
       <code>send()</code> algorithm</a>, set <a
       href="#response-entity-body">response entity body</a> to "null" and
       reset the list of request headers.

      <p>

     <li>
      <p>The user agent <em class=ct>should</em> cancel any network activity
       for which the object is responsible.
     </li>
     <!-- we can hardly require it... -->

     <li>
      <p>Switch the object to the <a href="#open" title="OPEN state">OPEN</a>
       state, set the <a href="#send-flag"><code>send()</code> flag</a> to
       "false" and then synchronously dispatch a <code><a
       href="#dfn-readystatechange">readystatechange</a></code> event on the
       object and return the method call.
    </ol>

    <p class=note>A future version or extension of this specification will
     most likely define a way of doing cross-site requests.</p>

   <dt><dfn id=dfn-setrequestheader
    title=setrequestheader><code>setRequestHeader(<var>header</var>,
    <var>value</var>)</code></dfn>, method

   <dd>
    <p>Each request has a list of request headers with associated values.
     This method can be used to manipulate those values and set new request
     headers.</p>

    <p>When invoked, the user agent <em class=ct>must</em> follow the
     following steps (unless otherwise indicated):</p>

    <ol>
     <li>
      <p>If the state of the object is not <a href="#open" title="OPEN
       state">OPEN</a> raise an <code>INVALID_STATE_ERR</code> exception and
       terminate these steps.

     <li>
      <p>If the <a href="#send-flag"><code>send()</code> flag</a> is "true"
       raise an <code>INVALID_STATE_ERR</code> exception and terminate these
       steps.

     <li>
      <p>If the <var>header</var> argument does not match the <dfn
       id=field-name><code>field-name</code> production</dfn> as defined by
       section 4.2 of RFC 2616 or is <code>null</code> raise a
       <code>SYNTAX_ERR</code> exception and terminate these steps. [<cite><a
       href="#RFC2616">RFC2616</a></cite>]

     <li>
      <p>If the <var>value</var> argument is <code>null</code> terminate
       these steps. (Do not raise an exception.)
     </li>
     <!-- undefined is to be treated as null here... -->

     <li>
      <p>If the <var>value</var> argument does not match the <dfn
       id=field-value><code>field-value</code> production</dfn> as defined by
       section 4.2 of RFC 2616 raise a <code>SYNTAX_ERR</code> and terminate
       these steps. [<cite><a href="#RFC2616">RFC2616</a></cite>]

     <li>
      <p>For security reasons these steps <em class=ct>should</em> be
       terminated if the <var>header</var> argument <a
       href="#case-insensitive-match" title="case-insensitive
       match">case-insensitively matches</a> one of the following headers:</p>

      <ul>
       <li><code>Accept-Charset</code>

       <li><code>Accept-Encoding</code>

       <li><code>Connection</code>

       <li><code>Content-Length</code>

       <li><code>Content-Transfer-Encoding</code>

       <li><code>Date</code>

       <li><code>Expect</code>

       <li><code>Host</code>

       <li><code>Keep-Alive</code>

       <li><code>Referer</code>

       <li><code>TE</code>

       <li><code>Trailer</code>

       <li><code>Transfer-Encoding</code>

       <li><code>Upgrade</code>

       <li><code>Via</code>
      </ul>

     <li>
      <p>If the <var>header</var> argument is not in the list of request
       headers append the <var>header</var> with its associated
       <var>value</var> to the list and terminate these steps.

     <li>
      <p>If the <var>header</var> argument is in the list of request headers
       either use multiple headers, combine the values or use a combination
       of those (section 4.2, RFC 2616). [<cite><a
       href="#RFC2616">RFC2616</a></cite>]
     </li>
     <!-- XXX it seems UAs always combine the values -->
    </ol>

    <p class=note>See also the <code><a href="#dfn-send">send()</a></code>
     method regarding user agent header handling for caching, authentication,
     proxies, and cookies.</p>

    <div class=example>
     <pre><code>// The following script:
var client = new XMLHttpRequest();
client.open('GET', 'demo.cgi');
client.setRequestHeader('X-Test', 'one');
client.setRequestHeader('X-Test', 'two');
client.send();

// ...would result in the following header being sent:
...
X-Test: one, two
...</code></pre>
    </div>

   <dt><dfn id=dfn-send title=send><code>send(<var>data</var>)</code></dfn>,
    method

   <dd>
    <p>The <code><a href="#dfn-send">send()</a></code> method initiates the
     request and its optional argument provides the <a
     href="#dfn-entity-body">entity body</a>. Authors are strongly encouraged
     to ensure that they have specified the <code>Content-Type</code> header
     via <code><a href="#dfn-setrequestheader">setRequestHeader()</a></code>
     before invoking <code><a href="#dfn-send">send()</a></code> with a
     non-<code>null</code> <var>data</var> argument.</p>

    <p>When invoked, the user agent <em class=ct>must</em> follow the
     following steps (unless otherwise noted). Note that this algorithm might
     get aborted if the <code><a href="#dfn-open">open()</a></code> or
     <code><a href="#dfn-abort">abort()</a></code> is invoked. When the <dfn
     id=abort-send-algorithm title="abort send()"><code>send()</code>
     algorithm is aborted</dfn> the user agent <em class=ct>must</em>
     terminate the algorithm after finishing the step it is on.</p>

    <p class=note>The following algorithm can not be aborted through script
     when <var>async</var> is <code>false</code>. It can only be aborted when
     <var>async</var> is <code>true</code> and only after the method call has
     returned.</p>

    <ol>
     <li>
      <p>If the state of the object is not <a href="#open" title="OPEN
       state">OPEN</a> raise an <code>INVALID_STATE_ERR</code> exception and
       terminate these steps.

     <li>
      <p>If the <a href="#send-flag"><code>send()</code> flag</a> is "true"
       raise an <code>INVALID_STATE_ERR</code> exception and terminate these
       steps.

     <li>
      <p>If <var>async</var> is <code>true</code> set the <a
       href="#send-flag"><code>send()</code> flag</a> to "true".

     <li>
      <p>If the <var>data</var> argument has not been omitted and is not
       <code>null</code> use it for the <dfn id=dfn-entity-body>entity
       body</dfn> as defined by section 7.2 of RFC 2616 observing the
       following rules: [<cite><a href="#RFC2616">RFC2616</a></cite>]</p>

      <dl>
       <dt><var>data</var> is a <code>DOMString</code>

       <dd>
        <p>Encode <var>data</var> using UTF-8 for transmission.

       <dt><var>data</var> is a <code>Document</code>

       <dd>
        <p>Serialize <var>data</var> into a namespace well-formed XML
         document and encoded using the encoding given by
         <code><var>data</var>.xmlEncoding</code>, if specified, or UTF-8
         otherwise. Or, if this fails because the <code>Document</code>
         cannot be serialized act as if <var>data</var> is <code>null</code>.</p>

        <p>If no <code>Content-Type</code> header is in the list of request
         headers append it to the list of request headers with a value of
         <code>application/xml</code>.</p>

        <p class=note>Subsequent changes to the <code>Document</code> have no
         effect on what is submitted.</p>

       <dt><var>data</var> is not a <code>DOMString</code> or
        <code>Document</code>

       <dd>
        <p>Use the stringification mechanisms of the host language on
         <var>data</var> and treat the result as if <var>data</var> is a
         <code>DOMString</code>. Or, if this fails, act as if <var>data</var>
         is <code>null</code>.
      </dl>

      <p>If the data argument has been omitted or is <code>null</code> no
       entity body is used in the request.</p>

     <li>
      <p>Make a request to <var>stored url</var>, using HTTP method
       <var>stored method</var>, user <var>stored user</var> (if provided)
       and password <var>stored password</var> (if provided), taking into
       account the entity body, list of request headers and the rules listed
       directly after this set of steps.

     <li>
      <p>Synchronously dispatch a <code><a
       href="#dfn-readystatechange">readystatechange</a></code> event on the
       object.</p>

      <p class=note>The state of the object does not change. The event is
       dispatched for historical reasons.</p>

     <li>
      <p>If <var>async</var> is <code>true</code> return the <code><a
       href="#dfn-send">send()</a></code> method call. (Do not terminate the
       steps in the algorithm though.)

     <li>
      <p>While downloading the resource the steps in this step are to be
       observed.</p>

      <dl>
       <dt>If the response is an HTTP redirect

       <dd>
        <p>If the redirect does not violate security or infinite loop
         precautions and the scheme is supported transparently follow it and
         go to the start of this step.</p>

        <p class=note>HTTP places requirements on the user agent regarding
         the preservation of the request method and entity body during
         redirects, and also requires users to be notified of certain kinds
         of automatic redirections.</p>
        <!-- Arguably HTTP should be fixed for the latter case. No browser
        follows that as far as I know. -->
        
        <p>Otherwise, follow the following set of steps:</p>

        <ol>
         <li>
          <p>Set <a href="#response-entity-body">response entity body</a> to
           "null" and reset the list of request headers.

         <li>
          <p>Synchronously switch the state to <a href="#done" title="DONE
           state">DONE</a>.

         <li>
          <p>If <var>async</var> is set to <code>false</code> raise a
           <code><a href="#network-err">NETWORK_ERR</a></code> exception and
           terminate the overall algorithm.

         <li>
          <p>Synchronously dispatch a <code><a
           href="#dfn-readystatechange">readystatechange</a></code> event on
           the object.

         <li>
          <p>Terminate the overall algorithm.
        </ol>

        <p class=note>It is likely that a future version of the <code><a
         href="#xmlhttprequest-object">XMLHttpRequest</a></code> object will
         dispatch an <code>error</code> event here as well.</p>

       <dt>If the user cancels the download

       <dd>
        <p>Run the following set of steps:</p>

        <ol>
         <li>
          <p>Set <a href="#response-entity-body">response entity body</a> to
           "null" and reset the list of request headers.

         <li>
          <p>Synchronously switch the state to <a href="#done" title="DONE
           state">DONE</a>.

         <li>
          <p>If <var>async</var> is set to <code>false</code> raise a
           <code><a href="#network-err">NETWORK_ERR</a></code> exception and
           terminate the overall algorithm.

         <li>
          <p>Synchronously dispatch a <code><a
           href="#dfn-readystatechange">readystatechange</a></code> event on
           the object.

         <li>
          <p>Terminate the overall algorithm.
        </ol>

        <p class=note>It is likely that a future version of the <code><a
         href="#xmlhttprequest-object">XMLHttpRequest</a></code> object will
         dispatch an <code>error</code> event here as well.</p>

       <dt>In case of network errors

       <dd>
        <p>In case of DNS errors or other type of networks run the following
         set of steps. <span class=note>This does not include HTTP responses
         that indicate some type of error, such as HTTP status code
         410.</span></p>

        <ol>
         <li>
          <p>Set <a href="#response-entity-body">response entity body</a> to
           "null" and reset the list of request headers.

         <li>
          <p>Synchronously switch the state to <a href="#done" title="DONE
           state">DONE</a>.

         <li>
          <p>If <var>async</var> is set to <code>false</code> raise a
           <code><a href="#network-err">NETWORK_ERR</a></code> exception and
           terminate the overall algorithm.

         <li>
          <p>Synchronously dispatch a <code><a
           href="#dfn-readystatechange">readystatechange</a></code> event on
           the object.

         <li>
          <p>Terminate the overall algorithm.
        </ol>

        <p class=note>It is likely that a future version of the <code><a
         href="#xmlhttprequest-object">XMLHttpRequest</a></code> object will
         dispatch an <code>error</code> event here as well.</p>

       <dt>Once all HTTP headers have been received

       <dd>
        <p>If all HTTP headers have been received, before receiving the
         message body (if any), follow the following steps:</p>

        <ol>
         <li>
          <p>Synchronously switch the state to <a href="#sent" title="SENT
           state">SENT</a>.

         <li>
          <p>Synchronously dispatch a <code><a
           href="#dfn-readystatechange">readystatechange</a></code> event on
           the object.

         <li>
          <p>Synchronously switch the state to <a href="#loading"
           title="LOADING state">LOADING</a>.

         <li>
          <p>Synchronously dispatch a <code><a
           href="#dfn-readystatechange">readystatechange</a></code> event on
           the object.
        </ol>
      </dl>

      <p>Finally, if the complete resource has been downloaded go to the next
       step.</p>

     <li>
      <p>When the request has successfully completed loading, synchronously
       switch the state to <a href="#done" title="DONE state">DONE</a> and
       then synchronously dispatch a <code><a
       href="#dfn-readystatechange">readystatechange</a></code> event on the
       object and return the method call in case of <var>async</var> being
       <code>false</code>.
    </ol>

    <p>If the user agent allows the user to configure a proxy it <em
     class=ct>should</em> modify the request appropriately; <abbr title="in
     other words">i.e.</abbr>, connect to the proxy host instead of the
     origin server, modify the <code>Request-Line</code> and send
     <code>Proxy-Authorization</code> headers as specified.</p>

    <p>If the user agent supports HTTP Authentication it <em
     class=ct>should</em> consider requests originating from this object to
     be part of the protection space that includes the accessed URIs and send
     <code>Authorization</code> headers and handle <code>401
     Unauthorised</code> requests appropriately. If authentication fails,
     user agents <em class=ct>should</em> prompt the users for credentials.
     [<cite><a href="#ref-rfc2617">RFC2617</a></cite>]</p>

    <p>If the user agent supports HTTP State Management it <em
     class=ct>should</em> persist, discard and send cookies (as received in
     the <code>Set-Cookie</code> and <code>Set-Cookie2</code> response
     headers, and sent in the <code>Cookie</code> header) as applicable.
     [<cite><a href="#ref-rfc2965">RFC2965</a></cite>]</p>

    <p>If the user agent implements a HTTP cache it <em class=ct>should</em>
     respect <code>Cache-Control</code> request headers set by the script
     (<abbr title="for example">e.g.</abbr>, <code>Cache-Control:
     no-cache</code> bypasses the cache). It <em class=ct>must not</em> send
     <code>Cache-Control</code> or <code>Pragma</code> request headers
     automatically unless the user explicitly requests such behaviour
     (<abbr>e.g.</abbr>, by (force-)reloading the page). <code>304 Not
     Modified</code> responses that are a result of a user agent generated
     conditional request <em class=ct>must</em> be presented as <code>200
     OK</code> responses with the appropriate content. The user agent <em
     class=ct>must</em> allow scripts to override automatic cache validation
     by setting request headers (e.g., <code>If-None-Match</code>,
     <code>If-Modified-Since</code>), in which case <code>304 Not
     Modified</code> responses <em class=ct>must</em> be passed through.
     [<cite><a href="#RFC2616">RFC2616</a></cite>]</p>

    <p>If the user agent implements server-driven content-negotiation it <em
     class=ct>should</em> set <code>Accept-Language</code>,
     <code>Accept-Encoding</code> and <code>Accept-Charset</code> headers as
     appropriate; it <em class=ct>must not</em> automatically set the
     <code>Accept</code> header. Responses to such requests <em
     class=ct>must</em> have the content-codings automatically decoded.
     [<cite><a href="#RFC2616">RFC2616</a></cite>]</p>

   <dt><dfn id=dfn-abort><code>abort()</code></dfn>, method

   <dd>
    <p>When invoked, the user agent <em class=ct>must</em> run the following
     steps (unless otherwise noted):</p>

    <ol>
     <li>
      <p><a href="#abort-send-algorithm" title="abort send()">Abort the
       <code>send()</code> algorithm</a>, set the <a
       href="#response-entity-body">response entity body</a> to "null", set
       the <a href="#send-flag"><code>send()</code> flag</a> to "false" and
       remove any registered request headers.

     <li>
      <p>The user agent <em class=ct>should</em> cancel any network activity
       for which the object is responsible.

     <li>
      <p>If the state is <a href="#unsent" title="UNSENT state">UNSENT</a>,
       <a href="#open" title="OPEN state">OPEN</a> and the <a
       href="#send-flag"><code>send()</code> flag</a> is "false", or <a
       href="#done" title="DONE state">DONE</a> go to the next step.</p>

      <p>Otherwise, switch the state to <a href="#done" title="DONE
       state">DONE</a> and synchronously dispatch a <code><a
       href="#dfn-readystatechange">readystatechange</a></code> event on the
       object.</p>

     <li>
      <p>Switch the state to <a href="#unsent" title="UNSENT
       state">UNSENT</a>. (Do not dispatch the <code><a
       href="#dfn-readystatechange">readystatechange</a></code> event.)</p>

      <p class=note>It is likely that a future version of the <code><a
       href="#xmlhttprequest-object">XMLHttpRequest</a></code> object will
       dispatch an <code title="">abort</code> event here as well.</p>
    </ol>

   <dt><dfn
    id=dfn-getallresponseheaders><code>getAllResponseHeaders()</code></dfn>,
    method

   <dd>
    <p>When invoked, the user agent <em class=ct>must</em> run the following
     steps:</p>

    <ol>
     <li>
      <p>If the state is not <a href="#loading" title="LOADING
       state">LOADING</a> or <a href="#done" title="DONE state">DONE</a>
       raise an <code>INVALID_STATE_ERR</code> exception and terminate these
       steps.

     <li>
      <p>Return all the HTTP headers, as a single string, with each header
       line separated by a U+000D CR U+000A LF pair excluding the status
       line.
    </ol>

    <div class=example>
     <pre><code>// The following script:
var client = new XMLHttpRequest();
client.open("GET", "test.txt", true);
client.send();
client.onreadystatechange = function() {
 if(this.readyState == 3) {
  print(this.getAllResponseHeaders());
 }
}

// ...should output something similar to the following text:
Date: Sun, 24 Oct 2004 04:58:38 GMT
Server: Apache/1.3.31 (Unix)
Keep-Alive: timeout=15, max=99
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/plain; charset=utf-8</code></pre>
    </div>

   <dt><dfn id=dfn-getresponseheader
    title=getresponseheader><code>getResponseHeader(<var>header</var>)</code></dfn>,
    method

   <dd>
    <p>When the method is invoked, the user agent <em class=ct>must</em> run
     the following steps:</p>

    <ol>
     <li>
      <p>If the state is not <a href="#loading" title="LOADING
       state">LOADING</a> or <a href="#done" title="DONE state">DONE</a>
       raise an <code>INVALID_STATE_ERR</code> exception and terminate these
       steps.

     <li>
      <p>If the <var>header</var> argument does not match the <a
       href="#field-name"><code>field-name</code> production</a> raise a
       <code>SYNTAX_ERR</code> exception and terminate these steps.

     <li>
      <p>If the <var>header</var> argument <a href="#case-insensitive-match"
       title="case-insensitive match">case-insensitively matches</a> multiple
       HTTP headers for the last request sent return the values of these
       headers as a single concatenated string separated from each other by
       an U+002C COMMA followed by an U+0020 SPACE and terminate these steps.

     <li>
      <p>If the <var>header</var> argument <a href="#case-insensitive-match"
       title="case-insensitive match">case-insensitively matches</a> a single
       HTTP header for the last request sent return the value of that header
       and terminate these steps.

     <li>
      <p>Return <code>null</code>.
    </ol>

    <div class=example>
     <pre><code>// The following script:
var client = new XMLHttpRequest();
client.open("GET", "test.txt", true);
client.send();
client.onreadystatechange = function() {
 if(this.readyState == 3) {
  print(client.getResponseHeader("Content-Type"));
 }
}

// ...should output something similar to the following text:
Content-Type: text/plain; charset=utf-8</code></pre>
    </div>

   <dt><dfn id=dfn-responsetext><code>responseText</code></dfn> of type
    <code>DOMString</code>, readonly

   <dd>
    <p>On getting, the user agent <em class=ct>must</em> run the following
     steps:</p>

    <ol>
     <li>
      <p>If the state is not <a href="#loading" title="LOADING
       state">LOADING</a> or <a href="#done" title="DONE state">DONE</a>
       raise an <code>INVALID_STATE_ERR</code> exception and terminate these
       steps.

     <li>
      <p>Return the <a href="#text-response-entity-body">text response entity
       body</a>.
    </ol>

   <dt><dfn id=dfn-responsexml><code>responseXML</code></dfn> of type
    <code>Document</code>, readonly

   <dd>
    <p>On getting, the user agent <em class=ct>must</em> run the following
     steps:</p>

    <ol>
     <li>
      <p>If the state is not <a href="#done" title="DONE state">DONE</a>
       raise an <code>INVALID_STATE_ERR</code> exception and terminate these
       steps.

     <li>
      <p>Return the <a href="#xml-response-entity-body">XML response entity
       body</a>.
    </ol>

   <dt><dfn id=dfn-status><code>status</code></dfn> of type <code>unsigned
    short</code>, readonly

   <dd>
    <p>On getting, if available, it <em class=ct>must</em> return the HTTP
     status code sent by the server (typically <code>200</code> for a
     successful request). Otherwise, if not available, the user agent <em
     class=ct>must</em> raise an <code>INVALID_STATE_ERR</code> exception.</p>

   <dt><dfn id=dfn-statustext><code>statusText</code></dfn> of type
    <code>DOMString</code>, readonly

   <dd>
    <p>On getting, if available, it <em class=ct>must</em> return the HTTP
     status text sent by the server (appears after the status code).
     Otherwise, if not available, the user agent <em class=ct>must</em> raise
     an <code>INVALID_STATE_ERR</code> exception.</p>
  </dl>

  <h3 id=events><span class=secno>2.1. </span>Events for the <code
   title="">XMLHttpRequest</code> Object</h3>

  <p>These sections describe the various events that can be dispatched on the
   object implementing the <code><a
   href="#xmlhttprequest-object">XMLHttpRequest</a></code> interface. For
   this version of the specification only one event is defined.

  <dl>
   <dt><dfn id=dfn-readystatechange><code>readystatechange</code></dfn>

   <dd>When the user agent dispatches a <code
    title="">readystatechange</code> event (as indicated above) it <em
    class=ct>must not</em> bubble, <em class=ct>must not</em> be cancelable
    and <em class=ct>must</em> implement the <code>Event</code> interface.
    Its <code>namespaceURI</code> attribute <em class=ct>must</em> be
    <code>null</code>. [<cite><a href="#DOM3EV">DOM3Events</a></cite>]
  </dl>

  <h3 id=exceptions><span class=secno>2.2. </span>Exceptions for the <code
   title="">XMLHttpRequest</code> Object</h3>

  <pre
   class=idl>exception <dfn id=xmlhttprequestexception>XMLHttpRequestException</dfn> {
  unsigned short     code;
};
const unsigned short <a href="#network-err">NETWORK_ERR</a> = 101;</pre>

  <p>The <dfn id=network-err><code>NETWORK_ERR</code></dfn> exception is
   thrown when a network error occurs in synchronous requests. See the
   section on <code><a href="#dfn-send">send()</a></code> for more details.

  <h2 class=no-num id=notcovered>Not in this Specification</h2>

  <p><em>This section is non normative.</em>

  <p>This specification does not include the following features which are
   being considered for a future version of this specification:

  <ul>
   <li><code>load</code> event and <code>onload</code> attribute;

   <li><code>error</code> event and <code>onerror</code> attribute;

   <li><code>progress</code> event and <code>onprogress</code> attribute;

   <li><code title="">abort</code> event and <code>onabort</code> attribute;

   <li>Timers have been suggested, perhaps an <code>ontimeout</code>
    attribute;

   <li>Property to disable following redirects;

   <li><code title="">responseXML</code> for <code>text/html</code>
    documents;

   <li>Cross-site <code title="">XMLHttpRequest</code>;

   <li><code>responseBody</code> to deal with byte streams;

   <li><code>overrideMimeType</code> to fix up MIME types;

   <li><code>getRequestHeader()</code> and
    <code>removeRequestHeader()</code>.
  </ul>

  <h2 class=no-num id=bibref>References</h2>

  <dl>
   <dt>[<dfn id=DOM3>DOM3Core</dfn>]

   <dd><cite><a href="http://www.w3.org/TR/DOM-Level-3-Core">Document Object
    Model (DOM) Level 3 Core Specification</a></cite>, A. Le Hors, P. Le
    Hégaret, L. Wood, G. Nicol, J. Robie, M. Champion, S. Byrne, editors.
    W3C, April 2004.

   <dt>[<dfn id=DOM3EV>DOM3Events</dfn>]

   <dd><cite><a href="http://www.w3.org/TR/DOM-Level-3-Events/">Document
    Object Model (DOM) Level 3 Events Specification</a></cite>, Björn
    Höhrmann, editor. W3C, April 2006.

   <dt>[<dfn id=ref-ecmascript>ECMAScript</dfn>]

   <dd><cite><a
    href="http://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMAScript
    Language Specification</a></cite>, Third Edition. ECMA, December 1999.

   <dt>[<dfn id=ref-rfc2046>RFC2046</dfn>]

   <dd><cite><a href="http://ietf.org/rfc/rfc2046">Multipurpose Internet Mail
    Extensions (MIME) Part Two: Media Types</a></cite>, N. Freed, N.
    Borenstein, editors. IETF, November 1996.

   <dt>[<dfn id=RFC2119>RFC2119</dfn>]

   <dd><cite><a href="http://ietf.org/rfc/rfc2119">Key words for use in RFCs
    to Indicate Requirement Levels</a></cite>, S. Bradner. IETF, March 1997.

   <dt>[<dfn id=RFC2616>RFC2616</dfn>]

   <dd><cite><a href="http://ietf.org/rfc/rfc2616">Hypertext Transfer
    Protocol -- HTTP/1.1</a></cite>, R. Fielding, J. Gettys, J. Mogul, H.
    Frystyk, L. Masinter, P. Leach, T. Berners-Lee, editors. IETF, June 1999.

   <dt>[<dfn id=ref-rfc2617>RFC2617</dfn>]

   <dd><cite><a href="http://ietf.org/rfc/rfc2617">HTTP Authentication: Basic
    and Digest Access Authentication</a></cite>, P. Hallam-Baker, J.
    Hostetler, S. Lawrence, P. Leach, A. Luotonen, L. Stewart, editors. IETF,
    June 1999.

   <dt>[<dfn id=ref-rfc2965>RFC2965</dfn>]

   <dd><cite><a href="http://ietf.org/rfc/rfc2965">HTTP State Management
    Mechanism</a></cite>, D. Kristol, L. Montulli, editors. IETF, October
    2000.

   <dt>[<dfn id=ref-rfc3986>RFC3986</dfn>]

   <dd><cite><a href="http://ietf.org/rfc/rfc3986">Uniform Resource
    Identifier (URI): Generic Syntax</a></cite>, T. Berners-Lee, R. Fielding,
    L. Masinter, editors. IETF, January 2005.

   <dt>[<dfn id=ref-window>Window</dfn>]

   <dd><cite><a href="http://www.w3.org/TR/Window/">Window Object
    1.0</a></cite>, I. Davis, M. Stachowiak, editors. W3C, April 2006.

   <dt>[<dfn id=ref-xml>XML</dfn>]

   <dd><cite><a href="http://www.w3.org/TR/xml/">Extensible Markup Language
    (XML) 1.0 (Fourth Edition)</a></cite>, T. Bray, J. Paoli, C.
    Sperberg-McQueen, E. Maler, F. Yergeau, editors. W3C, September 2006.

   <dt>[<dfn id=ref-xmlns>XMLNS</dfn>]

   <dd><cite><a href="http://www.w3.org/TR/xml-names/">Namespaces in XML
    (Second Edition)</a></cite>, T. Bray, D. Hollander, A. Layman, R. Tobin,
    editors. W3C, August 2006.
  </dl>

  <h2 class=no-num id=acknowledgements>Acknowledgements</h2>

  <p><em>This section is non-normative</em>

  <p>The editor would like to thank to the following people who have
   contributed to this specification (ordered by first name):

  <ul>
   <li>Ahmed Kamel

   <li>Alex Hopmann

   <li>Alex Vincent

   <li>Alexey Proskuryakov

   <li>Asbjørn Ulsberg

   <li>Boris Zbarsky

   <li>Björn Höhrmann

   <li>Cameron McCormack

   <li>Christophe Jolif

   <li>Charles McCathieNevile

   <li>Dan Winship

   <li>David Håsäther

   <li>Dean Jackson

   <li>Doug Schepers

   <li>Douglas Livingstone

   <li>Eric Lawrence

   <li>Gideon Cohn

   <li>Gorm Haug Eriksen

   <li>Hallvord R. M. Steen

   <li>Håkon Wium Lie

   <li>Ian Davis

   <li>Ian Hickson

   <li>Ivan Herman

   <li>Jens Lindström

   <li>Jim Deegan

   <li>Jim Ley

   <li>Joe Farro

   <li>Jonas Sicking

   <li>Julian Reschke

   <li>Karl Dubost

   <li>Maciej Stachowiak

   <li>Magnus Kristiansen

   <li>Marc Hadley

   <li>Marcos Caceres

   <li>Mark Baker

   <li>Mark Nottingham

   <li>Mohamed Zergaoui

   <li>Pawel Glowacki

   <li>Robin Berjon

   <li>Ruud Steltenpool

   <li>Simon Pieters

   <li>Sunava Dutta

   <li>Zhenbin Xu
  </ul>

  <p>Special thanks to the Microsoft employees who first implemented the
   <code><a href="#xmlhttprequest-object">XMLHttpRequest</a></code>
   interface, which was first widely deployed by the Windows Internet
   Explorer browser.

  <p>Special thanks also to the WHATWG for drafting an initial version of
   this specification in their Web Applications 1.0 document.

  <p>Thanks also to all those who have helped to improve this specification
   by sending suggestions and corrections. (Please, keep bugging us with your
   issues!)
