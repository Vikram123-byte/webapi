<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
          ******* WARNING ********
          This document was automatically generated using the Re-Spec specification
          publishing system. Edits made here are likely to be lost when it is
          regenerated.
          ******* WARNING ********
        --><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>The XMLHttpRequest Object</title><link rel="stylesheet" href="respec-w3c.css" type="text/css"></link><link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/base" type="text/css"></link><meta name="revision" content="$Id: XMLHttpRequest.html,v 1.23 2006-05-14 12:28:32 avankest Exp $"></meta></head><body><div class="head"><p><a href="http://www.w3.org/"><img class="head" src="http://www.w3.org/Icons/w3c_home" width="72" height="48" alt="W3C"></img></a></p><h1 class="head">The XMLHttpRequest Object</h1><h2 id="pagesubtitle">W3C Editor's Draft <em>14 May 2006</em></h2><dl><dt>This version:</dt><dd><a href=""></a></dd><dt>Latest version:</dt><dd><a href="http://www.w3.org/TR/XMLHttpRequest/">http://www.w3.org/TR/XMLHttpRequest/</a></dd><dt>Previous version:</dt><dd><a href="http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060405/">http://www.w3.org/TR/2006/WD-XMLHttpRequest-20060405/</a></dd><dt>Editors:</dt><dd><span class="person"><a href="http://annevankesteren.nl/">Anne van Kesteren</a> (<a href="http://www.opera.com/">Opera Software ASA</a>) &lt;<a href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;</span></dd><dd><span class="person"><a href="http://www.w3.org/People/Dean/">Dean Jackson</a> (<a href="http://www.w3.org/">W3C</a>) &lt;<a href="mailto:dino@w3.org">dino@w3.org</a>&gt;</span></dd></dl><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©2006
        <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>,
        <a href="http://www.ercim.org/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and 
        <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document  use</a> rules apply.
      </p></div><hr></hr>
 
 <h2 id="specabstract">Abstract</h2><div class="section">
  
  <p>This specification defines the <code>XMLHttpRequest</code> object, an
   <abbr title="Application Programming Interface">API</abbr> that provides
   additional <abbr title="HyperText Transfer Protocol">HTTP</abbr> client
   functionality for transferring data between a client and a server.</p>
  <div class="ednote">
   <p>Last update: $Id: XMLHttpRequest.html,v 1.23 2006-05-14 12:28:32 avankest Exp $.</p>
  </div>
 </div>
 <div class="section"><h2 id="sotd">Status of this Document</h2>
  
  
  <p>
    <em>This section describes the status of this document at the time of its publication.
    Other documents may supersede this document. A list of current <acronym title="World Wide Web Consortium">W3C</acronym> publications and the
    latest revision of this technical report can be found in the 
    <a href="http://www.w3.org/TR/"><acronym title="World Wide Web Consortium">W3C</acronym>
    technical reports index</a> at http://www.w3.org/TR/.</em>
  </p>

  <p>This document is a Working Group draft. It is <strong>not an official
   publication</strong> of the <acronym title="World Wide Web Consortium">W3C</acronym>.</p>
  <p>This document is produced by the
   <a href="http://www.w3.org/2006/webapi">Web APIs WG</a>, part of the
   <a href="http://www.w3.org/2006/rwc/Activity">Rich Web Clients Activity</a>
   in the <acronym title="World Wide Web Consortium">W3C</acronym> <a href="http://www.w3.org/Interaction/">Interaction
   Domain</a>.</p>
  <p>Web content and browser developers are encouraged to review this draft.
   Please send comments to
   <a href="mailto:public-webapi@w3.org">public-webapi@w3.org</a>, the <acronym title="World Wide Web Consortium">W3C</acronym>'s
   public email list for issues related to Web APIs.
   <a href="http://lists.w3.org/Archives/Public/public-webapi/">Archives</a> of
   the list are available.</p>
  <p>The patent policy for this document is the
   <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February
   2004 <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>. Patent disclosures relevant to this specification
   <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> be found on the
   <a href="http://www.w3.org/2004/01/pp-impl/38482/status" rel="disclosure">Web
   <abbr title="Application Programming Interface">API</abbr> Working Group's patent disclosure page</a>. An individual who has actual
   knowledge of a patent which the individual believes contains Essential
   Claim(s) with respect to this specification <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> disclose the information
   in accordance with
   <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
   6 of the <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.</p>
  
  <p>
    Publication as a Working Draft does not imply endorsement by the <acronym title="World Wide Web Consortium">W3C</acronym> Membership.
    This is a draft document and may be updated, replaced or obsoleted by other 
    documents at any time. It is inappropriate to cite this document as other than
    work in progress.
  </p>

 </div>
 <div class="section"><h2 id="toc">Table of contents</h2>
  
  <ul class="toc"><li><a href="#introduction">1. Introduction</a></li><li><ul class="toc"><li><a href="#examples">1.1. Examples of usage</a></li><li><a href="#security">1.2. Security considerations</a></li><li><a href="#definitions">1.3. Definitions</a></li><li><a href="#conformance">1.4. Conformance</a></li><li><a href="#extensibility">1.5. Extensibility</a></li><li><a href="#issues">1.6. Outstanding issues</a></li><li><a href="#notcovered">1.7. Not in this specification</a></li></ul></li><li><a href="#xmlhttprequest">2. The <code>XMLHttpRequest</code> object</a></li><li><a href="#events">3. Events</a></li></ul><ul class="toc"><li><a href="#bibref">A. References</a></li><li><a href="#acknowledgements">B. Acknowledgements</a></li></ul>
 </div>
 <div class="section"><h2 id="introduction">1. Introduction</h2>
  
  <p><em>This section is non-normative.</em></p>
  <p>The <code>XMLHttpRequest</code> object is an interface exposed by a
   scripting engine that allows scripts to perform <abbr title="HyperText Transfer Protocol">HTTP</abbr> client functionality,
   such as submitting form data or loading data from a server. Although the
   name of the object starts with "<abbr title="Extensible Markup Language">XML</abbr>", it supports the transport of other
   data formats in addition to
   <abbr title="Extensible Markup Language">XML</abbr>.  Also, some
   implementation support other protocols besides <abbr title="HyperText Transfer Protocol">HTTP</abbr> opposed to what "Http" in
   the name suggests (that functionality is not covered in this specification
   though).</p>
  <p>The <code>XMLHttpRequest</code> object is implemented today, in some form, by
   many popular Web browsers. Unfortunately the implementations are not
   completely interoperable. The goal of this specification is to document a
   minimum set of interoperable features based on existing implementations,
   allowing Web developers to use these features without platform-specific
   code. In order to do this, only features that are already implemented are
   considered. In the case where there is a feature with no interoperable
   implementations, the authors have specified what they believe to be the most
   correct behavior. It is expected that vendors update their implementation to
   match what the specification specifies.</p>
  <p>Future versions of this specification (as opposed to future drafts of this
   version) may add new features, after careful examination from browser
   developers and Web content developers.</p>
  <div class="section"><h3 id="examples">1.1. Examples of usage</h3>
   
   <p><em>This section is non-normative.</em></p>
   <p>Various examples are listed throughout the specification.</p>
   <div class="ednote">Blah...</div>
  </div>
  <div class="section"><h3 id="security">1.2. Security considerations</h3>
   
   <p><em>This section is non-normative.</em></p>
   <p>Implementations that run code originating from untrusted sources will
    probably want to place additional constraints on some of the features
    defined in this specification. This is not required and an implementation is
    free to ignore this section.</p>
   <p>The restrictions are there to stop untrusted users of the <abbr title="Application Programming Interface">API</abbr> from using
    the implementation to retrieve sensitive data. Specifically, an
    implementation in a web browser will often want to restrict pages from a
    website <var>A</var> to retrieve data from website <var>B</var>. The reason
    for this is that website <var>B</var> could reside inside a corporate
    firewall. If data could be retrieved from website <var>B</var> then website
    <var>A</var> could use the browser effectively circumvent the firewall.</p>
   <p>Another possible security attack exists if website <var>B</var> requires
    authentication, like for example a web bank. If website <var>A</var> were
    allowed to access data from website <var>B</var> and the user had recently
    visited the bank and at that time logged in, the page from website
    <var>A</var> would have access to private information like statements. If
    correctly crafted, a page from website <var>A</var> could even initiate
    transactions transferring money out of the browser-users bank account.</p>
   <p>To stop these attacks the implementation should only allow a page loaded
    from website <var>A</var> to access other pages on the same website. Two
    websites are considered separate if they use separate DNS names, even if
    these names refer to the same IP. This is because the two websites could be
    hosted at a hosting service that place several websites on a single server
    and then use the requested hostname to choose which website to serve.
    Additionally, separate TCP port numbers or separate protocols (like http vs.
    https) are considered as separate websites.</p>
   <p>The implemtation must be careful to always restrict access to the same
    website, not just during the initial <abbr title="HyperText Transfer Protocol">HTTP</abbr> request. For example if that
    request results in a redirect the implemenation should check that the
    redirect points to the same website and otherwise deny access.</p>
   <p>Another feature that an implementation could limit is the
    <code><a class="term" href="#dfn-setrequestheader">setRequestHeader</a></code> method. If the implementation
    allows the <code>Host</code> header to be set and two websites are hosted
    on the same server one website might be able to access sensitive information
    from the other website.</p>
   <p>...</p>
   <div class="ednote">Has to address restrictions on methods as well, etc.</div>
  </div>
  <div class="section"><h3 id="definitions">1.3. Definitions</h3>
   
   <p>The term <dfn id="dfn-entity-body">entity body</dfn> is used in this specification as defined
    by RFC 2616 ([<cite><a href="#RFC2616" class="bibref">RFC2616</a></cite>], section 7.2.1).</p>
   <p>The term <dfn id="dfn-reset">reset</dfn> either means that respective member <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be set
    to its initial value or each member of the object, depending on how it's
    used.</p>
   <p>The <dfn id="dfn-cached-base-uri">cached base URI</dfn> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be
    <code>window.document.baseURI</code> once an <code>XMLHttpRequest</code>
    object is initialized. Specifically, the <code>window</code> that the
    <code>XMLHttpRequest</code> constructor comes from, not the calling
    <code>window</code> [Window].</p>
  </div>
  <div class="section"><h3 id="conformance">1.4. Conformance</h3>
   
   <p>Everying in this specification is normative except for diagrams, examples,
    notes and sections marked non-normative.</p>
   <p>The key words <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">REQUIRED</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">SHALL</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">SHALL NOT</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em>,
    <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD NOT</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">RECOMMENDED</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em>, and <em class="rfc2119" title="Keyword in RFC 2119 context">OPTIONAL</em> in this document are to be
    interpreted as described in RFC 2119 [<cite><a href="#RFC2119" class="bibref">RFC2119</a></cite>].</p>
   <p>This specification defines some classes of products:</p>
   <dl>
    <dt>conforming implementation</dt>
    <dd>...</dd>
    <dt>...</dt>
    <dd>...</dd>
   </dl>
  </div>
  <div class="section"><h3 id="extensibility">1.5. Extensibility</h3>
   
   <p>Extensions to the <code>XMLHttpRequest</code> interface are reserved for
    future work by the Web APIs WG. WGs besides the Web APIs WG may extend the
    interface, but <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> coordinate that with the Web APIs WG. UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> extend the
    interface, but <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> prefix the new members using a string specific to the
    vendor following the <var>Vendor</var><var>Member</var>  scheme. (Normally
    members follow the <var>member</var> scheme.) Company Foo could introduce a
    <code>FooFollowRedirect(<var>boolean</var>)</code> method for example.</p>
   <p>Authors <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> use extension mechanisms specific to the host language, like
    <code>.prototype</code> in ECMAScript.</p>
   <div class="ednote">This should be in DOM Level 3 Core I suppose.</div>
  </div>
  <div class="section"><h3 id="issues">1.6. Outstanding issues</h3>
   
   <p><em>This section is non-normative.</em></p>
   <ul>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/31">ISSUE-31 - 
     invalid bytes and default character encoding</a></li>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/39">ISSUE-39 - 
     Errors in XHR requests</a></li>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/42">ISSUE-42 -
     missing text for arguments and return values</a></li>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/44">ISSUE-44 - XHR:
     Overloading in the <abbr title="Interface Definition Language">IDL</abbr></a></li>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/71">ISSUE-71 -
     setRequestHeader has too many header restrictions</a></li>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/73">ISSUE-73 - Are
     we going to support non-ECMAScript languages?</a></li>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/74">ISSUE-74 - what
     does it mean for XHR to support more methods?</a></li>
    <li><a href="http://www.w3.org/2006/webapi/track/issues/75">ISSUE-75 -
     Is method case-sensitive?</a></li>
   </ul>
  </div>
  <div class="section"><h3 id="notcovered">1.7. Not in this specification</h3>
   
   <p>This specification currently does not include the following features that
    may or may not be implemented by UAs. It is currently unclear whether some
    of these will be added for this version of the specification or the
    next.</p>
   <ul>
    <li><code>load</code> event and <code>onload</code> attribute;</li>
    <li><code>error</code> event and <code>onerror</code> attribute;</li>
    <li><code>progress</code> event and <code>onprogress</code> attribute;</li>
    <li><code>abort</code> event and <code>onabort</code> attribute;</li>
    <li><code>readystatechange</code> event;</li>
    <li>Objects that implement the <code>XMLHttpRequest</code> interface to also
    implement the <code>EventTarget</code> interface;</li>
    <li>Timers have been suggested, perhaps an <code>ontimeout</code>
     attribute;</li>
    <li>Property to disable following redirects.</li>
   </ul>
  </div>
 </div> 
 <div class="section"><h2 id="xmlhttprequest">2. The <code>XMLHttpRequest</code> object</h2>
  
  <p>The <code>XMLHttpRequest</code> interface may be used to allow scripts to
   programmatically connect to their originating server via <abbr title="HyperText Transfer Protocol">HTTP</abbr>.</p>
  <p>Objects implementing the <code>XMLHttpRequest</code> interface <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> also
   implement the <code>EventTarget</code> interface [<cite><a href="#DOM3EV" class="bibref">DOM3EV</a></cite>].</p>
  <p>In ECMAScript [ECMA262], an instance of <code>XMLHttpRequest</code> can be
   created using the <code>XMLHttpRequest()</code> constructor:</p>
  <div class="boxed"><div><span class="exampleTitle">Example: XMLHttpRequest constructor</span></div><pre class="example" title="XMLHttpRequest constructor">var r = new XMLHttpRequest();</pre></div>
  <div class="ednote">What about non-ECMAScript implementations?</div>
  <p>A more complete description of what can be done with
   <code>XMLHttpRequest</code> can be found in the
   <abbr title="Interface Definition Language">IDL</abbr> below and its
   associated details. Note that this <abbr title="Interface Definition Language">IDL</abbr> is non-normative. Only the language
   bindings are normative.</p>
  <div class="ednote">Need to define which <abbr title="Interface Definition Language">IDL</abbr> specification we are going to conform to, if
   any. Robin suggested drafting up a Note...</div>
  <div class="boxed"><p><span class="idlTitle">The XMLHttpRequest interface</span></p><pre class="schema" title="The XMLHttpRequest interface">interface <a href="#idl-webapi-XMLHttpRequest">XMLHttpRequest</a> {

           attribute EventListener   <a href="#dfn-onreadystatechange">onreadystatechange</a>;
  readonly attribute unsigned short  <a href="#dfn-readystate">readyState</a>;
  void               <a href="#dfn-open">open</a>(in DOMString method, in DOMString uri);
  void               <a href="#dfn-open">open</a>(in DOMString method, in DOMString uri, in boolean async);
  void               <a href="#dfn-open">open</a>(in DOMString method, in DOMString uri, in boolean async, in DOMString user);
  void               <a href="#dfn-open">open</a>(in DOMString method, in DOMString uri, in boolean async, in DOMString user, in DOMString password);
  void               <a href="#dfn-setrequestheader">setRequestHeader</a>(in DOMString header, in DOMString value)
                                        raises(DOMException);
  void               <a href="#dfn-send">send</a>(in DOMString data)
                                        raises(DOMException);
  void               <a href="#dfn-send">send</a>(in Document data)
                                        raises(DOMException);
  void               <a href="#dfn-abort">abort</a>();
  DOMString          <a href="#dfn-getallresponseheaders">getAllResponseHeaders</a>();
  DOMString          <a href="#dfn-getresponseheader">getResponseHeader</a>(in DOMString header);
           attribute DOMString       <a href="#dfn-responsetext">responseText</a>;
           attribute Document        <a href="#dfn-responsexml">responseXML</a>;
           attribute unsigned short  <a href="#dfn-status">status</a>;
                                        // raises(DOMException) on retrieval
           attribute DOMString       <a href="#dfn-statustext">statusText</a>;
                                        // raises(DOMException) on retrieval
};</pre></div><div class="section"><div class="section"><h4 class="idl-header">Attributes</h4><dl class="idl-attr"><dt id="dfn-onreadystatechange"><code>onreadystatechange</code>
      of type
      EventListener</dt><dd><p>An attribute that takes an <code>EventListener</code> as value that
       <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be invoked when <code><a class="term" href="#dfn-readystatechange">readystatechange</a></code> is
       dispatched on the object implementing the <code>XMLHttpRequest</code>
       interface. Its initial value <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be <code>null</code>.</p></dd><dt id="dfn-readystate"><code>readyState</code>
      of type
      unsigned short, readonly</dt><dd><p>The state of the object. The attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be one of the following
       values:</p><dl>
       <dt>0 Uninitialized</dt>
       <dd>The initial value.</dd>
       <dt>1 Open</dt>
       <dd>The <code><a class="term" href="#dfn-open">open()</a></code> method has been successfully
        called.</dd>
       <dt>2 Sent</dt>
       <dd>The UA successfully completed the request, but no data has yet been
        received.</dd>
       <dt>3 Receiving</dt>
       <dd>Immediately before receiving the message body (if any). All <abbr title="HyperText Transfer Protocol">HTTP</abbr>
        headers have been received.</dd>
       <dt>4 Loaded</dt>
       <dd>The data transfer has been completed.</dd>
      </dl></dd><dt id="dfn-responsetext"><code>responseText</code>
      of type
      DOMString</dt><dd><p>If the <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute has a value other
       than 3 (Receiving) or 4 (Loaded), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the empty string. Otherwise,
       it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the fragment of the entity body received so far (when
       <code><a class="term" href="#dfn-readystate">readyState</a></code> is 3 (Receiving)) or the entity body
       (when <code><a class="term" href="#dfn-readystate">readyState</a></code> is 4 (Loaded)), interpreted
       as a stream of characters.</p><p>If the response includes a <code>Content-Type</code> understood by the
       UA, with the exception that the rule in the final paragraph of section
       3.7.1 of [<cite><a href="#RFC2616" class="bibref">RFC2616</a></cite>], and the rules in section 4.1.2 of [RFC2046] <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be
       treated as if they specified the default character encoding as being
       UTF-8. Invalid bytes <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be converted to U+FFFD REPLACEMENT CHARACTER.
       If the UA can't derive a character stream in accord with the media type
       specification, <code>reponseText</code> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be <code>null</code>.</p></dd><dt id="dfn-responsexml"><code>responseXML</code>
      of type
      Document</dt><dd><p>If the <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute has a value other
       than 4 (Loaded), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be <code>null</code>. Otherwise, if the
       <code>Content-Type</code> header contains a media type (ignoring any
       parameters) that is either <code>text/xml</code>,
       <code>application/xml</code>, or ends in <code>+xml</code>, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be an
       object that implements the <code>Document</code> interface representing
       the parsed document. If <code>Content-Type</code> did not contain such a
       media type, or if the document could not be parsed (due to an <abbr title="Extensible Markup Language">XML</abbr>
       well-formedness error or unsupported character encoding, for instance),
       it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be <code>null</code>.</p><div class="ednote">Because of nonsense like
       <code>r.responseXML.getElementsByTagName()</code> this might have to
       return an empty document node instead. It seems to be what
       implementations do in a lot of cases anyway...</div></dd><dt id="dfn-status"><code>status</code>
      of type
      unsigned short</dt><dd><p>If the <code>status</code> attribute is not available it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> raise an
       exception. It <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be available when <code><a class="term" href="#dfn-readystate">readyState</a></code>
       is 3 (Receiving) or 4 (Loaded). When available, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> represent the
       <abbr title="HyperText Transfer Protocol">HTTP</abbr> status code (typically 200 for a successful connection).</p><dl><dt>Exceptions on retrieval</dt><dd><table class="idl-exceptions"><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
       <tr><td>INVALID_STATE_ERR</td><td><em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised when this
       attribute is accessed when <code><a class="term" href="#dfn-readystate">readyState</a></code> has an
       inappropriate value.</td></tr>
      </table></td></tr></table></dd></dl></dd><dt id="dfn-statustext"><code>statusText</code>
      of type
      DOMString</dt><dd><p>If the <code>statusText</code> attribute is not available it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> raise
       an exception. It <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be available when <code>readyState</code> is 3
       (Receiving) or 4 (Loaded). When available, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> represent the <abbr title="HyperText Transfer Protocol">HTTP</abbr>
       status text sent by the server (appears after the status code).</p><dl><dt>Exceptions on retrieval</dt><dd><table class="idl-exceptions"><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
       <tr><td>INVALID_STATE_ERR</td><td><em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised if this
        attribute is accessed when <code><a class="term" href="#dfn-readystate">readyState</a></code> has an
        inappropriate value.</td></tr>
      </table></td></tr></table></dd></dl></dd></dl></div><div class="section"><h4 class="idl-header">Methods</h4><dl class="idl-meth"><dt id="dfn-abort"><code>abort</code></dt><dd><p>When invoked, this method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> cancel any network activity for which
       the object is responsible and <a class="term" href="#dfn-reset">reset</a> the object.</p><dl><dt>No Parameters</dt><dt>No Return Value</dt><dt>No Exceptions</dt></dl></dd><dt id="dfn-getallresponseheaders"><code>getAllResponseHeaders</code></dt><dd><p>If the <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute has a value other
       than 3 (Receiving) or 4 (Loaded), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> return <code>null</code>.
       Otherwise, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> return all the <abbr title="HyperText Transfer Protocol">HTTP</abbr> headers, as a single string, with
       each header line separated by a CR (U+000D) LF (U+000A) pair. The status
       line <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> not be included.</p><div class="boxed"><div><span class="exampleTitle">Example: Manipulating response headers</span></div><pre class="example" title="Manipulating response headers">// The following script:
var r = new XMLHttpRequest();
r.open('GET', 'test.txt', false);
r.send();
print(r.getAllResponseHeaders());

// ...should output something similar to the following text:
Date: Sun, 24 Oct 2004 04:58:38 GMT
Server: Apache/1.3.31 (Unix)
Keep-Alive: timeout=15, max=99
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/plain; charset=utf-8</pre></div><dl><dt>No Parameters</dt><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>A single string consisting of all <abbr title="HyperText Transfer Protocol">HTTP</abbr> headers.
       See prose for details.</td></tr></table></dl></dd><dt>No Exceptions</dt></dl></dd><dt id="dfn-getresponseheader"><code>getResponseHeader</code></dt><dd><p>If the <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute has a value other
       than 3 (Receiving) or 4 (Loaded), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> return the empty string.
       Otherwise, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> represent the value of the given <abbr title="HyperText Transfer Protocol">HTTP</abbr> header in the
       data received so far for the last request sent, as a single string. If
       more than one header of the given name was received, then the values <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>
       be concatenated, separated from each other by an U+002C COMMA followed by
       an U+0020 SPACE. If no headers of that name were received, then it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>
       return the empty string. Header names <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be compared case-insensitively
       to the method argument (<var>header</var>).</p><div class="ednote">Case-insensitively how?</div><div class="ednote">Needs to be revised largely based on Mark's comments.</div><div class="boxed"><div><span class="exampleTitle">Example: Getting a response header</span></div><pre class="example" title="Getting a response header">// The following script:
var r = new XMLHttpRequest();
r.open('GET', 'test.txt', false);
r.send();
print(r.getResponseHeader('Content-Type'));

// ...should output something similar to the following text:
Content-Type: text/plain; charset=utf-8</pre></div><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>header</code>
          of type
          DOMString</dt><dd>Name of the <abbr title="HyperText Transfer Protocol">HTTP</abbr> header.</dd></dl></dd><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>Value of the given <abbr title="HyperText Transfer Protocol">HTTP</abbr> header.</td></tr></table></dl></dd><dt>No Exceptions</dt></dl></dd><dt id="dfn-open"><code>open</code></dt><dd><p>Calling this method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> initialize the object by remembering the
       <var>method</var>, <var>uri</var>, <var>async</var> (defaulting to
       <code>true</code> if omitted), <var>user</var> (defaulting to
       <code>null</code> if omitted), and <var>password</var> (defaulting to
       <code>null</code> if omitted) arguments, setting the
       <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute to 1 (Open), resetting the
       <code><a class="term" href="#dfn-responsetext">responseText</a></code>,
       <code><a class="term" href="#dfn-responsexml">responseXML</a></code>, <code><a class="term" href="#dfn-status">status</a></code>,
       and <code><a class="term" href="#dfn-statustext">statusText</a></code> attributes to their initial
       values, and resetting the list of request headers.</p><p>Same-origin security restrictions <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> apply.</p><p>If the URI given to this method contains userinfo ([RFC3986], section
       3.2.1) then the user name and password specified <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be used if the
       <var>user</var> and <var>password</var> arguments are omitted. If the
       arguments are not omitted, they take precedence, even if they are
       <code>null</code>. The usage of userinfo is discouraged <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> not work in
       implementations.</p><p>If <code>open()</code> is called when <code>readyState</code> is 4
       (Loaded) the entire object <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be reset.</p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>method</code>
          of type
          DOMString</dt><dd>A valid <abbr title="HyperText Transfer Protocol">HTTP</abbr> method name. The <code>GET</code>,
       <code>POST</code>, <code>PUT</code>, <code>DELETE</code> and
       <code>HEAD</code> values <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be supported [<cite><a href="#RFC2616" class="bibref">RFC2616</a></cite>].</dd><dt><code>uri</code>
          of type
          DOMString</dt><dd>A URI, which <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be resolved to an absolute URI using
       the <a class="term" href="#dfn-cached-base-uri">cached base URI</a>.</dd><dt><code>async</code>
          of type
          boolean, optional</dt><dd>Whether or not script
       execution can continue.</dd><dt><code>user</code>
          of type
          DOMString, optional</dt><dd>Username.</dd><dt><code>password</code>
          of type
          DOMString, optional</dt><dd>Password.</dd></dl></dd><dt>No Return Value</dt><dt>No Exceptions</dt></dl></dd><dt id="dfn-send"><code>send</code></dt><dd><p>If the <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute has a value other
       than 1 (Open), an exception <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised. Otherwise, the
       <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be set to 2 (Sent)
       and a request to <var>uri</var> using method <var>method</var>,
       authenticating using <var>user</var> and <var>password</var> as
       appropriate is sent. If the <var>async</var> flag is set to false, then
       the method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> not return until the request has completed. Otherwise, it
       <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> return immediately. (See: <code><a class="term" href="#dfn-open">open()</a></code>.)</p><p>If the <var>method</var> is <code>POST</code> or <code>PUT</code>,
       then the <var>data</var> passed to the <code>send()</code> method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be
       used for the entity body. If <var>data</var> is a string, the data <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>
       be encoded as UTF-8 for transmission. If the <var>data</var> is a
       <code>Document</code>, then the document <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be serialized using the
       encoding given by <code><var>data</var>.xmlEncoding</code>, if specified,
       or UTF-8 otherwise [<cite><a href="#DOM3" class="bibref">DOM3</a></cite>]. If <var>data</var> is not a
       <code>Document</code> or a <code>DOMString</code> the host language <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>
       use the stringification mechanisms on the argument that was passed.</p><p>Invoking <code>send</code> without the <var>data</var> argument <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>
       give the same result as if it was invoked with <code>null</code> as
       argument. Authors <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> specify the <code>Content-Type</code> header via
       <code><a class="term" href="#dfn-setrequestheader">setRequestHeader</a></code> before invoking
       <code>send</code> with an argument.</p><p>If the response is an <abbr title="HyperText Transfer Protocol">HTTP</abbr> redirect (status code 301, 302, 303 or 307),
       then it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be transparently followed (unless it violates security or
       infinite loop precautions). Note that <abbr title="HyperText Transfer Protocol">HTTP</abbr> [<cite><a href="#RFC2616" class="bibref">RFC2616</a></cite>] places requirements
       on UAs regarding the preservation of the request method during redirects,
       and also requires users to be notified of certain kinds of automatic
       redirections. Any other error (including a 401) <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> cause the object to
       use that error page as the response.</p><p>If the author performed a conditional GET request (setting the relevant
       headers using <code><a class="term" href="#dfn-setrequestheader">setRequestHeader()</a></code>) and the
       resulting response is a 304 the UA <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> return a 304 and it is expected
       the page author can deal with that. Otherwise, if the UA performed a
       conditional GET request and the response is a 304 the UA <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> return a
       200 (using the relevant cached file).</p><div class="ednote">What about DNS errors?</div><p>Immediately before receiving the message body (if any), the
       <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be set to to 3
       (Receiving). When the request has completed loading, the
       <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be set to 4 (Loaded).
       In case of a HEAD request <code><a class="term" href="#dfn-readystate">readyState</a></code> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be
       set to 4 (Loaded) immediatly after having gone to 3 (Receiving).</p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>data</code>
          of varying types (see IDL)
        </dt><dd>Data to send.</dd></dl></dd><dt>No Return Value</dt><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
       <tr><td>INVALID_STATE_ERR</td><td><em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised if this
       method is called when <code><a class="term" href="#dfn-readystate">readyState</a></code> has an
       inappropriate value.</td></tr>
      </table></td></tr></table></dd></dl></dd><dt id="dfn-setrequestheader"><code>setRequestHeader</code></dt><dd><p>If the <code><a class="term" href="#dfn-readystate">readyState</a></code> attribute has a value other
       than 1 (Open), an exception <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised. If the <var>header</var> or
       <var>value</var> arguments contain any U+000A LINE FEED or U+000D
       CARRIAGE RETURN characters, or if the <var>header</var> argument contains
       any U+0020 SPACE or U+003A COLON characters, nothing <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be done.
       Otherwise, the nominated request header (<var>header</var>) field value
       <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be set to <var>value</var>. If the nominated request header field
       already has a value, the new value <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be combined with the existing
       value ([<cite><a href="#RFC2616" class="bibref">RFC2616</a></cite>], section 4.2). Implementations <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> replace an existing
       value (instead of combining it with the new value) if the nominated
       request header field value is not specified as a comma-separated
       list.</p><div class="boxed"><div><span class="exampleTitle">Example: Setting a request header</span></div><pre class="example" title="Setting a request header">// The following script:
var r = new XMLHttpRequest();
r.open('GET', 'demo.cgi');
r.setRequestHeader('X-Test', 'one');
r.setRequestHeader('X-Test', 'two');
r.send(null);

// ...would result in the following header being sent:
...
X-Test: one, two
...</pre></div><p>The list of request headers <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be reset when the
       <code><a class="term" href="#dfn-open">open()</a></code> method is called.</p><p>User agents <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD NOT</em> set any headers other than the headers set by
       the author using this method, with the following exceptions:</p><ul>
       <li>UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> set the <code>Host</code> header appropriately (see
        <code><a class="term" href="#dfn-open">open()</a></code>) and not allow it to be
        overridden.</li>
       <li>UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> set the Authorization header, based upon the operation of
        <abbr title="HyperText Transfer Protocol">HTTP</abbr> Authentication [RFC2617]. If a challenge from the server is
        encountered, credentials <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be generated based upon the values of
        the username and password specified by open(). UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> set the
        Authorization header solely because open() contains a username/password;
        it should only be set as part of the protocol described by <abbr title="HyperText Transfer Protocol">HTTP</abbr>
        Authentication [RFC2617]. <div class="ednote">This needs rewording...</div></li>
       
       <li>UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> set the <code>Accept-Charset</code>,
        <code>Accept-Encoding</code> and <code>TE</code> headers and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em>
        allow them to be overridden.</li>
       <li>UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> set the <code>Connection</code> and <code>Keep-Alive</code>
        headers as described by the <abbr title="HyperText Transfer Protocol">HTTP</abbr> specification, and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> allow those
        headers to be overridden.</li>
       <li>UAs <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> set the proxy-related headers according to proxy settings
        of the environment, and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> allow those headers to be overridden.
        <div class="ednote">Perhaps this should be more explicit. Only <code>Via</code>
        comes to mind though...</div></li>
       <li>UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> give the <code>User-Agent</code> header an initial value, but
        <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> allow authors to append values to it.</li>
       <li>UAs <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> set <code>Cookie</code> and <code>Cookie2</code> headers
        appropriately for the given URI and given the user's current cookies,
        and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> allow authors to append values to these headers.</li>
      </ul><p>In particular, UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> automatically set the
       <code>Cache-Control</code> or <code>Pragma</code> headers to defeat
       caching [<cite><a href="#RFC2616" class="bibref">RFC2616</a></cite>].</p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>header</code>
          of type
          DOMString</dt><dd>Name of the <abbr title="HyperText Transfer Protocol">HTTP</abbr> header.</dd><dt><code>value</code>
          of type
          DOMString</dt><dd>Value of the <abbr title="HyperText Transfer Protocol">HTTP</abbr> header.</dd></dl></dd><dt>No Return Value</dt><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
       <tr><td>INVALID_STATE_ERR</td><td><em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised if
        <code><a class="term" href="#dfn-readystate">readyState</a></code> has an inappropriate value. (See
        prose above.)</td></tr>
      </table></td></tr></table></dd></dl></dd></dl></div></div>
  <p><abbr title="HyperText Transfer Protocol">HTTP</abbr> requests sent from multiple different <code>XMLHttpRequest</code>
   objects in succession <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be pipelined into shared <abbr title="HyperText Transfer Protocol">HTTP</abbr> connections.</p>
 </div>
 <div class="section"><h2 id="events">3. Events</h2>
  
  <p>These sections describe the various events that can be dispatched on the
   object implementing the <code>XMLHttpRequest</code> interface. For this
   version of the specification only one event is defined.</p>
  <dl>
   <dt><dfn id="dfn-readystatechange"><code>readystatechange</code></dfn></dt>
   <dd>The <code>readystatechange</code> event <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be dispatched when
    <code><a class="term" href="#dfn-readystate">readyState</a></code> changes value. It <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> bubble, <em class="rfc2119" title="Keyword in RFC 2119 context">MUST
    NOT</em> be cancelable and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> implement the <code>Event</code> interface
    [<cite><a href="#DOM3EV" class="bibref">DOM3EV</a></cite>].</dd>
  </dl>
 </div>
 <div class="section"><h2 id="bibref">A. References</h2>
  
   <dl class="bibliography"><dt id="DOM3">DOM3</dt><dd><cite><a href="http://www.w3.org/TR/DOM-Level-3-Core/">Document Object Model (DOM) Level 3 Core Specification</a></cite>,
    <span class="person">Arnaud Le Hors (IBM)</span>, <span class="person">Philippe Le Hégaret (W3C)</span>, <span class="person">Lauren Wood (SoftQuad, Inc.)</span>, <span class="person">Gavin Nicol (Inso EPS)</span>, <span class="person">Jonathan Robie (Texcel Research and Software AG)</span>, <span class="person">Mike Champion (Arbortext and Software AG)</span>, and <span class="person">Steve Byrne (JavaSoft)</span>.</dd><dt id="DOM3EV">DOM3EV</dt><dd><cite><a href="http://www.w3.org/TR/DOM-Level-3-Events/">Document Object Model (DOM) Level 3 Events Specification</a></cite>,
    <span class="person">Philippe Le Hégaret (W3C)</span>, and <span class="person">Tom Pixley (Netscape Communications Corporation)</span>.</dd><dt id="RFC2119">RFC2119</dt><dd><cite><a href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a></cite>,
    <span class="person">S. Bradner</span>.</dd><dt id="RFC2616">RFC2616</dt><dd><cite><a href="http://www.ietf.org/rfc/rfc2616.txt">Hypertext Transfer Protocol -- HTTP/1.1</a></cite>,
    <span class="person">R. Fielding (UC Irvine)</span>, <span class="person">J. Gettys (Compaq/W3C)</span>, <span class="person">J. Mogul (Compaq)</span>, <span class="person">H. Frystyk (W3C/MIT)</span>, <span class="person">L. Masinter (Xerox)</span>, <span class="person">P. Leach (Microsoft)</span>, and <span class="person">T. Berners-Lee (W3C/MIT)</span>.</dd></dl>
 </div>
 <div class="section"><h2 id="acknowledgements">B. Acknowledgements</h2>
  
  <p><em>This section is non-normative</em></p>
  <ul>
   <li>Asbjørn Ulsberg</li>
   <li>Boris Zbarsky</li>
   <li>Björn Höhrmann</li>
   <li>Cameron McCormack</li>
   <li>Christophe Jolif</li>
   <li>Charles McCathieNevile</li>
   <li>Doug Schepers</li>
   <li>Douglas Livingstone</li>
   <li>Gorm Haug Eriksen</li>
   <li>Hallvord R. M. Steen</li>
   <li>Håkon Wium Lie</li>
   <li>Ian Davis</li>
   <li>Ian Hickson</li>
   <li>Ivan Herman</li>
   <li>Jens Lindström</li>
   <li>Jim Deegan</li>
   <li>Jim Ley</li>
   <li>Jonas Sicking</li>
   <li>Julian Reschke</li>
   <li>Karl Dubost</li>
   <li>Maciej Stachowiak</li>
   <li>Marc Hadley</li>
   <li>Mark Nottingham</li>
   <li>Pawel Glowacki</li>
   <li>Robin Berjon</li>
  </ul>
  <p>Special thanks also to the Microsoft employees who first implemented the
   <code>XMLHttpRequest</code> interface, which was first widely deployed by
   the Windows Internet Explorer browser.</p>
  <p>Special thanks also to the WHATWG for drafing a first version of this
   specification in their Web Applications 1.0 document.</p>
  <p>Thanks also to all those who have helped to improve this specification by
   sending suggestions and corrections. (Please, keep bugging us with your
   issues!)</p>
  <p>(By the way, if you contributed to this specification in any way and you
   are not listed in this appendix please e-mail either editor directly.)</p>
 </div>
</body></html>
