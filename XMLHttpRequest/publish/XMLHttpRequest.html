<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
          ******* WARNING ********
          This document was automatically generated using the Re-Spec specification
          publishing system. Edits made here are likely to be lost when it is
          regenerated.
          ******* WARNING ********
        --><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>The XMLHttpRequest Object</title><link rel="stylesheet" href="respec-w3c.css" type="text/css"></link><link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/base" type="text/css"></link><meta name="revision" content="$Id: XMLHttpRequest.html,v 1.4 2006-03-17 11:13:37 avankest Exp $"></meta></head><body><div class="head"><p><a href="http://www.w3.org/"><img class="head" src="http://www.w3.org/Icons/w3c_home" width="72" height="48" alt="W3C"></img></a></p><h1 class="head">The XMLHttpRequest Object</h1><h2 id="pagesubtitle">W3C Editor's Draft <em>17 March 2006</em></h2><dl><dt>This version:</dt><dd><a href=""></a></dd><dt>Latest version:</dt><dd><a href="
        
      ">
        
      </a></dd><dt>Previous version:</dt><dd><a href=""></a></dd><dt>Editors:</dt><dd><span class="person"><a href="http://annevankesteren.nl/">Anne van Kesteren</a> (<a href="http://www.opera.com/">Opera Software ASA</a>) &lt;<a href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;</span></dd><dd><span class="person"><a href="http://www.w3.org/People/Dean/">Dean Jackson</a> (<a href="http://www.w3.org/">W3C</a>) &lt;<a href="mailto:dino@w3.org">dino@w3.org</a>&gt;</span></dd></dl><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©2006
        <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>,
        <a href="http://www.ercim.org/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and 
        <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document  use</a> rules apply.
      </p></div><hr></hr>

  

  

  <h2 id="specabstract">Abstract</h2><div class="section">
    
    <p>
      This specification defines the <code>XMLHttpRequest</code> object...
    </p>
    <div class="ednote">
      <p>
        Dino has to fill this in.
      </p>
      <p>
        Last update: $Id: XMLHttpRequest.html,v 1.4 2006-03-17 11:13:37 avankest Exp $.
      </p>
    </div>
  </div>

  <div class="section"><h2 id="sotd">Status of this Document</h2>
    

    
  <p>
    <em>This section describes the status of this document at the time of its publication.
    Other documents may supersede this document. A list of current <acronym title="World Wide Web Consortium">W3C</acronym> publications and the
    latest revision of this technical report can be found in the 
    <a href="http://www.w3.org/TR/"><acronym title="World Wide Web Consortium">W3C</acronym>
    technical reports index</a> at http://www.w3.org/TR/.</em>
  </p>

    <p>
      This document is produced by the <a href="http://www.w3.org/2006/webapi">Web API
      <acronym title="Working Group">WG</acronym></a> (part of the
      <a href="http://www.w3.org/2006/rwc/Activity">Rich Web Clients Activity</a>).
      This document has no formal standing within the <acronym title="World Wide Web Consortium">W3C</acronym>.
      Please send comments to <a href="mailto:public-webapi@w3.org">public-webapi@w3.org</a>,
      the public email list for issues related to Web APIs.
    </p>
    <p>
      The patent policy for this document is the
      <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.
      Patent disclosures relevant to this specification <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> be found on the
      <a href="http://www.w3.org/2004/01/pp-impl/38482/status" rel="disclosure">Web API Working Group's patent
      disclosure page</a>. An individual who has actual knowledge of a patent which the individual believes
      contains Essential Claim(s) with respect to this specification <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> disclose the information in
      accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6
      of the <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.
    </p>
    
  <p>
    Publication as a Working Draft does not imply endorsement by the <acronym title="World Wide Web Consortium">W3C</acronym> Membership.
    This is a draft document and may be updated, replaced or obsoleted by other 
    documents at any time. It is inappropriate to cite this document as other than
    work in progress.
  </p>

  </div>

  <div class="section"><h2 id="contents">Table of contents</h2>
    

    <ul class="toc"><li><a href="#conformance">1. Conformance</a></li><li><a href="#xmlhttprequest">2. The <code>XMLHttpRequest</code> object</a></li></ul><ul class="toc"><li><a href="#bibref">A. References</a></li></ul>
  </div>

  <div class="section"><h2 id="conformance">1. Conformance</h2>
    

    <p>
      The key words <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">REQUIRED</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">SHALL</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">SHALL NOT</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD NOT</em>,
      <em class="rfc2119" title="Keyword in RFC 2119 context">RECOMMENDED</em>, <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em>, and <em class="rfc2119" title="Keyword in RFC 2119 context">OPTIONAL</em> in this document are to be interpreted as described in
      RFC 2119 [<cite><a href="#RFC2119" class="bibref">RFC2119</a></cite>].
    </p>
  </div>

  <div class="section"><h2 id="xmlhttprequest">2. The <code>XMLHttpRequest</code> object</h2>
    
    <p>
      To allow scripts to programmatically connect back to their originating
      server via HTTP, the following interface <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> be used.
    </p>
    
    <p>
      In ECMAScript, an instance of <code>XMLHttpRequest</code> can be
      created using the <code>XMLHttpRequest()</code> constructor:
    </p>
    <div class="boxed"><div><span class="exampleTitle">Example: XMLHttpRequest constructor</span></div><pre class="example" title="XMLHttpRequest constructor">var r = new XMLHttpRequest();</pre></div>
    <p>
      A more complete description of what can be done with <code>XMLHttpRequest</code>
      can be found in the IDL below and its associated details.
    </p>

    <div class="boxed"><p><span class="idlTitle">The XMLHttpRequest interface</span></p><pre class="schema" title="The XMLHttpRequest interface">interface <a href="#idl-webapi-XMLHttpRequest">XMLHttpRequest</a> {

           attribute Function        <a href="#idl-attr-XMLHttpRequest-onreadystatechange">onreadystatechange</a>;
  readonly attribute unsigned short  <a href="#idl-attr-XMLHttpRequest-readyState">readyState</a>;
  void               <a href="#idl-meth-XMLHttpRequest-open">open</a>(in DOMString method, in DOMString uri);
  void               <a href="#idl-meth-XMLHttpRequest-open">open</a>(in DOMString method, in DOMString uri, in boolean async);
  void               <a href="#idl-meth-XMLHttpRequest-open">open</a>(in DOMString method, in DOMString uri, in boolean async, in DOMString user);
  void               <a href="#idl-meth-XMLHttpRequest-open">open</a>(in DOMString method, in DOMString uri, in boolean async, in DOMString user, in DOMString password);
  void               <a href="#idl-meth-XMLHttpRequest-setRequestHeader">setRequestHeader</a>(in DOMString header, in DOMString value)
                                        raises(DOMException);
  void               <a href="#idl-meth-XMLHttpRequest-send">send</a>(in DOMString data)
                                        raises(DOMException);
  void               <a href="#idl-meth-XMLHttpRequest-send">send</a>(in Document data)
                                        raises(DOMException);
  void               <a href="#idl-meth-XMLHttpRequest-abort">abort</a>();
  DOMString          <a href="#idl-meth-XMLHttpRequest-getAllResponseHeaders">getAllResponseHeaders</a>()
                                        raises(DOMException);
  DOMString          <a href="#idl-meth-XMLHttpRequest-getResponseHeader">getResponseHeader</a>(in DOMString header)
                                        raises(DOMException);
           attribute DOMString       <a href="#idl-attr-XMLHttpRequest-responseText">responseText</a>;
                                        // raises(DOMException) on retrieval
           attribute Document        <a href="#idl-attr-XMLHttpRequest-responseXML">responseXML</a>;
                                        // raises(DOMException) on retrieval
           attribute unsigned short  <a href="#idl-attr-XMLHttpRequest-status">status</a>;
                                        // raises(DOMException) on retrieval
           attribute DOMString       <a href="#idl-attr-XMLHttpRequest-statusText">statusText</a>;
                                        // raises(DOMException) on retrieval
};</pre></div><div class="section"><div class="section"><h4 class="idl-header">Attributes</h4><dl class="idl-attr"><dt id="idl-attr-XMLHttpRequest-onreadystatechange"><code>onreadystatechange</code>
      of type
      Function</dt><dd><p>
              An attribute that represents a function that <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be invoked when
              <code>readyState</code> changes value. The function <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> be called
              multiple times when readyState is 3 (<code>RECEIVING_STATE</code>).
            </p></dd><dt id="idl-attr-XMLHttpRequest-readyState"><code>readyState</code>
      of type
      unsigned short, readonly</dt><dd><p>
              The state of the object.
            </p><p>
              This set of constants is used to describe the current state of the
              object.
            </p><dl>
              <dt>0</dt>
              <dd>
                The initial value.
              </dd>
              <dt>1</dt>
              <dd>
                The <code>open()</code> method has been successfully called.
              </dd>
              <dt>2</dt>
              <dd>
                The <code>send()</code> method has been successfully called,
                but no data has yet been received.
              </dd>
              <dt>3</dt>
              <dd>
                Data is being received, but the data transfer is not yet
                complete.
              </dd>
              <dt>4</dt>
              <dd>
                The data transfer has been completed.
              </dd>
            </dl></dd><dt id="idl-attr-XMLHttpRequest-responseText"><code>responseText</code>
      of type
      DOMString</dt><dd><p>
              If the <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code> attribute has
              a value other than
              3 (<code>REPLACEMENT</code>) or 4 <code>LOADED_STATE</code>), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the empty string.
              Otherwise, returns
              the body of the data received so far, interpreted using the character
              encoding specified in the response, or UTF-8 if no character encoding was
              specified. Invalid bytes <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be converted to U+FFFD REPLACEMENT
              CHARACTER.
            </p><dl><dt>Exceptions on retrieval</dt><dd><table class="idl-exceptions"><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>INVALID_STATE_ERR</td><td>
                <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be raised if this attribute is accessed when
                <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
                has an inappropriate value.
              </td></tr>
            </table></td></tr></table></dd></dl></dd><dt id="idl-attr-XMLHttpRequest-responseXML"><code>responseXML</code>
      of type
      Document</dt><dd><p>
              If the <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
              attribute has a value other than
              4 (<code>LOADED_STATE</code>), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be <code>null</code>.
              Otherwise, if the <code>Content-Type</code>
              header is either <code>text/xml</code>, <code>application/xml</code>, or
              ends in <code>+xml</code>, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be an object that implements the Document
              interface representing the parsed document. If the document was not an
              XML document, or if the document could not be parsed (due to an XML
              well-formedness error or unsupported character encoding, for instance),
              it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be null.
            </p><dl><dt>Exceptions on retrieval</dt><dd><table class="idl-exceptions"><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>INVALID_STATE_ERR</td><td>
                <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be raised if this attribute is accessed when
                <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
                has an inappropriate value.
              </td></tr>
            </table></td></tr></table></dd></dl></dd><dt id="idl-attr-XMLHttpRequest-status"><code>status</code>
      of type
      unsigned short</dt><dd><p>
              If the <code>status</code> attribute is not available it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> raise an
              exception. It <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be available when <code>readyState</code> is
              3 (<code>REPLACEMENT</code>) or 4 <code>LOADED_STATE</code>).
              When available, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> represent the HTTP status
              code (typically 200 for a successful connection).
            </p><dl><dt>Exceptions on retrieval</dt><dd><table class="idl-exceptions"><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>INVALID_STATE_ERR</td><td>
                <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be raised if this attribute is accessed when
                <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
                has an inappropriate value.
              </td></tr>
            </table></td></tr></table></dd></dl></dd><dt id="idl-attr-XMLHttpRequest-statusText"><code>statusText</code>
      of type
      DOMString</dt><dd><p>
              If the <code>statusText</code> attribute is not available it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> raise an
              exception. It <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be available when <code>readyState</code> is
              3 (<code>REPLACEMENT</code>) or 4 <code>LOADED_STATE</code>).
              When available, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> represent the HTTP status text
              sent by the server (appears after the status code).
            </p><dl><dt>Exceptions on retrieval</dt><dd><table class="idl-exceptions"><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>INVALID_STATE_ERR</td><td>
                <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be raised if this attribute is accessed when
                <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
                has an inappropriate value.
              </td></tr>
            </table></td></tr></table></dd></dl></dd></dl></div><div class="section"><h4 class="idl-header">Methods</h4><dl class="idl-meth"><dt id="idl-meth-XMLHttpRequest-abort"><code>abort</code></dt><dd><p>
              Calling this method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> cancel any network activity for which the object is
              responsible. In addition, UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> then set
              <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
              to 4 (<code>LOADED_STATE</code>), call the function defined in <code>onreadystatechange</code>
              and reset the object.
            </p><dl><dt>No Parameters</dt><dt>No Return Value</dt><dt>No Exceptions</dt></dl></dd><dt id="idl-meth-XMLHttpRequest-getAllResponseHeaders"><code>getAllResponseHeaders</code></dt><dd><p>
              If the <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
              attribute has a value other than
              3 (<code>RECEIVING_STATE</code>) or 4 (<code>LOADED_STATE</code>), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be null.
              Otherwise, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> represent all the HTTP
              headers, as a single string, with each header line separated by a
              CR (U+000D) LF (U+000A) pair. The status line <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> not be included.
            </p><div class="boxed"><div><span class="exampleTitle">Example: Manipulating response headers</span></div><pre class="example" title="Manipulating response headers">// The following script:
var r = new XMLHttpRequest();
r.open('get', 'test.txt', false);
r.send();
alert(r.getAllResponseHeaders());

// ...should display a dialog with text similar to the following:
Date: Sun, 24 Oct 2004 04:58:38 GMT
Server: Apache/1.3.31 (Unix)
Keep-Alive: timeout=15, max=99
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/plain; charset=utf-8</pre></div><dl><dt>No Parameters</dt><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>
              @XXX TBD@
            </td></tr></table></dl></dd><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>INVALID_STATE_ERR</td><td>
                <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be raised if this method is called when
                <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
                has an inappropriate value.
              </td></tr>
            </table></td></tr></table></dd></dl></dd><dt id="idl-meth-XMLHttpRequest-getResponseHeader"><code>getResponseHeader</code></dt><dd><p>
              If the <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
              attribute has a value other than
              3 (<code>RECEIVING_STATE</code>) or 4 (<code>LOADED_STATE</code>), it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the empty string.
              Otherwise, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> represent
              the value of the given HTTP header in the data received so far for the
              last request sent, as a single string. If more than one header of the
              given name was received, then the values <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be concatenated,
              separated from each other by an U+002C COMMA followed by an U+0020 SPACE. If no headers of that
              name were received, then it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the empty string. Header names <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be
              compared <span>case-insensitively</span> to the method
              argument (<var>header</var>).
            </p><div class="boxed"><div><span class="exampleTitle">Example: Manipulating response headers</span></div><pre class="example" title="Manipulating response headers">// The following script:
var r = new XMLHttpRequest();
r.open('get', 'test.txt', false);
r.send();
alert(r.getAllResponseHeaders());

// ...should display a dialog with text similar to the following:
Date: Sun, 24 Oct 2004 04:58:38 GMT
Server: Apache/1.3.31 (Unix)
Keep-Alive: timeout=15, max=99
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/plain; charset=utf-8</pre></div><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>header</code>
          of type
          DOMString</dt><dd>
              @XXX TDB@
            </dd></dl></dd><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>
              @XXX TBD@
            </td></tr></table></dl></dd><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>INVALID_STATE_ERR</td><td>
                <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be raised if this method is called when
                <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
                has an inappropriate value.
              </td></tr>
            </table></td></tr></table></dd></dl></dd><dt id="idl-meth-XMLHttpRequest-open"><code>open</code></dt><dd><p>
              Calling this method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> initialise the object by remembering the <var>method</var>,
              <var>uri</var>, <var>async</var> (defaulting to <code>true</code> if
              omitted), <var>user</var> (defaulting to <code>null</code> if omitted), and
              <var>password</var> (defaulting to <code>null</code> if omitted) arguments,
              setting the <code>readyState</code> attribute to 1 (OPEN_STATE), resetting
              the <code>responseText</code>, <code>responseXML</code>, <code>status</code>, and
              <code>statusText</code> attributes to their initial
              values, and resetting the list of request headers.
            </p><p>
              Same-origin security restrictions <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> apply.
            </p><p>
              If the URI given to this method contains a user name and a password
              (the latter potentially being the empty string), then these <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be used
              if the <var>user</var> and <var>password</var>
              arguments are omitted. If the arguments are not omitted, they take
              precedence, even if they are <code>null</code>.
            </p><p>
              If <code>open()</code> is called when <code>readyState</code> is
              4 (LOADED_STATE) the entire object <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be reset.
            </p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>method</code>
          of type
          DOMString</dt><dd>
              A valid HTTP method name. The <code>GET</code>, <code>POST</code>,
              and <code>HEAD</code> values <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be supported.
            </dd><dt><code>uri</code>
          of type
          DOMString</dt><dd>
              A URI, which <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be resolved to an absolute URI using the script's
              context <code>window.location.href</code> value as base if available,
              and <code>xml:base</code> otherwise.
            </dd><dt><code>async</code>
          of type
          boolean, optional</dt><dd>
              @XXX TBD@
            </dd><dt><code>user</code>
          of type
          DOMString, optional</dt><dd>
              @XXX TBD@
            </dd><dt><code>password</code>
          of type
          DOMString, optional</dt><dd>
              @XXX TBD@
            </dd></dl></dd><dt>No Return Value</dt><dt>No Exceptions</dt></dl></dd><dt id="idl-meth-XMLHttpRequest-send"><code>send</code></dt><dd><p>
              If the <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code> attribute
              has a value other than
              1 (<code>OPEN_STATE</code>), an exception <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised. Otherwise, the
              <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
              attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be set to 2 (<code>SENT_STATE</code>) and
              a request to <var>uri</var> using method <var>method</var>, authenticating using
              <var>user</var> and
              <var>password</var> as appropriate is sent. If the <var>async</var> flag is set
              to false, then the method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> not
              return until the request has completed. Otherwise, it <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> return
              immediately. (See: <code><a href="#idl-meth-XMLHttpRequest-open">open()</a></code>.)
            </p><p>
              If the <var>method</var> is <code>POST</code> or
              <code>PUT</code>, then the <var>data</var> passed to the
              <code>send()</code> method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be used for the entity body. If <var>data</var>
              is a string, the data <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be encoded as UTF-8 for
              transmission. If the <var>data</var> is a Document, then the
              document <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be serialised using the encoding given by
              <code><var>data</var>.xmlEncoding</code>, if specified, or UTF-8
              otherwise [<cite><a href="#DOM3" class="bibref">DOM3</a></cite>]. If <var>data</var> is not a Document or a DOMString
              the host language <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> use the stringification mechanisms on the argument
              that was passed.
            </p><p>
             Implementations <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> support the <code>send()</code> to be called
             without the <var>data</var> argument to be passed.
            </p><p>
              If the response is an HTTP redirect (status code 301, 302, 303 or 307),
              then it <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be transparently
              followed (unless it violates security or infinite loop precautions). Any
              other error (including a 401) <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> cause the object to use that error
              page as the response.
            </p><p>
              Once the final HTTP status line has been received, the
              <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
              attribute <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be set to to 3
              (<code>RECEIVING_STATE</code>). When the request has completed loading, the
              <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
              attribute <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be set to 4 (<code>LOADED_STATE</code>).
              
            </p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>data</code>
          of varying types (see IDL)
        </dt><dd>
              @XXX TDB@
            </dd></dl></dd><dt>No Return Value</dt><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>INVALID_STATE_ERR</td><td>
                <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be raised if this method is called when
                <code><a href="#idl-attr-XMLHttpRequest-readyState">readyState</a></code>
                has an inappropriate value.
              </td></tr>
            </table></td></tr></table></dd></dl></dd><dt id="idl-meth-XMLHttpRequest-setRequestHeader"><code>setRequestHeader</code></dt><dd><p>
              If the <code><a href="#readystate">readyState</a></code> attribute has a
              value other than 1 (Open), an exception <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be raised. If the <var>header</var> or
              <var>value</var> arguments contain any U+000A LINE FEED or U+000D
              CARRIAGE RETURN characters, or if the <var>header</var> argument
              contains any U+0020 SPACE or U+003A COLON charecters, nothing <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be done.
              Otherwise, the request header <var>header</var> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be set to <var>value</var>.
              If the request header <var>header</var> had already been set, then the new
              <var>value</var> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be concatenated to the existing value using a U+002C COMMA
              followed by a U+0020 SPACE for separation.
            </p><div class="boxed"><div><span class="exampleTitle">Example: Setting a request header</span></div><pre class="example" title="Setting a request header">// The following script:
var r = new XMLHttpRequest();
r.open('get', 'demo.cgi');
r.setRequestHeader('X-Test', 'one');
r.setRequestHeader('X-Test', 'two');
r.send(null);

// ...would result in the following header being sent:
...
X-Test: one, two
...</pre></div><p>
              The list of request headers <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be reset when the
              <code><a href="#idl-meth-XMLHttpRequest-open">open()</a></code>
              method is called.
            </p><p>
              User agents <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> not set any headers other than the headers set by the
              author using this method, with the following exceptions:
            </p><ul>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> set the <code>Host</code> header appropriately (see
                <code><a href="#idl-meth-XMLHttpRequest-open">open()</a></code>) and not allow it to be
                overridden.
              </li>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> set the <code>Authorization</code> header according to the
                values passed to the <code><a href="#openmethod">open()</a></code> method
                (but <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> allow calls to
                <code><a href="#idl-meth-XMLHttpRequest-setRequestHeader">setRequestHeader()</a></code> to append values
                to it).
              </li>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> set the <code>Accept-Charset</code> and
                <code>Accept-Encoding</code> headers and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> allow them to be
                overridden.
              </li>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> set the <code>If-Modified-Since</code>,
                <code>If-None-Match</code>, <code>If-Range</code>, and
                <code>Range</code> headers if the resource is cached and has not
                expired (as allowed by HTTP), and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> allow those headers to be
                overridden.
              </li>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> set the <code>Connection</code> and
                <code>Keep-Alive</code> headers as described by the HTTP specification,
                and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> allow those headers to be overridden.
              </li>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> set the proxy-related headers according to proxy settings
                of the environment, and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> allow those headers to be overridden.
              </li>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> give the <code>User-Agent</code> header an initial value,
                but <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> allow authors to append values to it.
              </li>
              <li>
                UAs <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> set <code>Cookie</code> and <code>Cookie2</code> headers
                appropriately for the given URI and given the user's current cookies,
                and <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> allow authors to append values to these headers.
              </li>
            </ul><p>
              In particular, UAs <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> automatically set the
              <code>Cache-Control</code> or <code>Pragma</code> headers to defeat
              caching [<cite><a href="#RFC2616" class="bibref">RFC2616</a></cite>].
            </p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>header</code>
          of type
          DOMString</dt><dd>
              @XXX TDB@
            </dd><dt><code>value</code>
          of type
          DOMString</dt><dd>
              @XXX TDB@
            </dd></dl></dd><dt>No Return Value</dt><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-DOMException">DOMException</a></td><td><table>
              <tr><td>UNKNOWN_ERR</td><td>
                @XXX TDB@
              </td></tr>
            </table></td></tr></table></dd></dl></dd></dl></div></div>

    <p>
      HTTP requests sent from multiple different
      <code><a href="#xmlhttprequest">XMLHttpRequest</a></code>
      objects in succession <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> be pipelined into shared HTTP connections.
    </p>
  </div>

  <div class="section"><h2 id="bibref">A. References</h2>
    

    <dl class="bibliography"><dt id="DOM3">DOM3</dt><dd><cite><a href="http://www.w3.org/TR/DOM-Level-3-Core/">Document Object Model (DOM) Level 3 Core Specification</a></cite>,
    <span class="person">Arnaud Le Hors (IBM)</span>, <span class="person">Philippe Le Hégaret (W3C)</span>, <span class="person">Lauren Wood (SoftQuad, Inc.)</span>, <span class="person">Gavin Nicol (Inso EPS)</span>, <span class="person">Jonathan Robie (Texcel Research and Software AG)</span>, <span class="person">Mike Champion (Arbortext and Software AG)</span>, and <span class="person">Steve Byrne (JavaSoft)</span>.</dd><dt id="RFC2119">RFC2119</dt><dd><cite><a href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a></cite>,
    <span class="person">S. Bradner</span>.</dd><dt id="RFC2616">RFC2616</dt><dd><cite><a href="http://www.ietf.org/rfc/rfc2616.txt">Hypertext Transfer Protocol -- HTTP/1.1</a></cite>,
    <span class="person">R. Fielding (UC Irvine)</span>, <span class="person">J. Gettys (Compaq/W3C)</span>, <span class="person">J. Mogul (Compaq)</span>, <span class="person">H. Frystyk (W3C/MIT)</span>, <span class="person">L. Masinter (Xerox)</span>, <span class="person">P. Leach (Microsoft)</span>, and <span class="person">T. Berners-Lee (W3C/MIT)</span>.</dd></dl>
  </div>

</body></html>
