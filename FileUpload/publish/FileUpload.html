<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
          ******* WARNING ********
          This document was automatically generated using the Re-Spec specification
          publishing system. Edits made here are likely to be lost when it is
          regenerated.
          ******* WARNING ********
        --><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>File Upload</title><link rel="stylesheet" href="respec-w3c.css" type="text/css"></link><link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/base" type="text/css"></link><meta name="revision" content="$Id: FileUpload.html,v 1.2 2006-05-04 00:35:21 rberjon Exp $"></meta></head><body><div class="head"><p><a href="http://www.w3.org/"><img class="head" src="http://www.w3.org/Icons/w3c_home" width="72" height="48" alt="W3C"></img></a></p><h1 class="head">File Upload</h1><h2 id="pagesubtitle">W3C Editor's Draft <em>01 May 2006</em></h2><dl><dt>This version:</dt><dd><a href=""></a></dd><dt>Latest version:</dt><dd><a href="
      ">
      </a></dd><dt>Previous version:</dt><dd><a href=""></a></dd><dt>Editor:</dt><dd><span class="person"><a href="http://berjon.com/">Robin Berjon</a> (<a href="http://expway.com/">Expway</a>) &lt;<a href="mailto:robin.berjon@expway.fr">robin.berjon@expway.fr</a>&gt;</span></dd></dl><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©2006
        <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>,
        <a href="http://www.ercim.org/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and 
        <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document  use</a> rules apply.
      </p></div><hr></hr>

  

  <h2 id="specabstract">Abstract</h2><div class="section">
    
    <p>
      This specification provides an <acronym title="Application Programming Interface">API</acronym>
      used to prompt the user with a file selection dialogue and obtain the data contained in files
      on the user's file system.
    </p>
    <div class="ednote">
      <p>
        Last update: $Id: FileUpload.html,v 1.2 2006-05-04 00:35:21 rberjon Exp $.
      </p>
    </div>
  </div>

  <div class="section"><h2 id="sotd">Status of this Document</h2>
    

    
  <p>
    <em>This section describes the status of this document at the time of its publication.
    Other documents may supersede this document. A list of current <acronym title="World Wide Web Consortium">W3C</acronym> publications and the
    latest revision of this technical report can be found in the 
    <a href="http://www.w3.org/TR/"><acronym title="World Wide Web Consortium">W3C</acronym>
    technical reports index</a> at http://www.w3.org/TR/.</em>
  </p>

    <p>
      This document is an Editor's Draft and is not suitable for purposes other
      than reviewing the specification being developed.
    </p>
    
    
  <p>
    Publication as a Working Draft does not imply endorsement by the <acronym title="World Wide Web Consortium">W3C</acronym> Membership.
    This is a draft document and may be updated, replaced or obsoleted by other 
    documents at any time. It is inappropriate to cite this document as other than
    work in progress.
  </p>

  </div>

  <div class="section"><h2 id="contents">Table of contents</h2>
    

    <ul class="toc"><li><a href="#introduction">1. Introduction</a></li><li><a href="#file-ex">2. The FileException exception</a></li><li><a href="#dialog-if">3. The FileDialog interface</a></li><li><a href="#FileList-if">4. The FileList interface</a></li><li><a href="#File-if">5. The File interface</a></li><li><a href="#files-selected-event">6. The 
        '<code class="event-name">files-selected</code>'
       Event</a></li><li><ul class="toc"><li><a href="#FilesSelectionEvent-if">6.1. The FilesSelectionEvent interface</a></li></ul></li><li><a href="#xhr">7. Integration with XMLHttpRequest</a></li><li><a href="#conform">8. Conformance</a></li><li><a href="#ack">9. Acknowledgements</a></li></ul><ul class="toc"><li><a href="#bibref">A. References</a></li></ul>
  </div>

  <div class="section"><h2 id="introduction">1. Introduction</h2>
    
    <p>
      It is desirable for Web applications to have the ability to manipulate as wide
      as possible a range of user input, including files that a user may wish to upload 
      to a remote server or manipulate inside a rich application. This interface 
      provides application writers with the means to trigger a file selection prompt 
      with which the user can select one or more files. Unlike the file upload forms 
      control available to <acronym title="HyperText Markup Language">HTML</acronym>, 
      this <acronym title="Application Programming Interface">API</acronym> can be used for more than simply inserting a file into the content of a 
      form being submitted but also allows client-side manipulation of the content, for 
      instance to display an image or parse an <acronym title="eXtensible Markup Language">XML</acronym>
      document from disk.
    </p>
  </div>

  <div class="section"><h2 id="file-ex">2. The FileException exception</h2>
    
    <p>
      <div class="ednote">This needs to be described, check existing stuff</div>
    </p>

    <div class="boxed"><p><span class="idlTitle">The FileException exception</span></p><pre class="schema" title="The FileException exception">exception <a href="#idl-if-FileException">FileException</a> {
  unsigned short   code;
};
// FileExceptionCode
const unsigned short      <a href="#idl-defs-FileExceptionCode-NOT_FOUND_ERR">NOT_FOUND_ERR</a>         = 0;
const unsigned short      <a href="#idl-defs-FileExceptionCode-NOT_READABLE_ERR">NOT_READABLE_ERR</a>      = 1;
</pre></div><div class="section"><h4 class="idl-header" id="idl-defs-FileExceptionCode">Definition Group <em>FileExceptionCode</em></h4><dl class="idl-defs"><dt id="idl-defs-FileExceptionCode-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></dt><dd>
            The file that is trying to be read does not exist. This may be due
            to it having been moved or deleted after a pointer to it was
            acquired.
          </dd><dt id="idl-defs-FileExceptionCode-NOT_READABLE_ERR"><code>NOT_READABLE_ERR</code></dt><dd>
            The file cannot be read. This may be due to permission problems.
          </dd></dl></div>
  </div>

  <div class="section"><h2 id="dialog-if">3. The FileDialog interface</h2>
    
    <p>
      The purpose of the <a href="#idl-if-FileDialog" class="if-name">FileDialog</a> interface is to control the apparition of a file dialogue, and to register the 
      event listeners that will handle the selection of files. The <a href="#idl-if-FileDialog" class="if-name">FileDialog</a> 
      object inherits from <span class="if-name">EventTarget</span> and it is this possible to attach event 
      listeners to it using the <span class="meth-name">addEventListener</span> method.
    </p>

    <div class="boxed"><p><span class="idlTitle">The FileDialog interface</span></p><pre class="schema" title="The FileDialog interface">interface <a href="#idl-if-FileDialog">FileDialog</a> : events::EventTarget {
  void <a href="#idl-meth-FileDialog-open">open</a>();
};</pre></div><div class="section" id="idl-if-FileDialog"><div class="section"><h4 class="idl-header">Methods</h4><dl class="idl-meth"><dt id="idl-meth-FileDialog-open"><code>open</code></dt><dd><p>
              When called, this method <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> prompt the user with a means to select one 
              or more files. The exact manner in which the user is prompted is implementation
              dependent. On devices that have no file system, the user-agent <em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em> still open a
              dialogue for data acquisition, for instance an interface to a built-in camera.
            </p><p>
              This method operates in an asynchronous manner such that the files which are 
              selected will be communicated to handlers registered on the <a href="#idl-if-FileDialog" class="if-name">FileDialog</a>
              object instance to listen to the 
        '<a href="#event-files-selected" class="event-name">files-selected</a>'
       event. An example
              follows in which when file selection is performed, the listener object will 
              be called with a <a href="#idl-if-FilesSelectionEvent" class="if-name">FilesSelectionEvent</a> object.
            </p><div class="boxed"><div><span class="exampleTitle">Example: Basic FileDialog usage</span></div><pre class="example" title="Basic FileDialog usage">var fd = new FileDialog();
fd.addEventListenerNS("http://www.w3.org/2006/05/fs-event#", "files-selected", listener, false);
fd.open();</pre></div><dl><dt>No Parameters</dt><dt>No Return Value</dt><dt>No Exceptions</dt></dl></dd></dl></div></div>
  </div>

  <div class="section"><h2 id="FileList-if">4. The FileList interface</h2>
    
    <p>
      This interface exposes the list of files that has been selected through the file
      dialogue. When no file has been selected, its length is zero. It is possible that
      some platforms will only allow for one file to be selected at a time, however when 
      possible a user-agent <em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em> provide the option to select multiple files in one pass.
    </p>

    <div class="boxed"><p><span class="idlTitle">The FileList interface</span></p><pre class="schema" title="The FileList interface">interface <a href="#idl-if-FileList">FileList</a> {
  readonly attribute unsigned long  <a href="#idl-attr-FileList-length">length</a>;
  <a href="#idl-if-File">File</a>               <a href="#idl-meth-FileList-item">item</a>(in unsigned long index);
  <a href="#idl-if-File">File</a>               <a href="#idl-meth-FileList-removeItem">removeItem</a>(in unsigned long index);
};</pre></div><div class="section" id="idl-if-FileList"><div class="section"><h4 class="idl-header">Attributes</h4><dl class="idl-attr"><dt id="idl-attr-FileList-length"><code>length</code>
      of type
      unsigned long, readonly</dt><dd><p>
              The number of files in the list. The range of valid file indices is 0 to 
              <code>length</code>-1 inclusive.
            </p></dd></dl></div><div class="section"><h4 class="idl-header">Methods</h4><dl class="idl-meth"><dt id="idl-meth-FileList-item"><code>item</code></dt><dd><p>
              Returns the <code>index</code>th item in the collection. If 
              <code>index</code> is greater than or equal to the number of files in the
              list, this returns <code>null</code>.
            </p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>index</code>
          of type
          unsigned long</dt><dd>
              Index into the collection.
            </dd></dl></dd><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>
              The file at the <code>index</code>th position in the <a href="#idl-if-FileList" class="if-name">FileList</a>, or <code>null</code>
              if that is not a valid <code>index</code>.
            </td></tr></table></dl></dd><dt>No Exceptions</dt></dl></dd><dt id="idl-meth-FileList-removeItem"><code>removeItem</code></dt><dd><p>
              Removes the <code>index</code>th item in the collection. If 
              <code>index</code> is greater than or equal to the number of files in the
              list, this does nothing. This can be used to filter out files that do not
              match certain criteria (media type, file extension, etc.).
            </p><dl><dt>Parameters</dt><dd class="idl-params"><dl><dt><code>index</code>
          of type
          unsigned long</dt><dd>
              Index into the collection.
            </dd></dl></dd><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>
              The file that was removed from the <a href="#idl-if-FileList" class="if-name">FileList</a>, or <code>null</code>
              if that is not a valid <code>index</code>.
            </td></tr></table></dl></dd><dt>No Exceptions</dt></dl></dd></dl></div></div>
  </div>

  <div class="section"><h2 id="File-if">5. The File interface</h2>
    
    <p>
      This interface describes a single file in a <a href="#idl-if-FileList" class="if-name">FileList</a>, exposes 
      its name and media type, and provides access its content.
    </p>
    <p>
      Please note that in order to be memory-efficient, implementations are not
      required to load the content of files into memory as soon as they have been 
      selected, but only when their content is required by the application. When passing a
      <a href="#idl-if-File" class="if-name">File</a> object to network <acronym title="Application Programming Interface">API</acronym> such as <span class="if-name">XMLHttpRequest</span> an 
      implementation may stream the content of a file to a socket and never need 
      to hold more than a few of its bytes in memory. Therefore one needs to be
      aware that the content of the file may change or cease to be available between
      the moment the file is selected and the moment it is accessed.
    </p>

    <div class="boxed"><p><span class="idlTitle">The File interface</span></p><pre class="schema" title="The File interface">interface <a href="#idl-if-File">File</a> {

  readonly attribute DOMString  <a href="#idl-attr-File-fileName">fileName</a>;
  readonly attribute DOMString  <a href="#idl-attr-File-mediaType">mediaType</a>;
  readonly attribute DOMString  <a href="#idl-attr-File-fileSize">fileSize</a>;
  DOMString          <a href="#idl-meth-File-getDataAsString">getDataAsString</a>()
                                        raises(FileException);
  DOMString          <a href="#idl-meth-File-getDataAsBase64">getDataAsBase64</a>()
                                        raises(FileException);
  DOMString          <a href="#idl-meth-File-getDataAsHexBinary">getDataAsHexBinary</a>()
                                        raises(FileException);
};</pre></div><div class="section" id="idl-if-File"><div class="section"><h4 class="idl-header">Attributes</h4><dl class="idl-attr"><dt id="idl-attr-File-fileName"><code>fileName</code>
      of type
      DOMString, readonly</dt><dd><p>
              The name of the file, exclusive of its path.
            </p></dd><dt id="idl-attr-File-fileSize"><code>fileSize</code>
      of type
      DOMString, readonly</dt><dd><p>
              The size of the file, in bytes. Users should keep in mind that in certain
              cases this information may not be available, and that it also may
              vary as a file is being read.
            </p></dd><dt id="idl-attr-File-mediaType"><code>mediaType</code>
      of type
      DOMString, readonly</dt><dd><p>
              The media type of the file, if known to the user-agent.
            </p></dd></dl></div><div class="section"><h4 class="idl-header">Methods</h4><dl class="idl-meth"><dt id="idl-meth-File-getDataAsBase64"><code>getDataAsBase64</code></dt><dd><p>
              Returns the file's content encoded using Base64. An empty file returns an empty string.
              <div class="ednote">Need ref</div>
            </p><dl><dt>No Parameters</dt><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>
              The content of the file encoded in Base64.
            </td></tr></table></dl></dd><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-FileException">FileException</a></td><td>
              <p>
                All codes apply.
              </p>
            </td></tr></table></dd></dl></dd><dt id="idl-meth-File-getDataAsHexBinary"><code>getDataAsHexBinary</code></dt><dd><p>
              Returns the file's content encoded using hex-binary. An empty file returns an empty string.
              <div class="ednote">Need ref</div>
            </p><dl><dt>No Parameters</dt><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>
              The content of the file encoded in hex-binary.
            </td></tr></table></dl></dd><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-FileException">FileException</a></td><td>
              <p>
                All codes apply.
              </p>
            </td></tr></table></dd></dl></dd><dt id="idl-meth-File-getDataAsString"><code>getDataAsString</code></dt><dd><p>
              Returns the file's content as a string. An empty file returns an empty string.
            </p><div class="ednote">
              <p>
                This has any number of issues with encoding, binary data, etc.
              </p>
            </div><dl><dt>No Parameters</dt><dt>Return Value</dt><dd><dl><table><tr><td><code></code></td><td>
              The content of the file.
            </td></tr></table></dl></dd><dt>Exceptions</dt><dd><table><tr><td><a href="#idl-if-FileException">FileException</a></td><td>
              <p>
                All codes apply.
              </p>
            </td></tr></table></dd></dl></dd></dl></div></div>
  </div>


  <div class="section"><h2 id="files-selected-event">6. The 
        '<code class="event-name">files-selected</code>'
       Event</h2>
    
    <div class="ednote">
      <p>
        Make full description of event as well as the interface.
      </p>
    </div>

    <div class="section"><h3 id="FilesSelectionEvent-if">6.1. The FilesSelectionEvent interface</h3>
      
      <p>
        ...
      </p>

      <div class="boxed"><p><span class="idlTitle">The FilesSelectionEvent interface</span></p><pre class="schema" title="The FilesSelectionEvent interface">interface <a href="#idl-if-FilesSelectionEvent">FilesSelectionEvent</a> : events::Event {
  readonly attribute <a href="#idl-if-FileList">FileList</a>  <a href="#idl-attr-FilesSelectionEvent-fileList">fileList</a>;
};</pre></div><div class="section" id="idl-if-FilesSelectionEvent"><div class="section"><h4 class="idl-header">Attributes</h4><dl class="idl-attr"><dt id="idl-attr-FilesSelectionEvent-fileList"><code>fileList</code>
      of type
      <a href="#idl-if-FileList">FileList</a>, readonly</dt><dd><p>
                The list of files that were selected. If the dialogue was cancelled
                or no file was selected, the list <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be empty.
              </p></dd></dl></div></div>
    </div>
  </div>

  <div class="section"><h2 id="xhr">7. Integration with XMLHttpRequest</h2>
    
    <p>
      
    </p>
  </div>

  <div class="section"><h2 id="conform">8. Conformance</h2>
    
    <p>
      
    </p>
  </div>

  <div class="section"><h2 id="ack">9. Acknowledgements</h2>
    
    <p>
      This specification was originally developed by the SVG Working Group.
    </p>
  </div>

  <div class="section"><h2 id="bibref">A. References</h2>
    

    <dl class="bibliography"></dl>
  </div>
</body></html>
