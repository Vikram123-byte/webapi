<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--
          ******* WARNING ********
          This document was automatically generated using the Re-Spec specification
          publishing system. Edits made here are likely to be lost when it is
          regenerated.
          ******* WARNING ********
        --><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Window Object 1.0</title><link rel="stylesheet" href="respec-w3c.css" type="text/css"></link><link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/base" type="text/css"></link><meta name="revision" content="$Id: Window.html,v 1.10 2006-04-05 07:11:15 mstachow Exp $"></meta></head><body><div class="head"><p><a href="http://www.w3.org/"><img class="head" src="http://www.w3.org/Icons/w3c_home" width="72" height="48" alt="W3C"></img></a></p><h1 class="head">Window Object 1.0</h1><h2 id="pagesubtitle">W3C Editor's Draft <em>30 March 2006</em></h2><dl><dt>This version:</dt><dd><a href="http://dev.w3.org/cvsweb/~checkout~/2006/webapi/Window/publish/Window.html">http://dev.w3.org/cvsweb/~checkout~/2006/webapi/Window/publish/Window.html</a></dd><dt>Latest version:</dt><dd><a href="http://dev.w3.org/cvsweb/~checkout~/2006/webapi/Window/publish/Window.html">http://dev.w3.org/cvsweb/~checkout~/2006/webapi/Window/publish/Window.html</a></dd><dt>Editors:</dt><dd><span class="person">Ian Davis (<a href="http://www.talis.com/">Talis Information Ltd.</a>) &lt;<a href="mailto:ian.davis@talis.com">ian.davis@talis.com</a>&gt;</span></dd><dd><span class="person">Maciej Stachowiak (<a href="http://apple.com/">Apple Computer, Inc.</a>) &lt;<a href="mailto:mjs@apple.com">mjs@apple.com</a>&gt;</span></dd></dl><p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©2006
        <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>,
        <a href="http://www.ercim.org/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and 
        <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document  use</a> rules apply.
      </p></div><hr></hr>
  

  <h2 id="specabstract">Abstract</h2><div class="section">
    

    <p>
      This specification defines the <a class="term" href="#dfn-window-object"><code>Window</code>
      object</a>, which provides the global namespace for web
      scripting languages, access to other documents in a compound
      document by reference, navigation to other locations, and
      timers. The <a class="term" href="#dfn-window-object"><code>Window</code> object</a> is a
      longstanding de facto standard for HTML user agents. However, it
      should not be assumed based on this or the name "Window" that it
      is limited to HTML or to visual user agents.
    </p>
  </div>

  <div class="section"><h2 id="sotd">Status of this Document</h2>
    

    <p>
      <em>This section describes the status of this document at the time of its publication.
      Other documents may supersede this document. A list of current <acronym title="World Wide Web Consortium">W3C</acronym> publications and the
      latest revision of this technical report can be found in the
      <a href="http://www.w3.org/TR/"><acronym title="World Wide Web Consortium">W3C</acronym> technical reports index</a> at http://www.w3.org/TR/.</em>
    </p>
    <p>
      This document is produced by the <a href="http://www.w3.org/2006/webapi">Web API
      <acronym title="Working Group">WG</acronym></a> (part of the
      <a href="http://www.w3.org/2006/rwc/Activity">Rich Web Clients Activity</a>).
      This document has no formal standing within the <acronym title="World Wide Web Consortium">W3C</acronym>.
      Please send comments to <a href="mailto:public-webapi@w3.org">public-webapi@w3.org</a>,
      the public email list for issues related to Web APIs.
    </p>
    <p>
      The patent policy for this document is the
      <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.
      Patent disclosures relevant to this specification may be found on the
      <a href="http://www.w3.org/2004/01/pp-impl/38482/status" rel="disclosure">Web API Working Group's patent
      disclosure page</a>. An individual who has actual knowledge of a patent which the individual believes
      contains Essential Claim(s) with respect to this specification should disclose the information in
      accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6
      of the <acronym title="World Wide Web Consortium">W3C</acronym> Patent Policy</a>.
    </p>
    <p>
      Publication as an Editor's Draft does not imply endorsement by the <acronym title="World Wide Web Consortium">W3C</acronym> Membership.
      This is a draft document and may be updated, replaced or obsoleted by other
      documents at any time. It is inappropriate to cite this document as other than
      work in progress.
    </p>
  </div>

  <div class="section"><h2 id="contents">Table of contents</h2>
    
    <ul class="toc"><li><a href="#introduction">1. Introduction</a></li><li><ul class="toc"><li><a href="#usage">1.1. Examples of usage</a></li><li><a href="#notcovered">1.2. Not in This Specification</a></li><li><a href="#definitions">1.3. Definitions</a></li><li><a href="#conformance">1.4. Conformance</a></li></ul></li><li><a href="#browsing">2. Browsing Contexts</a></li><li><ul class="toc"><li><a href="#window">2.1. The <code>Window</code> Interface, Basic Attributes</a></li><li><ul class="toc"><li><a href="#window-basic-attributes">2.1.1. Attributes</a></li><li><a href="#window-basic-scripting">2.1.2. Use in scripting</a></li></ul></li><li><a href="#document-window">2.2. The <code>DocumentWindow</code> Interface, Basic Attributes</a></li></ul></li><li><a href="#navigation">3. Navigation</a></li><li><ul class="toc"><li><a href="#window-location">3.1. The <code>Window</code> Interface, Location Attributes</a></li><li><ul class="toc"><li><a href="#window-location-attributes">3.1.1. Attributes</a></li></ul></li><li><a href="#document-location">3.2. The <code>DocumentWindow</code> Interface, Location Attributes</a></li><li><ul class="toc"><li><a href="#document-location-attributes">3.2.1. Attributes</a></li></ul></li><li><a href="#location">3.3. The <code>Location</code> Interface</a></li><li><ul class="toc"><li><a href="#location-attributes">3.3.1. Attributes</a></li><li><a href="#location-methods">3.3.2. Methods</a></li></ul></li></ul></li><li><a href="#embedding">4. Embedding: Compound Documents by Reference</a></li><li><ul class="toc"><li><a href="#window-embedding">4.1. The <code>Window</code> Interface, Embedding Attributes</a></li><li><a href="#embeddingelt">4.2. The <code>EmbeddingElement</code> Interface</a></li></ul></li><li><a href="#timers">5. Timers</a></li><li><ul class="toc"><li><a href="#window-timers">5.1. The <code>Window</code> Interface, Timer Attributes</a></li><li><a href="#timerlistener">5.2. The <em>TimerListener</em> Interface</a></li></ul></li><li><a href="#security">6. Security Considerations</a></li></ul><ul class="toc"><li><a href="#idl">A. IDL Definitions</a></li><li><a href="#ecmascript-binding">B. ECMAScript Language Binding</a></li><li><a href="#java-binding">C. Java Language Binding</a></li><li><a href="#acknow">D. Acknowledgements</a></li><li><a href="#bibref">E. References</a></li></ul>
  </div>

  <div class="section"><h2 id="introduction">1. Introduction</h2><p><strong>This section is not normative normative.</strong></p>
    

    <p>
      The <strong>Window Object 1.0</strong> specification defines a
      subset of the features of the <a class="term" href="#dfn-window-object"><code>Window</code>
      object</a>, a widely implemented part of HTML User Agents,
      with parts also found in non-HTML UAs that offer scripting and
      DOM access. This specification is intended to be suitable for
      all implementations that present any sort of DOM document
      [<cite><a href="#DOM3Core" class="bibref">DOM3Core</a></cite>] to the user.
    </p>

    <p>
      This specification defines four features of the window
      object. It describes the use of the Window object as a
      <a class="term" href="#dfn-browsing-context">browsing context</a>: a container that displays a
      document, or a series of documents in sequence. It describes
      interfaces for <a class="term" href="#dfn-navigation">navigation</a>, the ability to go to
      a new document in the same <a class="term" href="#dfn-browsing-context">browsing context</a>. It
      describes interfaces for <strong>embedding</strong>, a feature
      also known as <strong>compound document by reference</strong>,
      where one document includes another separate document by
      external reference. And it specifies methods for using
      <strong>timers</strong>.
    </p>

    <p>
      In addition, for some languages, such as ECMAScript
      [<cite><a href="#ECMAScript" class="bibref">ECMAScript</a></cite>], the <a class="term" href="#dfn-window-interface"><code>Window</code> interface</a> is
      implemented by the object that provides the global namespace for
      script execution. The details of how this works for ECMAScript
      are specified in <a href="#ecmascript-binding">ECMAScript
      Language Binding Appendix</a>.
    </p>

    <div class="section"><h3 id="usage">1.1. Examples of usage</h3><p><strong>This section is not normative normative.</strong></p>
      

      <div class="ednote">ACTION-129: Write Window Object 1.0 "examples of usage" section.</div>
    </div>

    <div class="section"><h3 id="notcovered">1.2. Not in This Specification</h3><p><strong>This section is not normative normative.</strong></p>
      

      <p>
      This specification does not include the following features,
      which are also found on the Window object in some
      implementations. It is possible they will defined by other
      specifications or found in a future version of this specification.
      </p>

      <ul>
      <li>History <div class="ednote">ISSUE-59: Should Window 1.0 include history?</div></li>
      <li>Access to frames by name <div class="ednote">ISSUE-60: Should Window Object 1.0 include access to frames by name (window.frames)?</div></li>
      <li>Opening new windows</li>
      <li>Manipulating UI of existing windows</li>
      <li>Window size and position information</li>
      <li>Client information ("window.navigator")</li>
      <li>Window events</li>
      <li>Printing</li>
      <li>Focus</li>
      <li>Selection</li>
      <li>Editing</li>
      <li>Networking APIs</li>
      <li>Handling of binary data</li>
      </ul>
    </div>

    <div class="section"><h3 id="definitions">1.3. Definitions</h3><p><strong>This section is not normative normative.</strong></p>
      

      <p>
        This specification distinctively marks terms being defined,
        and references to definitions. Uses of terms are hyperlinks to
        the point of definition. An example of a definition:
      </p>

      <div class="boxed"><div class="specexample">
        A <dfn id="dfn-flux-capacitor">flux capacitor</dfn> is the part of user agents that has
	the most negative imaginary flux impedance.
      </div></div>

      <p>An example of use:</p>

      <div class="boxed"><div class="specexample">
        When the engines are damaged, user agents typically calibrate
        the <a class="term" href="#dfn-flux-capacitor">flux capacitor</a>.
      </div></div>


    </div>

    <div class="section"><h3 id="conformance">1.4. Conformance</h3>
      

      <p>
        The key words "<em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>", "<em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em>", "<em class="rfc2119" title="Keyword in RFC 2119 context">REQUIRED</em>", "<em class="rfc2119" title="Keyword in RFC 2119 context">SHALL</em>", "<em class="rfc2119" title="Keyword in RFC 2119 context">SHALL NOT</em>", "<em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD</em>", "<em class="rfc2119" title="Keyword in RFC 2119 context">SHOULD NOT</em>",
        "<em class="rfc2119" title="Keyword in RFC 2119 context">RECOMMENDED</em>", "<em class="rfc2119" title="Keyword in RFC 2119 context">MAY</em>", and "<em class="rfc2119" title="Keyword in RFC 2119 context">OPTIONAL</em>" in this document are to be interpreted as described in
        RFC 2119 [<cite><a href="#RFC2119" class="bibref">RFC2119</a></cite>].
      </p>
      <p>

	Sometimes, for readability, conformance requirements are
	phrased as requirements on elements, attributes, methods,
	interfaces, properties or functions. In all cases these are
	conformance requirements on implementations.
      </p>
      <p>
        This specification defines three classes of conformance:

      </p>
      <dl>
        <dt><dfn id="dfn-conforming-implementation">conforming implementation</dfn></dt>
        <dd>
	  A <a class="term" href="#dfn-conforming-implementation">conforming implementation</a> of the <strong>Window
	  Object 1.0</strong> specification is one that implements all the
	  interfaces in this specification, and satisfies all other
	  <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>-, <em class="rfc2119" title="Keyword in RFC 2119 context">REQUIRED</em>- and <em class="rfc2119" title="Keyword in RFC 2119 context">SHALL</em>-level criteria in all parts of this
	  document other than language binding appendices.  
        </dd>

        <dt><dfn id="dfn-conforming-ecmascript-implementation">conforming ECMAScript implementation</dfn></dt>

        <dd>
	  A <a class="term" href="#dfn-conforming-ecmascript-implementation">conforming ECMAScript implementation</a> of the
          <strong>Window Object 1.0</strong> specification is a
          <a class="term" href="#dfn-conforming-implementation">conforming implementation</a> that maps all of the
          interfaces in this specification to ECMAScript [<cite><a href="#ECMAScript" class="bibref">ECMAScript</a></cite>],
          and satisfies the additional requirements in the <a href="#ecmascript-binding">ECMAScript Language Binding Appendix</a>.
	</dd>

        <dt><dfn id="dfn-conforming-java-implementation">conforming Java implementation</dfn></dt>
        <dd>
	  A <a class="term" href="#dfn-conforming-java-implementation">conforming Java implementation</a> of the
          <strong>Window Object 1.0</strong> specification is a
          <a class="term" href="#dfn-conforming-implementation">conforming implementation</a> that maps all of the
          interfaces in this specification to Java [<cite><a href="#Java" class="bibref">Java</a></cite>], and
          satisfies the additional requirements in the <a href="#java-binding">Java Language Binding Appendix</a>.
        </dd>

      </dl>

    </div>

  </div>

  <div class="section"><h2 id="browsing">2. Browsing Contexts</h2>
    

    <div class="ednote">ACTION-130: Need to add definition of "document"</div>

    <p>
      A <dfn id="dfn-browsing-context">browsing context</dfn> is a place where a user agent
      presents a document or a sequence of documents to the user,
      using one or more views. Only one document of this sequence is
      presented at a time. A <a class="term" href="#dfn-browsing-context">browsing context</a> is said to
      <dfn id="dfn-navigate">navigate</dfn> when it changes from presenting one document
      to another, for example by following a hyperlink. More is
      specified about navigation behavior in the <a href="#navigation">Navigation</a> section.
    </p>

    <p>
      A visual user agent typically presents a document by rendering
      it to a display. However, even non-visual agents could have a
      <a class="term" href="#dfn-browsing-context">browsing context</a>. For example, a voice browser also presents
      documents to the user. This also establishes a <a class="term" href="#dfn-browsing-context">browsing
      context</a>.
    </p>

    <p>
      An object that implements the <code>Document</code> interface
      [<cite><a href="#DOM3Core" class="bibref">DOM3Core</a></cite>] and is presented in a <a class="term" href="#dfn-browsing-context">browsing context</a>
      <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> also implement the <code>DocumentWindow</code> interface.
    </p>

    <p>
      Each view of a <code>Document</code> presented in a
      <a class="term" href="#dfn-browsing-context">browsing context</a> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be represented by an object
      that implements the <a class="term" href="#dfn-window-interface"><code>Window</code> interface</a>. One of these
      is the <dfn id="dfn-default-view">default view</dfn>. The <a class="term" href="#dfn-default-view">default view</a> is
      typically the primary mode of presentation to the user, and in
      interactive user agents, the primary means of interaction for
      the user. <div class="ednote">ISSUE-61: Should the Window spec drop any conformance 
      requirements for AbstractViews besides the defaultView?</div>
    </p>

    <p>
      An object that implements the <a class="term" href="#dfn-window-interface"><code>Window</code>
      interface</a> is referred to as a <dfn id="dfn-window-object"><code>Window</code>
      object</dfn>. Note: despite the name, a
      <a class="term" href="#dfn-window-object"><code>Window</code> object</a> does not necessarily
      represent an onscreen overlapping window, even in visual user
      agents.
    </p>

    <p>
      A document presented in a <a class="term" href="#dfn-browsing-context">browsing context</a> may have
      elements that embed additional documents, forming a Compound
      Document by Reference. Each such element creates a nested
      <a class="term" href="#dfn-browsing-context">browsing context</a>. This mechanism is described in <a href="#embedding">Embedding: Compound Documents by
      Reference</a>.
    </p>

    <p>
      When an event implementing the <code>UIEvent</code> interface [<cite><a href="#DOM3EV" class="bibref">DOM3EV</a></cite>]
      is dispatched on any node in a <code>Document</code> presented in a
      <a class="term" href="#dfn-browsing-context">browsing context</a>, the value of the <code>view</code> attribute of the
      event <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the <code>Window</code> object where the user originated the
      event. 

<div class="ednote">ISSUE-63: Should Window 1.0 drop the arguably redundant requirment on UIEvent.view?</div>

<div class="ednote">ISSUE-64: Should the Window spec define Window's place in DOM event flow?</div>
    </p>

    <div class="section"><h3 id="window">2.1. The <code>Window</code> Interface, Basic Attributes</h3>
      

      <p>The <dfn id="dfn-window-interface"><code>Window</code> interface</dfn> is fully
      specified in IDL in the <a href="#idl">IDL Definitions
      Appendix</a>. To better organize this specification, it is
      described in prose in mulitple IDL fragments.</p>

      <p>The <a class="term" href="#dfn-window-interface"><code>Window</code> interface</a> inherits from
      the <code>AbstractView</code> interface [<cite><a href="#DOM2Views" class="bibref">DOM2Views</a></cite>].</p>

      <p>In implementations that support Document Object Model CSS
      from DOM Level 2 Views [<cite><a href="#DOM2Views" class="bibref">DOM2Views</a></cite>], every
      <a class="term" href="#dfn-window-object"><code>Window</code> object</a> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> also implement the
      <code>ViewCSS</code> interface.</p>

      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

interface Window : views::AbstractView {
    // ...

    // self-references
    readonly attribute Window window;
    readonly attribute Window self;

    // ...
};</pre></div>

      <p>
        The value of the <code>document</code> property inherited by
        <code>Window</code> objects from the <code>AbstractView</code> interface
        <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the <code>Document</code> for which the <code>Window</code> is a
        view. As a result, in addition to the <code>DocumentView</code> interface,
        it implements the <code>Document</code> and <code>DocumentWindow</code> 
	interfaces.
      </p>

      <div class="section"><h4 id="window-basic-attributes">2.1.1. Attributes</h4>
        

        <p><a class="term" href="#dfn-window-object"><code>Window</code> object</a>s <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> have the following
        attributes:</p>

        <dl>
          <dt><dfn id="dfn-window-attribute"><code>window</code> attribute</dfn></dt>
          <dd>
	    The value of the <a class="term" href="#dfn-window-attribute"><code>window</code> attribute</a> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
            same <code>Window</code> object that has the attribute: the attribute
            is a self-reference.
          </dd>

          <dt><dfn id="dfn-self-attribute"><code>self</code> attribute</dfn></dt>
          <dd>
	    The value of the <a class="term" href="#dfn-self-attribute"><code>self</code> attribute</a> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
            same <code>Window</code> object that has the attribute: the attribute
            is a self-reference. Consequently, the value of the <a class="term" href="#dfn-self-attribute"><code>self</code> 
            attribute</a> <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the same object as the <a class="term" href="#dfn-window-attribute"><code>window</code> 
	    attribute</a>.

            <div class="ednote">ACTION-131: Need to define "being the same object" in such a way
	      that it is an equivalence relation. Then the second
	      conformance clause for "self" can just be a note.
            </div>
          </dd>
        </dl>

      </div>

      <div class="section"><h4 id="window-basic-scripting">2.1.2. Use in scripting</h4>
        

        <p>
          The <a class="term" href="#dfn-window-object"><code>Window</code> object</a> also has a special role as the
          global scope for scripts in the document in languages such as
          ECMAScript [<cite><a href="#ECMAScript" class="bibref">ECMAScript</a></cite>]. Such use is specified by individual
          language bindings. For ECMAScript it is specified in the <a href="#ecmascript">ECMAScript Language Binding
          Appendix</a>.
        </p>

      </div>

    </div>

    <div class="section"><h3 id="document-window">2.2. The <code>DocumentWindow</code> Interface, Basic Attributes</h3>
      

      <p>To better organize this specification, the
      <code>DocumentWindow</code> interface is presented in mulitple
      IDL fragments. The full normative IDL interface is presented in
      the <a href="#idl">IDL Definitions Appendix</a>. This fragment
      defines only the most basic methods and attributes of the
      <code>Window</code> interface.</p>

<div class="ednote">ISSUE-65: Should we also specify the parentWindow property? It is
effectively a synonym for defaultView but implemented by a different
set of UAs.</div>

      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

interface DocumentWindow : views::DocumentView {
    // ...
};</pre></div>

      <p>
        The value of the <code>defaultView</code> attribute inherited
        by objects that implement the <code>DocumentWindow</code>
        interface inherit from the <code>AbstractView</code> interface
        <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the default view for the <a class="term" href="#dfn-browsing-context">browsing context</a> presenting
        the document, if any. In addition to the
        <code>AbstractView</code> interface, the default view <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em>
        implement the <code>Window</code> interface. If a document is
	not being presented in a <a class="term" href="#dfn-browsing-context">browsing context</a> but nontheless
	implements the DocumentWindow interface, the value of the
        <code>defaultView</code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be
        <code>null</code>. <div class="ednote">ISSUE-66: should Documents that
        aren't being presented be required to have a null
        defaultView?</div>
      </p>
    </div>

  </div>

  <div class="section"><h2 id="navigation">3. Navigation</h2>
    <div class="ednote">Need prose description for this section, including
    definition of terms, etc.</div>

    

    <div class="section"><h3 id="window-location">3.1. The <code>Window</code> Interface, Location Attributes</h3>
      

      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

interface Window : views::AbstractView {
    // ...

    // assigning this has special behavior in ECMAScript, but it is otherwise
    // read only. specifically, in ES a string URI can be assigned to location,
    // having the same effect as location.assign(URI)
    readonly attribute Location location;

    // ...
};</pre></div>

      <div class="section"><h4 id="window-location-attributes">3.1.1. Attributes</h4>
        

        <p><a class="term" href="#dfn-window-object"><code>Window</code> object</a>s <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> have the following
         attributes:</p>

    <dl>
        <dt><dfn id="dfn-location">location</dfn></dt>
        <dd>
          The value of the <code>location</code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
          <code>Location</code> object that represents the window's current
          location. <div class="ednote">Need to define the term "current location"
          in prose.</div>
        </dd>
    </dl>

    </div>

    </div>

    <div class="section"><h3 id="document-location">3.2. The <code>DocumentWindow</code> Interface, Location Attributes</h3>
      
      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

interface DocumentWindow  : views::DocumentView {
    // ...
    // same special JS assignment as window.location
    readonly attribute Location location;
    // ...
};</pre></div>

      <div class="section"><h4 id="document-location-attributes">3.2.1. Attributes</h4>
        

    <p><code>DocumentWindow</code> objects <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> implement the following
     attributes:</p>

    <dl>
        <dt><dfn id="dfn-location">location</dfn></dt>
        <dd>The value of the <code>location</code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be a
         <code>Location</code> object that represents the
         <code>DocumentWindow</code>'s current location. The value <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
         same as the Location for all views of the document.
         <div class="ednote">Need to define the term
        "current location" in prose.</div></dd>
    </dl>

    </div>

    </div>

    <div class="section"><h3 id="location">3.3. The <code>Location</code> Interface</h3>
      

      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

interface Location {
    attribute dom::DOMString href;

    // pieces of the URI, per the generic URI syntax
    attribute dom::DOMString hash;
    attribute dom::DOMString host;
    attribute dom::DOMString hostname;
    attribute dom::DOMString pathname;
    attribute dom::DOMString port;
    attribute dom::DOMString protocol;
    attribute dom::DOMString search;

    void assign(in dom::DOMString url);
    void replace(in dom::DOMString url);
    void reload();

    dom::DOMString toString();
};</pre></div>

      <div class="section"><h4 id="location-attributes">3.3.1. Attributes</h4>
        

    <p><code>Location</code> objects <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> implement the following attributes:</p>

      <dl>
        <dt><dfn id="dfn-href">href</dfn></dt>

        <dd>
          The value of the <code>href</code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
          absolute URI reference [<cite><a href="#RFC2396" class="bibref">RFC2396</a></cite>] <div class="ednote">use newer URI
          RFC?</div> that is the Location's current location. When
          the <code>href</code> attribute is set, the Location's
          window <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> <em>navigate</em> to the newly set value.
          <div class="ednote">Must define the term navigate</div>
          <div class="ednote">ISSUE-67: Should resolution of relative URI
          references sent to location be defined in JS bindings or
          generally?</div> 
        </dd>

        <dt><dfn id="dfn-hash">hash</dfn></dt>
        <dd>
          If the absolute URI reference[<cite><a href="#RFC2396" class="bibref">RFC2396</a></cite>] for the Location's
          current location has a fragment identifier[<cite><a href="#RFC2396" class="bibref">RFC2396</a></cite>], then
          the value of the <code>hash</code> attribute the value of
          this attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the string concatenation of the hash
          mark(#) and the fragment identifier. Otherwise, the value of
          the <code>hash</code> attribute <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the empty
          string. When this atribute is set to a new value <var>new-hash</var>, 
	  user agents <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> perform the following steps:
	  <ol>
	  <li>Give the hash attribute the value <var>new-hash</var>.</li>
	  <li><em>Reconstruct the location URI</em><div class="ednote">Need to define the
	  term "reconstruct the location URI".</div></li>
	  <li><em>Navigate</em> to the result of step 2.</li>
	  </ol>
        </dd>

<div class="ednote">The remainder of these attribute descriptions need to be
rewritten to state conformance requirements. In the manner of the above.</div>

        <dt><dfn id="dfn-host">host</dfn></dt>
        <dd>
          This attribute represents the network host of the Location's
          URI. If the <code>port</code> attribute is not <code>null</code>
          then the <code>host</code> attribute's value is the concatenation of
          the <code>hostname</code> attribute, a colon (<code>:</code>) and the
          <code>port</code> attribute. If the <code>port</code> attribute is
          <code>null</code> then the <code>host</code> attribute's value is
          identical to the <code>hostname</code> attribute.
        </dd>


        <dt><dfn id="dfn-hostname">hostname</dfn></dt>
        <dd>
          This attribute represents the name or IP address of the
          network location without any port number.
        </dd>

        <dt><dfn id="dfn-pathname">pathname</dfn></dt>
        <dd>
          This attribute represents the path component of the
          Location's URI which consists of everything after the host
          and port up to and excluding the first question mark (?) or
          hash mark (#).
        </dd>

        <dt><dfn id="dfn-port">port</dfn></dt>
        <dd>
          This attribute represents the port number of the network
          location.
        </dd>

        <dt><dfn id="dfn-protocol">protocol</dfn></dt>
        <dd>
          This attribute represents the scheme of the URI including
          the trailing colon (:)
        </dd>

        <dt><dfn id="dfn-search">search</dfn></dt>
        <dd>
          This attribute represents the query portion of a URI. It
          consists of everything after the pathname up to and
          excluding the first hash mark (#).
       </dd>
     </dl>

     </div>

      <div class="section"><h4 id="location-methods">3.3.2. Methods</h4>
        

    <p><code>Location</code> objects <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> implement the following methods:</p>

      <div class="ednote">These all need to be rewritten to state conformance requirements.</div>

      <dl>

        <div class="ednote">Need description for assign.</div>

	<div class="ednote">ISSUE-68: Need description for toString, if we specify that. It
	has the same value as href; not all implementations have this
	explicitly but toString is always available in ECMAScript, and
	probably this should be explicit for the sake of Java. Or we
	could skip it since it matches href, and define string
	conversion in the JS bindings.</div>

        <dt><dfn id="dfn-replace(url)">replace(<var>url</var>)</dfn></dt>
        <dd>This function replaces the current history entry with the
         <var>url</var> specified. <div class="ednote">ISSUE-59: we haven't specified history - but we
         need to if we are to support this</div></dd>

        <dt><dfn id="dfn-reload()">reload()</dfn></dt>
        <dd>This function forces the host application to reload the resource
         identified by the Location. <div class="ednote">ISSUE-69: Netscape used to allow a bool
         argument to force an unconditional GET from the network</div></dd>
     </dl>
     </div>

    </div>

  </div>

  <div class="section"><h2 id="embedding">4. Embedding: Compound Documents by Reference</h2>
    
    <p>An element that refers to another document which is then embedded is
     called an <dfn id="dfn-embedding-element">embedding element</dfn>. A
     document embedded in such an element is called a
     <dfn id="dfn-child-document">child document</dfn>. Seen from a child
     document, the embedding element is part of a
     <dfn id="dfn-parent-document">parent document</dfn>. When a document
     has no embedding element that points to it the document is a
     <dfn id="dfn-root-document">root document</dfn>. A document can be both
     a parent document and child document at the same time.</p>

    <div class="ednote">The normative definitions of the various attributes should
    be moved to below the IDL to match other sections.</div>

    <p>The value of the <code>frameElement</code> attribute of a
     <code>Window</code> object <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
     <a class="term" href="#dfn-embedding-element">embedding element</a>, or
     <code>null</code> if there is no such element. The value of the
     <code>parent</code> attribute of a <code>Window</code> object <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
     <a class="term" href="#dfn-parent-document">parent document</a>'s
     <code>Window</code> object or the document's <code>Window</code> object if
     there is no parent document. The value of the <code>top</code> attribute of
     a <code>Window</code> object <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
     <a class="term" href="#dfn-root-document">root document</a>'s <code>Window</code>
     object.

     <div class="ednote">For the ES bindings appendix: In ECMAScript these DOM
      attributes, even though readonly, to be set to different values. In such
      cases the attributes are simply the values set by the script
      author.</div>

     <div class="ednote">This does not deal with security. Security should probably be
      taken care of in a separate part of the specification. That there is no
      restriction by design, but by security environment.</div>
    </p>
    <p>The <code>name</code> attribute of a <code>Window</code> object <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be
     the name assigned by the <a class="term" href="#dfn-embedding-element">embedding
     element</a>, the empty string if there is no such element or a value set
     by the script author. How this name is extracted from the embedding
     element is language specific.

     <div class="ednote">Need to mention that it can be set by Window.open() and the
      "target" attribute in some languages, basically anything that can open
      a new top-level <a class="term" href="#dfn-browsing-context">browsing context</a>.</div>
    </p>
    <p>For example, if you have
     <code>&lt;object data="<var>file</var>" id="test"/&gt;</code> in an XHTML
     document the <code>name</code> DOM attribute within <var>file</var> will be
     "test".</p>
    <p>The value of the <code>contentDocument</code> attribute of an object that
     implements the <code>EmbeddingElement</code> interface <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the
     <a class="term" href="#dfn-child-document">child document</a>'s
     <code>Document</code> object or <code>null</code> if there is no such
     object.

     <div class="ednote">Need to discuss the possibility of embedding elements containing
      non-DOM content, like images or plugin content.</div>

     Likewise the <code>contentWindow</code> attribute of an object that
     implements the <code>EmbeddingElement</code> interface <em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be the child
     document's <code>Window</code> object or <code>null</code> if there is no
     such object. 
    </p>

    <div class="section"><h3 id="window-embedding">4.1. The <code>Window</code> Interface, Embedding Attributes</h3>
      

      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

interface Window {
    // name attribute of referencing frame/iframe/object, or name passed to
    // window.open
    attribute dom::DOMString name;

    // global object of containing document
    readonly attribute Window parent;

    // global object of outermost containing document
    readonly attribute Window top;

    // referencing &lt;html:frame&gt;, &lt;html:iframe&gt;, &lt;html:object&gt;, &lt;svg:foreignObject&gt;,
    // &lt;svg:animation&gt; or other embedding point, or null if none
    readonly attribute dom::Element frameElement;
};</pre></div>

      <div class="ednote">This needs fixing to clearly state the conformance requirements.</div>
      <div class="ednote">This also needs to be merged with the above I think [anne].</div>

      <dl>
        <dt><dfn id="dfn-parent">parent</dfn></dt>
        <dd>An attribute containing a reference to <code>Window</code> object
         that contains this object.</dd>

        <dt><dfn id="dfn-top">top</dfn></dt>
        <dd>An attribute containing a reference to the topmost Window object in
         the hierarchy that contains this object.</dd>

        <dt><dfn id="dfn-name">name</dfn></dt>
        <dd>An attribute containing a unique name used to refer to this Window object.
	<div class="ednote">Need to describe how this could come from a containing element.</div>
	</dd>

        <dt><dfn id="dfn-frameelement">frameElement</dfn></dt>
        <dd><div class="ednote">@@TODO</div></dd>
      </dl>


    </div>

    <div class="section"><h3 id="embeddingelt">4.2. The <code>EmbeddingElement</code> Interface</h3>
      
      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

// must be on an object that also implements dom::Element
interface EmbeddingElement {
    readonly attribute dom::Document contentDocument;
    readonly attribute Window contentWindow;
};</pre></div>

    </div>

    <div class="ednote">Need actual description.</div>

  </div>

  <div class="section"><h2 id="timers">5. Timers</h2>
    

    <div class="ednote">Need to describe processing model for timers.</div>

    <div class="section"><h3 id="window-timers">5.1. The <code>Window</code> Interface, Timer Attributes</h3>
      

      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

interface Window {
    // should timers allow more than long, maybe a floating point type?
    // don't think anyone's timers have more precision

    // one-shot timer
    long setTimeout(in TimerListener listener, in long milliseconds);
    void clearTimeout(in long timerID);

    // repeating timer
    long setInterval(in TimerListener listener, in long milliseconds);
    void clearInterval(in long timerID);
};</pre></div>

<dl>
        <dt><dfn id="dfn-settimeout(function,-milliseconds)">setTimeout(<var>function</var>, <var>milliseconds</var>)</dfn></dt>
        <dd>This method calls the function once after a specified number of milliseconds elapses, until canceled by a call to clearTimeout. The methods returns a timerID which may be used in a subsequent call to clearTimeout to cancel the interval.</dd>

        <dt><dfn id="dfn-setinterval(function,-milliseconds)">setInterval(<var>function</var>, <var>milliseconds</var>)</dfn></dt>
        <dd>This method calls the function every time a specified number of milliseconds elapses, until canceled by a call to clearInterval. The methods returns an intervalID which may be used in a subsequent call to clearInterval to cancel the interval.</dd>

        <dt><dfn id="dfn-cleartimeout(timerid)">clearTimeout(<var>timerID</var>)</dfn></dt>
        <dd>Cancels a timeout that was set with the setTimeout method.</dd>

        <dt><dfn id="dfn-clearinterval(intervalid)">clearInterval(<var>intervalID</var>)</dfn></dt>
        <dd>Cancels an interval that was set with the setTimeout method.</dd>
    </dl>

    </div>

    <div class="section"><h3 id="timerlistener">5.2. The <em>TimerListener</em> Interface</h3>
      
      <div class="boxed"><p><span class="idlTitle"></span></p><pre class="schema" title="">

// behavior is always special in ECMAScript, this is defined only for the benefit
// of other languages
interface TimerListener {
    // what to put here?
};</pre></div>

    <div class="ednote">ISSUE-70: what to do about timers?</div>

    <div class="ednote">Need to define this. In ES bindings, a function or string is the only thing allowed.</div>

    </div>

  </div>

  <div class="section"><h2 id="security">6. Security Considerations</h2>
    

    <div class="ednote"><p>My current plan for the "security considerations" section is that it will contain the following:</p>

<ul>
<li>Non-normative statements of fact about various security vulnerabilities that may affect Window implementations (unauthorized data access, phishing/pharming, frame injection, etc).</li>

<li>A normative requirement that UAs implement some security policy that is in line with some general principles of cross-site scripting security, with exemptions allowed for "trusted" content. Some rough cuts at it (this language is not nearly precise as it should be, just trying to get the rules across):
<ul>
    <li> "A script executing in a browsing context currently presenting a document from one origin <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> be allowed to access remote content from a different origin in such a way that the script can then access the contents." (where "same origin" is defined as same URI scheme, host and port, modulo differences for document.domain which I guess needs to be in the spec).</li>
    <li> "A non-trusted document <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> be allowed to navigate a browsing context unless one of the following holds: the browsing contexts have the same top-level browsing context; the target browsing context has the same origin as the source browsing context; one of the ancestor browsing contexts of the target browsing context has the same origin as the source; OR the target browsing context is a top-level browsing context and the user can see the context's current location."</li>
    <li> "A non-trusted document <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> be allowed to access or navigate to content from a file: URI in any way."</li>
</ul></li>

<li>Specific cases where access and navigation must be allowed, notwithstanding any additional security restrictions (anything from the same origin).</li>

<li>Normative restrictions on what may be considered "trusted" content (<em class="rfc2119" title="Keyword in RFC 2119 context">MUST</em> be from a specific known location, <em class="rfc2119" title="Keyword in RFC 2119 context">MUST NOT</em> be transmitted over a network via an insecure protocol -- so you can't just say "my UA considers all content to be trusted" or "my company's homepage sent over non-SSL http is trusted".)</li>

<li>An example of a specific security model that is believed to satisfy these constraints.</li>
</ul>

<p>I would rather not have normative requirements on when UAs must or must not throw exceptions or return null or whatever, since these would merely represent our best current understanding of how to implement the security policy.</p>

<p>It may be that some of this belongs in the main body of the spec instead of in Security Considerations, let's figure that out when the security part is actually written.</p>

</div>

  </div>

  <div class="section"><h2 id="idl">A. IDL Definitions</h2>
    

    <div class="ednote">Need to fill in the full IDL here.</div>
  </div>


  <div class="section"><h2 id="ecmascript-binding">B. ECMAScript Language Binding</h2>
    

    <div class="ednote">Need to define all the ECMAScript-specific issues, such as which properties
    are shadowable or replaceable, assigning to the location property, passing functions or
    strings as timers, etc.</div>
  </div>

  <div class="section"><h2 id="java-binding">C. Java Language Binding</h2>
    

    <div class="ednote">Need to write this.</div>
  </div>

  <div class="section"><h2 id="acknow">D. Acknowledgements</h2>
    

    <p>
      The WebAPI <acronym title="Working Group">WG</acronym> would like to thanks the following people for contributing to this specification:
    </p>

    <p>
      Björn Höhrmann, Jim Ley, Cameron McCormack and Boris Zbarsky.
    </p>

    <p>
      Special thanks to Anne van Kesteren for writing the Embedding
      section and many other additions and improvenets.
    </p>

    <p>
      Special thanks to Ian Hickson for making the first attempt to
      standardize the Window object in Web Apps 1.0, drafts of which
      heavily influenced this document. In particular, he coined the
      term "browsing context".
    </p>

  </div>

  <div class="section"><h2 id="bibref">E. References</h2>
    

    <div class="ednote">Need to be able to include organization and date for references.</div>

    <div class="ednote">Need appropriate cites for DOM Core and OMG IDL.</div>

    <div class="ednote">Need titles and authors for DOM2Views</div>
    <div class="ednote">Need titles and authors for DOM3Core</div>
    <div class="ednote">Need titles and authors for ECMAScript</div>
    <div class="ednote">Need titles and authors for Java</div>

    <dl class="bibliography">
      
      
      
      
      
    <dt id="DOM2Views">DOM2Views</dt><dd><cite><a href=""></a></cite>,
    </dd><dt id="DOM3Core">DOM3Core</dt><dd><cite><a href=""></a></cite>,
    </dd><dt id="DOM3EV">DOM3EV</dt><dd><cite><a href="http://www.w3.org/TR/DOM-Level-3-Events/">Document Object Model (DOM) Level 3 Events Specification</a></cite>,
    <span class="person">Philippe Le Hégaret (W3C)</span>, and <span class="person">Tom Pixley (Netscape Communications Corporation)</span>.</dd><dt id="ECMAScript">ECMAScript</dt><dd><cite><a href=""></a></cite>,
    </dd><dt id="Java">Java</dt><dd><cite><a href=""></a></cite>,
    </dd><dt id="RFC2119">RFC2119</dt><dd><cite><a href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a></cite>,
    <span class="person">S. Bradner</span>.</dd><dt id="RFC2396">RFC2396</dt><dd><cite><a href="http://www.ietf.org/rfc/rfc2396.txt">Uniform Resource Identifiers (URI): Generic Syntax</a></cite>,
    <span class="person">T. Berners-Lee</span>, <span class="person">R. Fielding</span>, and <span class="person">L. Masinter</span>.</dd></dl>
  </div>
</body></html>
