<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
  <title>The progress event</title>
  <style type="text/css">
<![CDATA[

.example {border:  2px double Grey; padding-left: 2em}
.issue {background-color: #ffffbf; border:  2px dashed Red;}
]]>

  </style>
  <link rel="stylesheet" type="text/css" media="screen"
  href="http://www.w3.org/Stylesheets/TR/Base.css" />
</head>

<body>

<div class="head">
<a href="http://www.w3.org/"><img src="http://www.w3.org/Icons/w3c_home"
alt="W3C" height="48" width="72" />
</a>

<h1 id="title">The ProgressEvent event.</h1>

<h2>Editor's Draft 12 December 2006</h2>
<dl>
  <dt>This version:</dt>
    <dd><a
      href="http://dev.w3.org/cvsweb/2006/webapi/progress/Progress.html?rev=1.2">http://dev.w3.org/cvsweb/2006/webapi/progress/Progress.html?rev=1.2</a></dd>
  <dt>Latest Editor's draft:</dt>
    <dd><a
      href="http://dev.w3.org/cvsweb/2006/webapi/progress/Progress.html">http://dev.w3.org/cvsweb/2006/webapi/progress/Progress.html</a></dd>
  <dt>Editors:</dt>
    <dd><a href="mailto:chaals@opera.com">Charles McCathieNevile</a>, <a
      href="http://www.opera.com/">Opera Software</a></dd>
</dl>

<p class="copyright"><a
href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
© 2006 <a href="http://www.w3.org/"><acronym
title="World Wide Web Consortium">W3C</acronym></a><sup>®</sup> (<a
href="http://www.csail.mit.edu/"><acronym
title="Massachusetts Institute of Technology">MIT</acronym></a>, <a
href="http://www.ercim.org/"><acronym
title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
<a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a
href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
<a
href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document
use</a> rules apply.</p>
<hr />
</div>

<div>
<h2 class="notoc"><a id="abstract" name="abstract">Abstract</a></h2>

<p>This document describes an event that can be used for monitoring the
progress of an operation. It is primarily intended for network operations
such as XMLHTTPRequest, but should be usable in other relevant contexts.</p>
</div>
<hr />

<div>
<h2 id="Status">Status of this Document</h2>

<p><em>This section describes the status of this document at the time of its
publication. Other documents may supersede this document. A list of current
W3C publications and the latest revision of this technical report can be
found in the <a href="http://www.w3.org/TR/">W3C technical reports index</a>
at http://www.w3.org/TR/.</em></p>

<p>This document is an editor's draft specification of the ProgressEvent
event from the <a href="http://www.w3.org/2006/webapi/">Web API group</a>,
part of the Rich Web Client Activity. It defines an event which can be used
to monitor a process and provide feedback to a user, particularly for
network-based events. This editor's draft does not imply consensus of or
endorsement by any member of the working group.</p>

<p>This document is published to solicit comments from interested parties.
All comments are welcome and may be sent to <a
href="mailto:public-webapi@w3.org">public-webapi@w3.org</a>. All messages
received at this address are viewable in a <a
href="http://lists.w3.org/Archives/Public/public-webapi/">public archive</a>.
This document will hopefully be published as a first W3C Working Draft at the
end of 2006 or the beginning of 2007.</p>

<p>This document was produced by a group operating under the <a
href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004
W3C Patent Policy</a>. W3C maintains a <a rel="disclosure"
href="http://www.w3.org/2004/01/pp-impl/35495/status">public list of any
patent disclosures</a> made in connection with the deliverables of the group;
that page also includes instructions for disclosing a patent. An individual
who has actual knowledge of a patent which the individual believes contains
<a
href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
Claim(s)</a> must disclose the information in accordance with <a
href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
6 of the W3C Patent Policy</a>.</p>

<p>Publication as a Working Draft does not imply endorsement by the W3C
Membership. This is a draft document and may be updated, replaced or
obsoleted by other documents at any time. It is inappropriate to cite this
document as other than work in progress.</p>

<h2>Contents</h2>

<div class="toc">
<ul>
  <li><a href="#Conformanc">Conformance</a></li>
  <li><a href="#Progress">The ProgressEvent event</a></li>
  <li><a href="#References">References</a>
    <ul>
      <li><a href="#Normative">Normative references</a></li>
      <li><a href="#Informativ">Informative references</a></li>
    </ul>
  </li>
  <li><a href="#Acknowledg">Acknowledgements</a></li>
</ul>
</div>

<h2 id="Conformanc">Conformance</h2>

<p>The terms <strong>must</strong>, <strong>should</strong>,
<strong>may</strong>, <strong>must not</strong>, <strong>should not</strong>,
are used in this document in accordance with [<a
href="#RFC2119">RFC2119</a>]. A conformant implementation of this
specification meets all requirements identified by the use of these terms.</p>

<h2 id="Progress">The <code>ProgressEvent</code> event</h2>

<p class="issue">@@Issue: Does it bubble / is it cancelable? I am not sure
why it would / be, myself.</p>
</div>

<p>The <code>ProgressEvent</code> occurs when the user agent makes progress
in some network operation, such as loading a resource from the web via
XMLHTTPRequest [<a href="#XHR">XHR</a>].</p>

<p>The user agent <span class="term"><em>must</em></span> dispatch a
<code>ProgressEvent</code> at the beginning of a load operation (i.e., just
before starting to access the resource). This event is of type
'<code>preload</code>'. </p>

<p>The user agent <span class="term">must</span> dispatch a
<code>ProgressEvent</code> at the end of a load operation (i.e. after load is
complete and the user agent is ready to render the corresponding resource).
This event is of type '<code>postload</code>' event. </p>

<p>The user agent <span class="term">may</span> dispatch a
<code>ProgressEvent</code> event between the 'preload' event and the
'postload' events. Such events are of type '<code>loadprogress</code>'.</p>

<p>The ProgressEvent has three corresponding event attributes on elements:
<span class="attribute"><code>onpreload</code></span>, <span
class="attribute"><code>onpostload</code></span> and <span
class="attribute"><code>onloadprogress</code></span>.</p>

<p>Below is an example of the Progress Event being used to update a progress
bar in an SVG document:</p>
<pre class="example"><code>&lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1"
     xmlns:xlink="http://www.w3.org/1999/xlink"&gt;
   
   &lt;script type="text/ecmascript"&gt;&lt;![CDATA[
   var svgNS = "http://www.w3.org/2000/svg"
   var xlinkNS = "http://www.w3.org/1999/xlink"

   function showImage(imageHref) {
       var image = document.getElementById('myImage');
       image.setAttributeNS(xlinkNS, "href", imageHref);
   }           

   function imageLoadStart(evt) {
       var progressBar = document.getElementById('progressBar');
       progressBar.setAttributeNS(svgNS, "width", 0);
       var loadAnimation = document.getElementById('loadAnimation');
       loadAnimation.beginElement();
   }
               
   function imageLoadProgress(evt) {  
       var progressBar = document.getElementById('progressBar');
       progressBar.setAttributeNS(svgNS, "width", 100*evt.loaded/evt.total);
   }
               
   function imageLoadComplete(evt) {
       var progressBar = document.getElementById('progressBar');  
       progressBar.setAttributeNS(svgNS, "width", 100);
        var loadAnimation = document.getElementById('loadAnimation');
       loadAnimation.endElement();
               
   }
   ]]&gt;&lt;/script&gt;

   &lt;image id="myImage" xlink:href="imageA.png" width="300" height="400"
          onpreload="imageLoadStart(evt)"
          onloadprogress="imageLoadProgress(evt)"
          onpostload="imageLoadComplete(evt)"/&gt;

   &lt;rect onclick="showImage('imageB.png')" width="120" 
         height="30" y="400"/&gt;

   &lt;animate id="loadAnimation" ... /&gt;

   &lt;rect id="progressBar" ... /&gt;
&lt;/svg&gt;</code></pre>

<p class="issue">@@Add an example of using lengthComputable in an HTML "[ X
(of Y) bytes loaded]" example.</p>
<dl>
  <dt><b>IDL Definition</b></dt>
    <dd>
      <div class="idl-code">
      <pre>interface ProgressEvent : events::Event {
     readonly attribute boolean         lengthComputable;
     readonly attribute unsigned long   loaded;
     readonly attribute unsigned long   total;
     void               initProgressEvent(in DOMString typeArg,
                                          in unsigned long loaded,
                                          in unsigned long total
                                          in boolean       canBubble
                                          in boolean       cancelableArg);
     void               initProgressEventNS(in DOMString namespaceURI,
                                            in DOMString typeArg,
                                            in unsigned long loaded,
                                            in unsigned long total
                                            in boolean       canBubble
                                            in boolean       cancelableArg);
};</pre>
      </div>
      <br />
    </dd>
  <dt><b>Attributes</b></dt>
    <dd><dl>
        <dt><span class="dom-readonly">readonly</span> <span
        class="dom-attr-type">boolean</span> <span
        class="dom-attr-name">lengthComputable</span></dt>
          <dd>If false the total number of bytes (total) cannot be computed
            and the value of total should be ignored. This might occur if the
            size of the downloaded resource is unknown or if the data has
            already arrived.</dd>
      </dl>
    </dd>
    <dd><dl>
        <dt><span class="dom-readonly">readonly</span> <span
        class="dom-attr-type">unsigned long</span> <span
        class="dom-attr-name">loaded</span></dt>
          <dd>Specifies the number of bytes downloaded since the beginning of
            the download.</dd>
      </dl>
    </dd>
    <dd><dl>
        <dt><span class="dom-readonly">readonly</span> <span
        class="dom-attr-type">unsigned long</span> <span
        class="dom-attr-name">total</span></dt>
          <dd>Specifies the expected total number of bytes expected in a load
            operation. This value is ignored for a '<code>preload</code>' or
            '<code>postload</code>' event <span class="issue">@@Issue:
            why?</span> . For a '<code>loadprogress</code>' event, this value
            must be non-negative. </dd>
      </dl>
    </dd>
  <dt><b>Methods</b></dt>
    <dd><dl>
        <dt><span class="dom-method-name">initProgressEvent</span></dt>
          <dd>The initProgressEvent method is used to initialize the value of
            a ProgressEvent created through the DocumentEvent interface. This
            method may only be called before the ProgressEvent has been
            dispatched via the dispatchEvent method, though it may be called
            multiple times during that phase if necessary. If called multiple
            times, the final invocation takes precedence.
            <dl>
              <dt><span class="dom-parameters">Parameters</span></dt>
                <dd>
                  <table summary="method parameters" border="0">
                    <tbody>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">DOMString</span> <span
                          class="dom-parameter-name">typeArg</span></td>
                        <td></td>
                        <td>Specifies the event type.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">unsigned long</span>
                          <span class="dom-parameter-name">loaded</span></td>
                        <td></td>
                        <td>Specifies the number of bytes that have been
                          retrieved. This is a positive value.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">unsigned long</span>
                          <span class="dom-parameter-name">total</span></td>
                        <td></td>
                        <td>Specifies the expected total number of bytes in
                          this load operation.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">boolean </span><span
                          class="dom-parameter-name">canBubble</span></td>
                        <td></td>
                        <td>Specifies whether the event can bubble.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">boolean </span><span
                          class="dom-parameter-name">cancelableArg</span></td>
                        <td></td>
                        <td>Specifies whether the event can be canceled.</td>
                      </tr>
                    </tbody>
                  </table>
                </dd>
            </dl>
            <dl>
              <dt><span class="dom-returnvalue">No Return Value</span></dt>
            </dl>
            <dl>
              <dt><span class="dom-parameters">No Exceptions</span></dt>
            </dl>
          </dd>
      </dl>
      <dl>
        <dt><span class="dom-method-name">initProgressEventNS</span></dt>
          <dd>The initProgressEvent method is used to initialize the value of
            a namespaced ProgressEvent created through the DocumentEvent
            interface. This method may only be called before the
            ProgressEvent has been dispatched via the dispatchEvent method,
            though it may be called multiple times during that phase if
            necessary. If called multiple times, the final invocation takes
            precedence.
            <dl>
              <dt><span class="dom-parameters">Parameters</span></dt>
                <dd>
                  <table summary="method parameters" border="0">
                    <tbody>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">DOMString</span> <span
                          class="dom-parameter-name">namnespaceURI</span></td>
                        <td></td>
                        <td>Specifies the URI for the namespace of the
                        event.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">DOMString</span> <span
                          class="dom-parameter-name">typeArg</span></td>
                        <td></td>
                        <td>Specifies the event type.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">unsigned long</span>
                          <span class="dom-parameter-name">loaded</span></td>
                        <td></td>
                        <td>Specifies the number of bytes that have been
                          retrieved. This is a positive value.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">unsigned long</span>
                          <span class="dom-parameter-name">total</span></td>
                        <td></td>
                        <td>Specifies the expected total number of bytes in
                          this load operation.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">boolean </span><span
                          class="dom-parameter-name">canBubble</span></td>
                        <td></td>
                        <td>Specifies whether the event can bubble.</td>
                      </tr>
                      <tr>
                        <td valign="top">in <span
                          class="dom-parameter-type">boolean </span><span
                          class="dom-parameter-name">cancelableArg</span></td>
                        <td></td>
                        <td>Specifies whether the event can be canceled.</td>
                      </tr>
                    </tbody>
                  </table>
                </dd>
            </dl>
            <dl>
              <dt><span class="dom-returnvalue">No Return Value</span></dt>
            </dl>
            <dl>
              <dt><span class="dom-parameters">No Exceptions</span></dt>
            </dl>
          </dd>
      </dl>
    </dd>
</dl>

<h2 id="References">References</h2>

<h3 id="Normative">Normative references</h3>
<dl>
  <dt id="ref-rfc2119">[<a name="RFC2119" id="RFC2119">RFC2119</a>]</dt>
    <dd>The specification for how to use english to specify normativity, as
      if it were a technical language. Available at <a
      href="http://rfc.net/rfc2119.html">http://rfc.net/rfc2119.html</a></dd>
</dl>

<h3 id="Informativ">Informative references</h3>
<dl>
  <dt>[IEoP] onProgress event in Internet Explorer</dt>
    <dd>Documentation available at <a
      href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/com/html/07b3e629-a558-4a0e-8307-ca922f56e00c.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/com/html/07b3e629-a558-4a0e-8307-ca922f56e00c.asp</a></dd>
  <dt>[SVGD] The proposed progress event in SVG 1.2</dt>
    <dd>Available at <a
      href="http://www.w3.org/TR/2006/CR-SVGMobile12-20060810/svgudom.html#events__ProgressEvent">http://www.w3.org/TR/2006/CR-SVGMobile12-20060810/svgudom.html#events__ProgressEvent</a></dd>
  <dt>[WPE] The <code>progress</code> element proposed by WHAT-WG</dt>
    <dd>Ed. I Hickson. Latest versionvailable at <a
      href="http://www.whatwg.org/specs/web-apps/current-work/#progress0">http://www.whatwg.org/specs/web-apps/current-work/#progress0</a></dd>
  <dt>[<a name="XHR" id="XHR">XHR</a>] XMLHTTPRequest</dt>
    <dd>Ed. A van Kesteren. Latest draft available at <a
      href="http://www.w3.org/TR/xmlhttprequest">http://www.w3.org/TR/xmlhttprequest</a></dd>
</dl>

<h2 id="Acknowledg">Acknowledgements</h2>

<p>The editor would like to thank the SVG working group for producing the
draft that this was initially based on. In addition, the following
individuals' comments have been invaluable in preparing this draft:</p>

<p>Robin Berjon, Gorm Eriksen, Ian Hickson, Bjoern Hoehrmann, Björn Höhrmann,
Bjoern Höhrmann, Anne van Kesteren, Jim Ley, Ellen Siegel, Maciej Stachowiak,
Boris Zbarsky</p>
</body>
</html>
