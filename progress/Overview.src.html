<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en-US">
 <head>
  <title>Progress Events</title>
  <style type="text/css">
   pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
   pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
   pre code { color:inherit; background:transparent }
   div.example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
   p.note::before { content:"Note: " }
   .XXX { padding:.5em; border:solid #f00 }
   p.XXX::before { content:"Issue: " }
   dl.switch { padding-left:2em }
   dl.switch > dt { text-indent:-1.5em }
   dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
   dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
   dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
   dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
   dl.domintro dd p { margin: 0.5em 0; }
   dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: red; border: solid 2px; background: white; padding: 0 0.25em; }
   em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
   dfn { font-weight:bold; font-style:normal }
   code { color:orangered }
   code :link, code :visited { color:inherit }
   hr:not(.top) { display:block; background:none; border:none; padding:0; margin:2em 0; height:auto }
   table { border-collapse:collapse; border-style:hidden hidden none hidden }
   table thead { border-bottom:solid }
   table tbody th:first-child { border-left:solid }
   table td, table th { border-left:solid; border-right:solid; border-bottom:solid thin; vertical-align:top; padding:0.2em }
  </style>
  <link rel="stylesheet" href="http://www.w3.org/StyleSheets/TR/W3C-[STATUS]">
 </head>
 <body>
  <div class="head">
   <p><a href="http://www.w3.org/"><img height="48" width="72" alt="W3C" src="http://www.w3.org/Icons/w3c_home"></a></p>

   <h1 class="head">Progress Events</h1>

   <h2 class="no-num no-toc" id="w3c-doctype">[LONGSTATUS] [DATE: 3 August 2002]</h2>

   <dl>
    <dt>This Version:</dt>
    <dd><a href="[VERSION]/">http://www.w3.org/TR/[YEAR]/ED-progress-events-[CDATE]/</a></dd>

    <dt>Latest Version:</dt>
    <dd><a href="http://www.w3.org/TR/progress-events/">http://www.w3.org/TR/progress-events/</a></dd>

    <dt>Latest Editor Version:</dt>
    <dd><a href="http://dev.w3.org/2006/webapi/progress/">http://dev.w3.org/2006/webapi/progress/</a></dd>

    <dt>Previous Versions:</dt>
    <dd><a href="http://www.w3.org/TR/2010/WD-progress-events-20101019/">http://www.w3.org/TR/2010/WD-progress-events-20101019/</a></dd>
    <dd><a href="http://www.w3.org/TR/2008/WD-progress-events-20080521/">http://www.w3.org/TR/2008/WD-progress-events-20080521/</a></dd>
    <dd><a href="http://www.w3.org/TR/2007/WD-progress-events-20071023/">http://www.w3.org/TR/2007/WD-progress-events-20071023/</a></dd>
    <dd><a href="http://www.w3.org/TR/2007/WD-progress-events-20070419/">http://www.w3.org/TR/2007/WD-progress-events-20070419/</a></dd>

    <dt>Editor:</dt>
    <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a>
     (<a href="http://www.opera.com/">Opera Software</a>)
     &lt;<a href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;</dd>

    <dt>Former Editor:</dt>
    <dd>Charles McCathieNevile
    (<a href="http://www.opera.com/">Opera Software</a>)
     &lt;<a href="mailto:chaals@opera.com">chaals@opera.com</a>&gt;</dd>
   </dl>

   <p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
   &copy; 2010
   <a href="http://www.w3.org/"><acronym title="World Wide Web Consortium">W3C</acronym></a><sup>&reg;</sup>
   (<a href="http://www.csail.mit.edu/"><acronym title="Massachusetts Institute of Technology">MIT</acronym></a>,
   <a href="http://www.ercim.org/"><acronym title="European Research Consortium for Informatics and Mathematics">ERCIM</acronym></a>,
   <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C
   <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
   <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a>
   and
   <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document
   use</a> rules apply.</p>
  </div>

  <hr>

  <h2 class="no-num no-toc" id="specabstract">Abstract</h2>

  <p>The Progress Events specification defines an abstract event interface
  that can be used for measuring progress; e.g. HTTP entity body
  transfers.</p>

  <!-- XXX -->

  <h2 class="no-num no-toc" id="sotd">Status of this Document</h2>

  <p><em>This section describes the status of this document at the time of
  its publication. Other documents may supersede this document. A list of
  current W3C publications and the latest revision of this technical report
  can be found in the
  <a href="http://www.w3.org/TR/">W3C technical reports index</a> at
  http://www.w3.org/TR/.</em></p>

  <p>This is the [DATE: 3 August 2002] <!--Last Call Working Draft-->[LONGSTATUS] of
  Progress Events. Please send comments to
  <a href="mailto:public-webapps@w3.org?subject=[progress-events]%20">public-webapps@w3.org</a>
  (<a href="http://lists.w3.org/Archives/Public/public-webapps/">archived</a>)
  with <samp>[progress-events]</samp> at the start of the subject line.</p>

  <p>This document is produced by the
  <a href="http://www.w3.org/2008/webapps/">Web Applications</a> (WebApps) Working Group.
  The WebApps Working Group is part of the
  <a href="http://www.w3.org/2006/rwc/Activity">Rich Web Clients Activity</a>
  in the W3C <a href="http://www.w3.org/Interaction/">Interaction Domain</a>.</p>

  <p>This document was produced by a group operating under the
  <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004
  W3C Patent Policy</a>. W3C maintains a
  <a rel="disclosure" href="http://www.w3.org/2004/01/pp-impl/42538/status">public
  list of any patent disclosures</a> made in connection with the deliverables of
  the group; that page also includes instructions for disclosing a patent. An
  individual who has actual knowledge of a patent which the individual believes
  contains
  <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
  Claim(s)</a> must disclose the information in accordance with
  <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
  6 of the W3C Patent Policy</a>.</p>

  <p>Publication as a Working Draft does not imply endorsement by the W3C
  Membership. This is a draft document and may be updated, replaced or
  obsoleted by other documents at any time. It is inappropriate to cite this
  document as other than work in progress.</p>

  <!--
  <h3 class="no-num no-toc" id="crec">Candidate Recommendation Exit Criteria</h3>

  <p>To exit the Candidate Recommendation (CR) stage the following criteria
  <em class="ct">must</em> have been met:</p>

  <ol>
   <li>There will be at least two interoperable implementations passing all
   test cases in the
   <a href="XXX">test suite</a>
   for this specification. An implementation is to be available (i.e. for
   download), shipping (i.e. not private), and not experimental (i.e.
   intended for a wide audience). The working group will decide when the
   test suite is of sufficient quality to test interoperability and will
   produce implementation reports (hosted together with the test suite).</li>

   <li>A minimum of six months of the CR stage will have elapsed. This is to
   ensure that enough time is given for any remaining major errors to be
   caught. The CR period will be extended if implementations are slow to
   appear.</li> <!- - XXX need to add date - ->

   <li>Text, which can be in a separate document, exists that explains the
   security considerations for this specification. This may be done in a
   generic manner as they are most likely applicable to various APIs. The
   working group will decide whether the text is of sufficient quality.</li>
  </ol>
  -->


  <h2 class="no-num no-toc" id="toc">Table of Contents</h2>

  <!--toc-->



  <h2 id="introduction">Introduction</h2>

  <p><em>This section is non-normative.</em></p>

  <p>This specification defines an abstract event interface &mdash;
  <code title="">ProgressEvent</code> &mdash; that can be used for measuring
  progress. Other specifications use this specification for that
  purpose.</p>

  <div class="example">
   <p>In this example <code title="">XMLHttpRequest</code>, combined with
   concepts defined in this specification, and the HTML
   <code title="">progress</code> element are used together to display the
   process of fetching a resource. <a href="#ref-xhr">[XHR]</a>
   <a href="#ref-html">[HTML]</a></p>

   <pre>&lt;!DOCTYPE html>
&lt;title>Waiting for Magical Unicorns&lt;/title>
&lt;progress id=p>&lt;/progress>
&lt;script>
  var progressBar = document.getElementById("p"),
      client = new XMLHttpRequest()
  client.open("GET", "magical-unicorns")
  client.onprogress = function(pe) {
    if(pe.lengthComputable) {
      progressBar.max = pe.total
      progressBar.value = pe.loaded
    }
  }
  client.onloadend = function(pe) {
    progressBar.value = pe.loaded
  }
  client.send()
&lt;/script></pre>

   <p>Fully working code would of course be more elaborate and deal with
   more scenarios, such as network errors or the end user terminating the
   request.</p>
  </div>


  <h2 id="common-infrastructure">Common Infrastructure</h2>

  <h3 id="terminology">Terminology</h3>

  <p><dfn>Bubble flag</dfn>,
  <dfn>cancel flag</dfn>
  <dfn id=concept-event-dispatch title=concept-event-dispatch">dispatch</dfn>,
  <dfn>dispatch flag</dfn>,
  <dfn id=concept-event title=concept-event>event</dfn>,
  <dfn id=event><code>Event</code></dfn>,
  <dfn id=dom-event-initevent title=dom-Event-initEvent><code>initEvent()</code></dfn>, and
  <dfn id=concept-event-name title=concept-event-name>name</dfn>
  are defined by DOM Core.
  <a href="#ref-domcore">[DOMCore]</a></p>

  <p><dfn id="http-content-length" title="http-content-length"><code>Content-Length</code></dfn>
  and <dfn id="entity-body">entity body</dfn> are defined by HTTP.
  <a href="#ref-http">[HTTP]</a></p>

  <h3 id="conformance">Conformance Requirements</h3>

  <p>Everything in this specification is normative except for diagrams,
  examples, notes and sections marked non-normative.</p>

  <p>The key word must in this document is to be interpreted as
  described in RFC 2119. <a href="#ref-ct">[RFC2119]</a></p>

  <p>A user agent must also be a conforming implementation of the IDL
  fragments in this specification, as described in the Web IDL
  specification. <a href="#ref-webidl">[WebIDL]</a>

  <h3 id="extensibility">Extensibility</h3>

  <p>User agents, Working Groups, and other interested parties are
  <em>strongly encouraged</em> to discuss extensions on a relevant public
  forum, preferably
  <a href="mailto:public-webapps@w3.org">public-webapps@w3.org</a>. If this
  is for some reason not possible prefix the extension in some way and start
  the prefix with an uppercase letter. E.g. if company Foo wants to add a
  private method <code>bar()</code> it could be named <code>FooBar()</code>
  to prevent clashes with a potential future standardized
  <code>bar()</code>.</p>


  <h2>The <code title="">ProgressEvent</code> Interface</h2>

  <pre class="idl">interface <dfn>ProgressEvent</dfn> : <span>Event</span> {
  readonly attribute boolean <span title="dom-ProgressEvent-lengthComputable">lengthComputable</span>;
  readonly attribute unsigned long long <span title="dom-ProgressEvent-loaded">loaded</span>;
  readonly attribute unsigned long long <span title="dom-ProgressEvent-total">total</span>;

  void <span title="dom-ProgressEvent-initProgressEvent">initProgressEvent</span>(DOMString <var title="">type</var>, optional boolean <var title="">bubbles</var>, optional boolean <var title="">cancelable</var>, optional boolean <var title="">lengthComputable</var>, optional unsigned long long <var title="">loaded</var>, optional unsigned long long <var title="">total</var>);
};</pre>

<p><span title=concept-event>Events</span> of type
<code>ProgressEvent</code> indicate some kind of progression.</p>

<p><span title=concept-event>Events</span> of type
<code>ProgressEvent</code> have an associated
<dfn title=concept-ProgressEvent-value>value</dfn>,
<dfn title=concept-ProgressEvent-maximum>maximum</dfn>, and
<dfn>maximum known flag</dfn>. The
<span title=concept-ProgressEvent-value>value</span> and
<span title=concept-ProgressEvent-maximum>maximum</span> are initially zero
and the <span>maximum known flag</span> is initially unset.</p>

<p>The
<dfn id="dom-progressevent-lengthcomputable" title="dom-ProgressEvent-lengthComputable"><code>lengthComputable</code></dfn>
attribute must return true if the <span>maximum known flag</span> is set and
false otherwise.</p>

<p>The
<dfn id="dom-progressevent-loaded" title="dom-ProgressEvent-loaded"><code>loaded</code></dfn>
attribute must return <span title=concept-ProgressEvent-value>value</span>.

<p>The <dfn id="dom-progressevent-total" title="dom-ProgressEvent-total"><code>total</code></dfn>
attribute must return <span title=concept-ProgressEvent-maximum>maximum</span>.

<p>When the <dfn id="dom-progressevent-initprogressevent" title="dom-ProgressEvent-initProgressEvent"><code>initProgressEvent(<var title>type</var>, <var title>bubbles</var>, <var title>cancelable</var>, <var title="">lengthComputable</var>, <var title="">loaded</var>, <var title="">total</var>)</code></dfn>
method is invoked these steps must be run:

<ol>
 <li><p>If the <span>dispatch flag</span> is set, terminate these steps.
 <li><p>Invoke <code title=dom-Event-initEvent>initEvent()</code> with up to
 the first three arguments.</li>
 <li><p>If the <var title="">lengthComputable</var> argument is not omitted
 and is true, set the <span>maximum known flag</span>.
 <li><p>If the <var title="">loaded</var> argument is not omitted, set
 <span title=concept-ProgressEvent-value>value</span> to
 <var title="">loaded</var>.
 <li><p>If the <var title="">total</var> argument is not omitted, set
 <span title=concept-ProgressEvent-maximum>maximum</span> to
 <var title="">total</var>.
</ol>


<h3>Dispatching events of type <code title="">ProgressEvent</code> for HTTP</h3>

<p>When a specification says to
<dfn title="dispatch-an-http-entity-body-progress-event">dispatch an HTTP progress event named <var>e</var></dfn>
 these steps:</p>

<ol>
 <li>Let <var title="">event</var> be an
 <span title=concept-event>event</span> of type <code>ProgressEvent</code>
 <li>Set <var title="">event</var>'s
 <span title=concept-event-name>name</span> to <var title="">e</var>
 <li>Set <span title=concept-ProgressEvent-value>value</span> to the number
 of HTTP <span>entity body</span> octets transferred.</li>
 <li>If the length of the HTTP <span>entity body</span> is known through the
 <code title=http-content-length>Content-Length</code> header, set the
 <span>maximum known flag</span> and set
 <span title=concept-ProgressEvent-maximum>maximum</span> to the length.
 <li><span title=concept-event-dispatch>Dispatch</span>
 <var title="">event</var> to the indicated object.</li>
</ol>

<h3>Dispatch events of type <code title="">ProgressEvent</code> for other contexts</h3>

<p>This is left as an exercise for the editor of the specification that
introduces such a context. The editor is encouraged to define it in a way
consistent with this and other specifications using
<span title=concept-event>events</span> of type
<code title="">ProgressEvent</code>.</p>


  <h3>Security Considerations for Initializing <code title="">ProgressEvent</code></h3>

  <p>For cross-origin requests some kind of opt-in, e.g. via
  Cross-Origin Resource Sharing has to happen before the events are
  dispatched as information would be revealed that cannot be obtained
  otherwise. <a href="#ref-cors">[CORS]</a></p>



  <h2>Suggested <code title="">ProgressEvent</code> Names</h2>

  <p><em>This section is non-normative.</em></p>

  <p>The suggested <span title=concept-event-name>names</span> for use
  with <span title=concept-event>events</span> of type
  <code>ProgressEvent</code> interface are summarized in the table
  below. Specification editors are free to tune the details to their
  specific scenarios, though are strongly encouraged to discuss their usage
  with the W3C WebApps Working Group on
  <a href="mailto:public-webapps@w3.org">public-webapps@w3.org</a> to ensure
  input from people familiar with the subject.</p>

  <table>
   <tbody>
    <tr>
     <th>Name
     <th>Description
     <th>Times
     <th>When
    <tr>
     <th><code title="">loadstart</code>
     <td>Progress has begun.
     <td>Once.
     <td>First.
    <tr>
     <th><code title="">progress</code>
     <td>In progress.
     <td>Zero or more.
     <td>After <code title="">loadstart</code> has been
     <span title=concept-event-dispatch>dispatched</span>.
    <tr>
     <th><code title="">error</code>
     <td>Progression failed.
     <td>Zero or once.
     <td rowspan="3">After the last <code title="">progress</code> has
      been <span title=concept-event-dispatch>dispatched</span>, or after
      <code title="">loadstart</code> has been
      <span title=concept-event-dispatch>dispatched</span> if
      <code title="">progress</code> has not been
      <span title=concept-event-dispatch>dispatched</span>.
    <tr>
     <th><code>abort</code>
     <td>Progression is terminated.
     <td>Zero or once.
    <tr>
     <th><code>load</code>
     <td>Progression is successful.
     <td>Zero or once.
    <tr>
     <th><code title="">loadend</code>
     <td>Progress has stopped.
     <td>Once.</td>
     <td>After one of <code title="">error</code>,
      <code title="">abort</code>, or <code title="">load</code> has been
      <span title=concept-event-dispatch>dispatched</span>.
  </table>

  <p>The <code title="">error</code>, <code title="">abort</code>, and
  <code title="">load</code> event types are mutually exclusive.</p>

  <p>Throughout the web platform the <code title="">error</code>,
  <code title="">abort</code>, and <code title="">load</code> event types
  have their <span>bubble flag</span> and <span>cancel flag</span> unset so
  it is suggested that for consistency all
  <span title=concept-event>events</span> of type <code>ProgressEvent</code>
  have these unset.</p>


  <h2 class="no-num" id="references">References</h2>

  <p>Unless marked "Non-normative" these references are normative.</p>

  <dl>
   <dt>[<dfn id="ref-cors">CORS</dfn>]
   <dd>(Non-normative) <cite><a href="http://dev.w3.org/2006/waf/access-control/">Cross-Origin Resource Sharing</a></cite> (work in progress), A. van Kesteren. W3C.

   <dt>[<dfn id="ref-domcore">DOMCore</dfn>]
   <dd><cite><a href="http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html">DOM Core</a></cite> (work in progress), A. van Kesteren. W3C.

   <dt>[<dfn id="ref-html">HTML</dfn>]
   <dd>(Non-normative) <cite><a href="http://www.w3.org/html/wg/html5/">HTML5</a></cite> (work in progress), I. Hickson. W3C.
   <dd>(Non-normative)  <cite><a href="http://www.whatwg.org/specs/web-apps/current-work/">HTML</a></cite>, I. Hickson. WHATWG.

   <dt>[<dfn id="ref-http">HTTP</dfn>]
   <dd><cite><a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer
   Protocol -- HTTP/1.1</a></cite>, R. Fielding, J. Gettys, J. Mogul, H.
   Frystyk, L. Masinter, P. Leach, T. Berners-Lee. IETF.

   <dt>[<dfn id="ref-ct">RFC2119</dfn>]
   <dd><cite><a href="http://tools.ietf.org/html/rfc2119">Key words for use
   in RFCs to Indicate Requirement Levels</a></cite>, S. Bradner. IETF.

   <dt>[<dfn id="ref-webidl">WebIDL</dfn>]
   <dd><cite><a href="http://dev.w3.org/2006/webapi/WebIDL/">Web
   IDL</a></cite> (work in progress), C. McCormack. W3C. <!-- XXX add Sam -->

   <dt>[<dfn id="ref-xhr">XHR</dfn>]
   <dd>(Non-normative) <cite><a href="http://dev.w3.org/2006/webapi/XMLHttpRequest-2/">XMLHttpRequest</a></cite> (work in progress), A. van Kesteren. W3C.
  </dl>



  <h2 class="no-num" id="acknowledgments">Acknowledgments</h2>

  <p>The editor would like to thank

  Aaron Leventhal,
  Alan Schepers,
  Alex Danilo,
  Andrew Emmons,
  Andrew Shellshear,
  Andy Sledd,
  Arthur Barstow,
  Bj&ouml;rn H&ouml;hrmann,
  Boris Zbarsky,
  Cameron McCormack,
  Chris Lilley,
  David H&aring;s&auml;ther,
  Doug Schepers,
  Ellen Siegel,
  Erik Dahlstr&ouml;m,
  Garrett Smith,
  Gorm Eriksen,
  Gottfried Zimmermann,
  Ian Hickson,
  Jean-Claude Duford,
  Jean-Yves Bitterlich,
  Jim Ley,
  Jo&atilde;o Eiras,
  Kartikaya Gupta,
  Lisa Seeman,
  Maciej Stachowiak,
  Marcos Caceres,
  Michael Antony Puls,
  Nandini Ramani,
  Olli Pettay,
  Philip J&auml;genstedt,
  Rich Schwerdtfeger,
  Robert Sayre,
  Robin Berjon,
  Simon Pieters,
  Suresh Chitturi, and
  Travis Leithead

  for their contributions to this specification.</p>

  <p>Special thanks to the SVG WG for drafting the original
  <code title="">ProgressEvent</code> interface as part of the
  <a href="http://www.w3.org/TR/2008/REC-SVGTiny12-20081222/svgudom.html">SVG Micro DOM</a>.</p>

  <p>Thanks also to all those who have helped to improve this specification
  by sending suggestions and corrections. (Please, keep bugging us with your
  issues!)</p>
 </body>
</html>
